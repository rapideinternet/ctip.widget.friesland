/*
 *  jquery-boilerplate - v4.1.0
 *  A jump-start for jQuery plugins development.
 *  http://jqueryboilerplate.com
 *
 *  Made by Zeno Rocha
 *  Under MIT License
 */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.L={})}(this,function(a){"use strict";function b(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){e=arguments[c];for(b in e)a[b]=e[b]}return a}function c(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}}function d(a){return a._leaflet_id=a._leaflet_id||++ab,a._leaflet_id}function e(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}}function f(a,b,c){var d=b[1],e=b[0],f=d-e;return a===d&&c?a:((a-e)%f+f)%f+e}function g(){return!1}function h(a,b){var c=Math.pow(10,b||5);return Math.round(a*c)/c}function i(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function j(a){return i(a).split(/\s+/)}function k(a,b){a.hasOwnProperty("options")||(a.options=a.options?_a(a.options):{});for(var c in b)a.options[c]=b[c];return a.options}function l(a,b,c){var d=[];for(var e in a)d.push(encodeURIComponent(c?e.toUpperCase():e)+"="+encodeURIComponent(a[e]));return(b&&-1!==b.indexOf("?")?"&":"?")+d.join("&")}function m(a,b){return a.replace(bb,function(a,c){var d=b[c];if(void 0===d)throw new Error("No value provided for variable "+a);return"function"==typeof d&&(d=d(b)),d})}function n(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function o(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}function p(a){var b=+new Date,c=Math.max(0,16-(b-eb));return eb=b+c,window.setTimeout(a,c)}function q(a,b,d){if(!d||fb!==p)return fb.call(window,c(a,b));a.call(b)}function r(a){a&&gb.call(window,a)}function s(){}function t(a){if(L&&L.Mixin){a=cb(a)?a:[a];for(var b=0;b<a.length;b++)a[b]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}function u(a,b,c){this.x=c?Math.round(a):a,this.y=c?Math.round(b):b}function v(a,b,c){return a instanceof u?a:cb(a)?new u(a[0],a[1]):void 0===a||null===a?a:"object"==typeof a&&"x"in a&&"y"in a?new u(a.x,a.y):new u(a,b,c)}function w(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])}function x(a,b){return!a||a instanceof w?a:new w(a,b)}function y(a,b){if(a)for(var c=b?[a,b]:a,d=0,e=c.length;d<e;d++)this.extend(c[d])}function z(a,b){return a instanceof y?a:new y(a,b)}function A(a,b,c){if(isNaN(a)||isNaN(b))throw new Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=+a,this.lng=+b,void 0!==c&&(this.alt=+c)}function B(a,b,c){return a instanceof A?a:cb(a)&&"object"!=typeof a[0]?3===a.length?new A(a[0],a[1],a[2]):2===a.length?new A(a[0],a[1]):null:void 0===a||null===a?a:"object"==typeof a&&"lat"in a?new A(a.lat,"lng"in a?a.lng:a.lon,a.alt):void 0===b?null:new A(a,b,c)}function C(a,b,c,d){if(cb(a))return this._a=a[0],this._b=a[1],this._c=a[2],void(this._d=a[3]);this._a=a,this._b=b,this._c=c,this._d=d}function D(a,b,c,d){return new C(a,b,c,d)}function E(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function F(a,b){var c,d,e,f,g,h,i="";for(c=0,e=a.length;c<e;c++){for(d=0,f=(g=a[c]).length;d<f;d++)h=g[d],i+=(d?"L":"M")+h.x+" "+h.y;i+=b?Vb?"z":"x":""}return i||"M0 0"}function G(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}function H(a,b,c,d){return"touchstart"===b?J(a,c,d):"touchmove"===b?P(a,c,d):"touchend"===b&&Q(a,c,d),this}function I(a,b,c){var d=a["_leaflet_"+b+c];return"touchstart"===b?a.removeEventListener(Yb,d,!1):"touchmove"===b?a.removeEventListener(Zb,d,!1):"touchend"===b&&(a.removeEventListener($b,d,!1),a.removeEventListener(_b,d,!1)),this}function J(a,b,d){var e=c(function(a){if("mouse"!==a.pointerType&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE){if(!(ac.indexOf(a.target.tagName)<0))return;$(a)}O(a,b)});a["_leaflet_touchstart"+d]=e,a.addEventListener(Yb,e,!1),cc||(document.documentElement.addEventListener(Yb,K,!0),document.documentElement.addEventListener(Zb,M,!0),document.documentElement.addEventListener($b,N,!0),document.documentElement.addEventListener(_b,N,!0),cc=!0)}function K(a){bc[a.pointerId]=a,dc++}function M(a){bc[a.pointerId]&&(bc[a.pointerId]=a)}function N(a){delete bc[a.pointerId],dc--}function O(a,b){a.touches=[];for(var c in bc)a.touches.push(bc[c]);a.changedTouches=[a],b(a)}function P(a,b,c){var d=function(a){(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||0!==a.buttons)&&O(a,b)};a["_leaflet_touchmove"+c]=d,a.addEventListener(Zb,d,!1)}function Q(a,b,c){var d=function(a){O(a,b)};a["_leaflet_touchend"+c]=d,a.addEventListener($b,d,!1),a.addEventListener(_b,d,!1)}function R(a,b,c){function d(a){var b;if(Pb){if(!wb||"mouse"===a.pointerType)return;b=dc}else b=a.touches.length;if(!(b>1)){var c=Date.now(),d=c-(f||c);g=a.touches?a.touches[0]:a,h=d>0&&d<=i,f=c}}function e(a){if(h&&!g.cancelBubble){if(Pb){if(!wb||"mouse"===a.pointerType)return;var c,d,e={};for(d in g)c=g[d],e[d]=c&&c.bind?c.bind(g):c;g=e}g.type="dblclick",b(g),f=null}}var f,g,h=!1,i=250;return a[gc+ec+c]=d,a[gc+fc+c]=e,a[gc+"dblclick"+c]=b,a.addEventListener(ec,d,!1),a.addEventListener(fc,e,!1),a.addEventListener("dblclick",b,!1),this}function S(a,b){var c=a[gc+ec+b],d=a[gc+fc+b],e=a[gc+"dblclick"+b];return a.removeEventListener(ec,c,!1),a.removeEventListener(fc,d,!1),wb||a.removeEventListener("dblclick",e,!1),this}function T(a,b,c,d){if("object"==typeof b)for(var e in b)V(a,e,b[e],c);else for(var f=0,g=(b=j(b)).length;f<g;f++)V(a,b[f],c,d);return this}function U(a,b,c,d){if("object"==typeof b)for(var e in b)W(a,e,b[e],c);else if(b)for(var f=0,g=(b=j(b)).length;f<g;f++)W(a,b[f],c,d);else{for(var h in a[hc])W(a,h,a[hc][h]);delete a[hc]}return this}function V(a,b,c,e){var f=b+d(c)+(e?"_"+d(e):"");if(a[hc]&&a[hc][f])return this;var g=function(b){return c.call(e||a,b||window.event)},h=g;Pb&&0===b.indexOf("touch")?H(a,b,g,f):!Qb||"dblclick"!==b||!R||Pb&&Bb?"addEventListener"in a?"mousewheel"===b?a.addEventListener("onwheel"in a?"wheel":"mousewheel",g,!1):"mouseenter"===b||"mouseleave"===b?(g=function(b){b=b||window.event,ea(a,b)&&h(b)},a.addEventListener("mouseenter"===b?"mouseover":"mouseout",g,!1)):("click"===b&&yb&&(g=function(a){fa(a,h)}),a.addEventListener(b,g,!1)):"attachEvent"in a&&a.attachEvent("on"+b,g):R(a,g,f),a[hc]=a[hc]||{},a[hc][f]=g}function W(a,b,c,e){var f=b+d(c)+(e?"_"+d(e):""),g=a[hc]&&a[hc][f];if(!g)return this;Pb&&0===b.indexOf("touch")?I(a,b,f):Qb&&"dblclick"===b&&S?S(a,f):"removeEventListener"in a?"mousewheel"===b?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",g,!1):a.removeEventListener("mouseenter"===b?"mouseover":"mouseleave"===b?"mouseout":b,g,!1):"detachEvent"in a&&a.detachEvent("on"+b,g),a[hc][f]=null}function X(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,da(a),this}function Y(a){return V(a,"mousewheel",X),this}function Z(a){return T(a,"mousedown touchstart dblclick",X),V(a,"click",ca),this}function $(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function _(a){return $(a),X(a),this}function aa(a,b){if(!b)return new u(a.clientX,a.clientY);var c=b.getBoundingClientRect();return new u(a.clientX-c.left-b.clientLeft,a.clientY-c.top-b.clientTop)}function ba(a){return wb?a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/ic:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?20*-a.detail:a.detail?a.detail/-32765*60:0}function ca(a){jc[a.type]=!0}function da(a){var b=jc[a.type];return jc[a.type]=!1,b}function ea(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(a){return!1}return c!==a}function fa(a,b){var c=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,d=nb&&c-nb;d&&d>100&&d<500||a.target._simulatedClick&&!a._simulated?_(a):(nb=c,b(a))}function ga(a){return"string"==typeof a?document.getElementById(a):a}function ha(a,b){var c=a.style[b]||a.currentStyle&&a.currentStyle[b];if((!c||"auto"===c)&&document.defaultView){var d=document.defaultView.getComputedStyle(a,null);c=d?d[b]:null}return"auto"===c?null:c}function ia(a,b,c){var d=document.createElement(a);return d.className=b||"",c&&c.appendChild(d),d}function ja(a){var b=a.parentNode;b&&b.removeChild(a)}function ka(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function la(a){var b=a.parentNode;b.lastChild!==a&&b.appendChild(a)}function ma(a){var b=a.parentNode;b.firstChild!==a&&b.insertBefore(a,b.firstChild)}function na(a,b){if(void 0!==a.classList)return a.classList.contains(b);var c=ra(a);return c.length>0&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(c)}function oa(a,b){if(void 0!==a.classList)for(var c=j(b),d=0,e=c.length;d<e;d++)a.classList.add(c[d]);else if(!na(a,b)){var f=ra(a);qa(a,(f?f+" ":"")+b)}}function pa(a,b){void 0!==a.classList?a.classList.remove(b):qa(a,i((" "+ra(a)+" ").replace(" "+b+" "," ")))}function qa(a,b){void 0===a.className.baseVal?a.className=b:a.className.baseVal=b}function ra(a){return void 0===a.className.baseVal?a.className:a.className.baseVal}function sa(a,b){"opacity"in a.style?a.style.opacity=b:"filter"in a.style&&ta(a,b)}function ta(a,b){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=a.filters.item(d)}catch(a){if(1===b)return}b=Math.round(100*b),c?(c.Enabled=100!==b,c.Opacity=b):a.style.filter+=" progid:"+d+"(opacity="+b+")"}function ua(a){for(var b=document.documentElement.style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1}function va(a,b,c){var d=b||new u(0,0);a.style[lc]=(Hb?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")}function wa(a,b){a._leaflet_pos=b,Kb?va(a,b):(a.style.left=b.x+"px",a.style.top=b.y+"px")}function xa(a){return a._leaflet_pos||new u(0,0)}function ya(){T(window,"dragstart",$)}function za(){U(window,"dragstart",$)}function Aa(a){for(;-1===a.tabIndex;)a=a.parentNode;a.style&&(Ba(),pc=a,qc=a.style.outline,a.style.outline="none",T(window,"keydown",Ba))}function Ba(){pc&&(pc.style.outline=qc,pc=void 0,qc=void 0,U(window,"keydown",Ba))}function Ca(a,b){if(!b||!a.length)return a.slice();var c=b*b;return a=Ga(a,c),a=Ea(a,c)}function Da(a,b,c){return Math.sqrt(La(a,b,c,!0))}function Ea(a,b){var c=a.length,d=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(c);d[0]=d[c-1]=1,Fa(a,d,b,0,c-1);var e,f=[];for(e=0;e<c;e++)d[e]&&f.push(a[e]);return f}function Fa(a,b,c,d,e){var f,g,h,i=0;for(g=d+1;g<=e-1;g++)(h=La(a[g],a[d],a[e],!0))>i&&(f=g,i=h);i>c&&(b[f]=1,Fa(a,b,c,d,f),Fa(a,b,c,f,e))}function Ga(a,b){for(var c=[a[0]],d=1,e=0,f=a.length;d<f;d++)Ka(a[d],a[e])>b&&(c.push(a[d]),e=d);return e<f-1&&c.push(a[f-1]),c}function Ha(a,b,c,d,e){var f,g,h,i=d?Ac:Ja(a,c),j=Ja(b,c);for(Ac=j;;){if(!(i|j))return[a,b];if(i&j)return!1;h=Ja(g=Ia(a,b,f=i||j,c,e),c),f===i?(a=g,i=h):(b=g,j=h)}}function Ia(a,b,c,d,e){var f,g,h=b.x-a.x,i=b.y-a.y,j=d.min,k=d.max;return 8&c?(f=a.x+h*(k.y-a.y)/i,g=k.y):4&c?(f=a.x+h*(j.y-a.y)/i,g=j.y):2&c?(f=k.x,g=a.y+i*(k.x-a.x)/h):1&c&&(f=j.x,g=a.y+i*(j.x-a.x)/h),new u(f,g,e)}function Ja(a,b){var c=0;return a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2),a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8),c}function Ka(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d}function La(a,b,c,d){var e,f=b.x,g=b.y,h=c.x-f,i=c.y-g,j=h*h+i*i;return j>0&&((e=((a.x-f)*h+(a.y-g)*i)/j)>1?(f=c.x,g=c.y):e>0&&(f+=h*e,g+=i*e)),h=a.x-f,i=a.y-g,d?h*h+i*i:new u(f,g)}function Ma(a){return!cb(a[0])||"object"!=typeof a[0][0]&&void 0!==a[0][0]}function Na(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ma(a)}function Oa(a,b,c){var d,e,f,g,h,i,j,k,l,m=[1,4,2,8];for(e=0,j=a.length;e<j;e++)a[e]._code=Ja(a[e],b);for(g=0;g<4;g++){for(k=m[g],d=[],e=0,f=(j=a.length)-1;e<j;f=e++)h=a[e],i=a[f],h._code&k?i._code&k||((l=Ia(i,h,k,b,c))._code=Ja(l,b),d.push(l)):(i._code&k&&((l=Ia(i,h,k,b,c))._code=Ja(l,b),d.push(l)),d.push(h));a=d}return a}function Pa(a,b){var c,d,e,f,g="Feature"===a.type?a.geometry:a,h=g?g.coordinates:null,i=[],j=b&&b.pointToLayer,k=b&&b.coordsToLatLng||Qa;if(!h&&!g)return null;switch(g.type){case"Point":return c=k(h),j?j(a,c):new Vc(c);case"MultiPoint":for(e=0,f=h.length;e<f;e++)c=k(h[e]),i.push(j?j(a,c):new Vc(c));return new Rc(i);case"LineString":case"MultiLineString":return d=Ra(h,"LineString"===g.type?0:1,k),new Zc(d,b);case"Polygon":case"MultiPolygon":return d=Ra(h,"Polygon"===g.type?1:2,k),new $c(d,b);case"GeometryCollection":for(e=0,f=g.geometries.length;e<f;e++){var l=Pa({geometry:g.geometries[e],type:"Feature",properties:a.properties},b);l&&i.push(l)}return new Rc(i);default:throw new Error("Invalid GeoJSON object.")}}function Qa(a){return new A(a[1],a[0],a[2])}function Ra(a,b,c){for(var d,e=[],f=0,g=a.length;f<g;f++)d=b?Ra(a[f],b-1,c):(c||Qa)(a[f]),e.push(d);return e}function Sa(a,b){return b="number"==typeof b?b:6,void 0!==a.alt?[h(a.lng,b),h(a.lat,b),h(a.alt,b)]:[h(a.lng,b),h(a.lat,b)]}function Ta(a,b,c,d){for(var e=[],f=0,g=a.length;f<g;f++)e.push(b?Ta(a[f],b-1,c,d):Sa(a[f],d));return!b&&c&&e.push(e[0]),e}function Ua(a,c){return a.feature?b({},a.feature,{geometry:c}):Va(c)}function Va(a){return"Feature"===a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}function Wa(a,b){return new _c(a,b)}function Xa(a,b){return new jd(a,b)}function Ya(a){return Ub?new md(a):null}function Za(a){return Vb||Wb?new qd(a):null}var $a=Object.freeze;Object.freeze=function(a){return a};var _a=Object.create||function(){function a(){}return function(b){return a.prototype=b,new a}}(),ab=0,bb=/\{ *([\w_\-]+) *\}/g,cb=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},db="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",eb=0,fb=window.requestAnimationFrame||o("RequestAnimationFrame")||p,gb=window.cancelAnimationFrame||o("CancelAnimationFrame")||o("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)},hb=(Object.freeze||Object)({freeze:$a,extend:b,create:_a,bind:c,lastId:ab,stamp:d,throttle:e,wrapNum:f,falseFn:g,formatNum:h,trim:i,splitWords:j,setOptions:k,getParamString:l,template:m,isArray:cb,indexOf:n,emptyImageUrl:db,requestFn:fb,cancelFn:gb,requestAnimFrame:q,cancelAnimFrame:r});s.extend=function(a){var c=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=c.__super__=this.prototype,e=_a(d);e.constructor=c,c.prototype=e;for(var f in this)this.hasOwnProperty(f)&&"prototype"!==f&&"__super__"!==f&&(c[f]=this[f]);return a.statics&&(b(c,a.statics),delete a.statics),a.includes&&(t(a.includes),b.apply(null,[e].concat(a.includes)),delete a.includes),e.options&&(a.options=b(_a(e.options),a.options)),b(e,a),e._initHooks=[],e.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var a=0,b=e._initHooks.length;a<b;a++)e._initHooks[a].call(this)}},c},s.include=function(a){return b(this.prototype,a),this},s.mergeOptions=function(a){return b(this.prototype.options,a),this},s.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),c="function"==typeof a?a:function(){this[a].apply(this,b)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};var ib={on:function(a,b,c){if("object"==typeof a)for(var d in a)this._on(d,a[d],b);else for(var e=0,f=(a=j(a)).length;e<f;e++)this._on(a[e],b,c);return this},off:function(a,b,c){if(a)if("object"==typeof a)for(var d in a)this._off(d,a[d],b);else for(var e=0,f=(a=j(a)).length;e<f;e++)this._off(a[e],b,c);else delete this._events;return this},_on:function(a,b,c){this._events=this._events||{};var d=this._events[a];d||(d=[],this._events[a]=d),c===this&&(c=void 0);for(var e={fn:b,ctx:c},f=d,g=0,h=f.length;g<h;g++)if(f[g].fn===b&&f[g].ctx===c)return;f.push(e)},_off:function(a,b,c){var d,e,f;if(this._events&&(d=this._events[a]))if(b){if(c===this&&(c=void 0),d)for(e=0,f=d.length;e<f;e++){var h=d[e];if(h.ctx===c&&h.fn===b)return h.fn=g,this._firingCount&&(this._events[a]=d=d.slice()),void d.splice(e,1)}}else{for(e=0,f=d.length;e<f;e++)d[e].fn=g;delete this._events[a]}},fire:function(a,c,d){if(!this.listens(a,d))return this;var e=b({},c,{type:a,target:this});if(this._events){var f=this._events[a];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,h=f.length;g<h;g++){var i=f[g];i.fn.call(i.ctx||this,e)}this._firingCount--}}return d&&this._propagateEvent(e),this},listens:function(a,b){var c=this._events&&this._events[a];if(c&&c.length)return!0;if(b)for(var d in this._eventParents)if(this._eventParents[d].listens(a,b))return!0;return!1},once:function(a,b,d){if("object"==typeof a){for(var e in a)this.once(e,a[e],b);return this}var f=c(function(){this.off(a,b,d).off(a,f,d)},this);return this.on(a,b,d).on(a,f,d)},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[d(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[d(a)],this},_propagateEvent:function(a){for(var c in this._eventParents)this._eventParents[c].fire(a.type,b({layer:a.target},a),!0)}};ib.addEventListener=ib.on,ib.removeEventListener=ib.clearAllEventListeners=ib.off,ib.addOneTimeEventListener=ib.once,ib.fireEvent=ib.fire,ib.hasEventListeners=ib.listens;var jb=s.extend(ib);u.prototype={clone:function(){return new u(this.x,this.y)},add:function(a){return this.clone()._add(v(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(v(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new u(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new u(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(a){var b=(a=v(a)).x-this.x,c=a.y-this.y;return Math.sqrt(b*b+c*c)},equals:function(a){return(a=v(a)).x===this.x&&a.y===this.y},contains:function(a){return a=v(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+h(this.x)+", "+h(this.y)+")"}},w.prototype={extend:function(a){return a=v(a),this.min||this.max?(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)):(this.min=a.clone(),this.max=a.clone()),this},getCenter:function(a){return new u((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new u(this.min.x,this.max.y)},getTopRight:function(){return new u(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var b,c;return(a="number"==typeof a[0]||a instanceof u?v(a):x(a))instanceof w?(b=a.min,c=a.max):b=c=a,b.x>=this.min.x&&c.x<=this.max.x&&b.y>=this.min.y&&c.y<=this.max.y},intersects:function(a){a=x(a);var b=this.min,c=this.max,d=a.min,e=a.max,f=e.x>=b.x&&d.x<=c.x,g=e.y>=b.y&&d.y<=c.y;return f&&g},overlaps:function(a){a=x(a);var b=this.min,c=this.max,d=a.min,e=a.max,f=e.x>b.x&&d.x<c.x,g=e.y>b.y&&d.y<c.y;return f&&g},isValid:function(){return!(!this.min||!this.max)}},y.prototype={extend:function(a){var b,c,d=this._southWest,e=this._northEast;if(a instanceof A)b=a,c=a;else{if(!(a instanceof y))return a?this.extend(B(a)||z(a)):this;if(b=a._southWest,c=a._northEast,!b||!c)return this}return d||e?(d.lat=Math.min(b.lat,d.lat),d.lng=Math.min(b.lng,d.lng),e.lat=Math.max(c.lat,e.lat),e.lng=Math.max(c.lng,e.lng)):(this._southWest=new A(b.lat,b.lng),this._northEast=new A(c.lat,c.lng)),this},pad:function(a){var b=this._southWest,c=this._northEast,d=Math.abs(b.lat-c.lat)*a,e=Math.abs(b.lng-c.lng)*a;return new y(new A(b.lat-d,b.lng-e),new A(c.lat+d,c.lng+e))},getCenter:function(){return new A((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new A(this.getNorth(),this.getWest())},getSouthEast:function(){return new A(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){a="number"==typeof a[0]||a instanceof A||"lat"in a?B(a):z(a);var b,c,d=this._southWest,e=this._northEast;return a instanceof y?(b=a.getSouthWest(),c=a.getNorthEast()):b=c=a,b.lat>=d.lat&&c.lat<=e.lat&&b.lng>=d.lng&&c.lng<=e.lng},intersects:function(a){a=z(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest(),e=a.getNorthEast(),f=e.lat>=b.lat&&d.lat<=c.lat,g=e.lng>=b.lng&&d.lng<=c.lng;return f&&g},overlaps:function(a){a=z(a);var b=this._southWest,c=this._northEast,d=a.getSouthWest(),e=a.getNorthEast(),f=e.lat>b.lat&&d.lat<c.lat,g=e.lng>b.lng&&d.lng<c.lng;return f&&g},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,b){return!!a&&(a=z(a),this._southWest.equals(a.getSouthWest(),b)&&this._northEast.equals(a.getNorthEast(),b))},isValid:function(){return!(!this._southWest||!this._northEast)}},A.prototype={equals:function(a,b){return!!a&&(a=B(a),Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(void 0===b?1e-9:b))},toString:function(a){return"LatLng("+h(this.lat,a)+", "+h(this.lng,a)+")"},distanceTo:function(a){return lb.distance(this,B(a))},wrap:function(){return lb.wrapLatLng(this)},toBounds:function(a){var b=180*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return z([this.lat-b,this.lng-c],[this.lat+b,this.lng+c])},clone:function(){return new A(this.lat,this.lng,this.alt)}};var kb={latLngToPoint:function(a,b){var c=this.projection.project(a),d=this.scale(b);return this.transformation._transform(c,d)},pointToLatLng:function(a,b){var c=this.scale(b),d=this.transformation.untransform(a,c);return this.projection.unproject(d)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var b=this.projection.bounds,c=this.scale(a);return new w(this.transformation.transform(b.min,c),this.transformation.transform(b.max,c))},infinite:!1,wrapLatLng:function(a){var b=this.wrapLng?f(a.lng,this.wrapLng,!0):a.lng;return new A(this.wrapLat?f(a.lat,this.wrapLat,!0):a.lat,b,a.alt)},wrapLatLngBounds:function(a){var b=a.getCenter(),c=this.wrapLatLng(b),d=b.lat-c.lat,e=b.lng-c.lng;if(0===d&&0===e)return a;var f=a.getSouthWest(),g=a.getNorthEast();return new y(new A(f.lat-d,f.lng-e),new A(g.lat-d,g.lng-e))}},lb=b({},kb,{wrapLng:[-180,180],R:6371e3,distance:function(a,b){var c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=Math.sin(d)*Math.sin(e)+Math.cos(d)*Math.cos(e)*Math.cos((b.lng-a.lng)*c);return this.R*Math.acos(Math.min(f,1))}}),mb={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var b=Math.PI/180,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,a.lat),-c),e=Math.sin(d*b);return new u(this.R*a.lng*b,this.R*Math.log((1+e)/(1-e))/2)},unproject:function(a){var b=180/Math.PI;return new A((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*b,a.x*b/this.R)},bounds:function(){var a=6378137*Math.PI;return new w([-a,-a],[a,a])}()};C.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){return b=b||1,a.x=b*(this._a*a.x+this._b),a.y=b*(this._c*a.y+this._d),a},untransform:function(a,b){return b=b||1,new u((a.x/b-this._b)/this._a,(a.y/b-this._d)/this._c)}};var nb,ob,pb,qb,rb=b({},lb,{code:"EPSG:3857",projection:mb,transformation:function(){var a=.5/(Math.PI*mb.R);return D(a,.5,-a,.5)}()}),sb=b({},rb,{code:"EPSG:900913"}),tb=document.documentElement.style,ub="ActiveXObject"in window,vb=ub&&!document.addEventListener,wb="msLaunchUri"in navigator&&!("documentMode"in document),xb=G("webkit"),yb=G("android"),zb=G("android 2")||G("android 3"),Ab=!!window.opera,Bb=G("chrome"),Cb=G("gecko")&&!xb&&!Ab&&!ub,Db=!Bb&&G("safari"),Eb=G("phantom"),Fb="OTransition"in tb,Gb=0===navigator.platform.indexOf("Win"),Hb=ub&&"transition"in tb,Ib="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!zb,Jb="MozPerspective"in tb,Kb=!window.L_DISABLE_3D&&(Hb||Ib||Jb)&&!Fb&&!Eb,Lb="undefined"!=typeof orientation||G("mobile"),Mb=Lb&&xb,Nb=Lb&&Ib,Ob=!window.PointerEvent&&window.MSPointerEvent,Pb=!(!window.PointerEvent&&!Ob),Qb=!window.L_NO_TOUCH&&(Pb||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Rb=Lb&&Ab,Sb=Lb&&Cb,Tb=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ub=!!document.createElement("canvas").getContext,Vb=!(!document.createElementNS||!E("svg").createSVGRect),Wb=!Vb&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var b=a.firstChild;return b.style.behavior="url(#default#VML)",b&&"object"==typeof b.adj}catch(a){return!1}}(),Xb=(Object.freeze||Object)({ie:ub,ielt9:vb,edge:wb,webkit:xb,android:yb,android23:zb,opera:Ab,chrome:Bb,gecko:Cb,safari:Db,phantom:Eb,opera12:Fb,win:Gb,ie3d:Hb,webkit3d:Ib,gecko3d:Jb,any3d:Kb,mobile:Lb,mobileWebkit:Mb,mobileWebkit3d:Nb,msPointer:Ob,pointer:Pb,touch:Qb,mobileOpera:Rb,mobileGecko:Sb,retina:Tb,canvas:Ub,svg:Vb,vml:Wb}),Yb=Ob?"MSPointerDown":"pointerdown",Zb=Ob?"MSPointerMove":"pointermove",$b=Ob?"MSPointerUp":"pointerup",_b=Ob?"MSPointerCancel":"pointercancel",ac=["INPUT","SELECT","OPTION"],bc={},cc=!1,dc=0,ec=Ob?"MSPointerDown":Pb?"pointerdown":"touchstart",fc=Ob?"MSPointerUp":Pb?"pointerup":"touchend",gc="_leaflet_",hc="_leaflet_events",ic=Gb&&Bb?2*window.devicePixelRatio:Cb?window.devicePixelRatio:1,jc={},kc=(Object.freeze||Object)({on:T,off:U,stopPropagation:X,disableScrollPropagation:Y,disableClickPropagation:Z,preventDefault:$,stop:_,getMousePosition:aa,getWheelDelta:ba,fakeStop:ca,skipped:da,isExternalTarget:ea,addListener:T,removeListener:U}),lc=ua(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),mc=ua(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),nc="webkitTransition"===mc||"OTransition"===mc?mc+"End":"transitionend";if("onselectstart"in document)ob=function(){T(window,"selectstart",$)},pb=function(){U(window,"selectstart",$)};else{var oc=ua(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ob=function(){if(oc){var a=document.documentElement.style;qb=a[oc],a[oc]="none"}},pb=function(){oc&&(document.documentElement.style[oc]=qb,qb=void 0)}}var pc,qc,rc=(Object.freeze||Object)({TRANSFORM:lc,TRANSITION:mc,TRANSITION_END:nc,get:ga,getStyle:ha,create:ia,remove:ja,empty:ka,toFront:la,toBack:ma,hasClass:na,addClass:oa,removeClass:pa,setClass:qa,getClass:ra,setOpacity:sa,testProp:ua,setTransform:va,setPosition:wa,getPosition:xa,disableTextSelection:ob,enableTextSelection:pb,disableImageDrag:ya,enableImageDrag:za,preventOutline:Aa,restoreOutline:Ba}),sc=jb.extend({run:function(a,b,c,d){this.stop(),this._el=a,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=xa(a),this._offset=b.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(a){var b=+new Date-this._startTime,c=1e3*this._duration;b<c?this._runFrame(this._easeOut(b/c),a):(this._runFrame(1),this._complete())},_runFrame:function(a,b){var c=this._startPos.add(this._offset.multiplyBy(a));b&&c._round(),wa(this._el,c),this.fire("step")},_complete:function(){r(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),tc=jb.extend({options:{crs:rb,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,b){b=k(this,b),this._initContainer(a),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),b.maxBounds&&this.setMaxBounds(b.maxBounds),void 0!==b.zoom&&(this._zoom=this._limitZoom(b.zoom)),b.center&&void 0!==b.zoom&&this.setView(B(b.center),b.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=mc&&Kb&&!Rb&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),T(this._proxy,nc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,c,d){return c=void 0===c?this._zoom:this._limitZoom(c),a=this._limitCenter(B(a),c,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&!0!==d&&(void 0!==d.animate&&(d.zoom=b({animate:d.animate},d.zoom),d.pan=b({animate:d.animate,duration:d.duration},d.pan)),this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,d.zoom):this._tryAnimatedPan(a,d.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(a,c),this)},setZoom:function(a,b){return this._loaded?this.setView(this.getCenter(),a,{zoom:b}):(this._zoom=a,this)},zoomIn:function(a,b){return a=a||(Kb?this.options.zoomDelta:1),this.setZoom(this._zoom+a,b)},zoomOut:function(a,b){return a=a||(Kb?this.options.zoomDelta:1),this.setZoom(this._zoom-a,b)},setZoomAround:function(a,b,c){var d=this.getZoomScale(b),e=this.getSize().divideBy(2),f=(a instanceof u?a:this.latLngToContainerPoint(a)).subtract(e).multiplyBy(1-1/d),g=this.containerPointToLatLng(e.add(f));return this.setView(g,b,{zoom:c})},_getBoundsCenterZoom:function(a,b){b=b||{},a=a.getBounds?a.getBounds():z(a);var c=v(b.paddingTopLeft||b.padding||[0,0]),d=v(b.paddingBottomRight||b.padding||[0,0]),e=this.getBoundsZoom(a,!1,c.add(d));if((e="number"==typeof b.maxZoom?Math.min(b.maxZoom,e):e)===1/0)return{center:a.getCenter(),zoom:e};var f=d.subtract(c).divideBy(2),g=this.project(a.getSouthWest(),e),h=this.project(a.getNorthEast(),e);return{center:this.unproject(g.add(h).divideBy(2).add(f),e),zoom:e}},fitBounds:function(a,b){if(!(a=z(a)).isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(a,b);return this.setView(c.center,c.zoom,b)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a,b){if(a=v(a).round(),b=b||{},!a.x&&!a.y)return this.fire("moveend");if(!0!==b.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new sc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),b.noMoveStart||this.fire("movestart"),!1!==b.animate){oa(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,c,b.duration||.25,b.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,b,c){function d(a){var b=(r*r-p*p+(a?-1:1)*u*u*s*s)/(2*(a?r:p)*u*s),c=Math.sqrt(b*b+1)-b;return c<1e-9?-18:Math.log(c)}function e(a){return(Math.exp(a)-Math.exp(-a))/2}function f(a){
return(Math.exp(a)+Math.exp(-a))/2}function g(a){return e(a)/f(a)}function h(a){return p*(f(v)/f(v+t*a))}function i(a){return p*(f(v)*g(v+t*a)-e(v))/u}function j(a){return 1-Math.pow(1-a,1.5)}function k(){var c=(Date.now()-w)/y,d=j(c)*x;c<=1?(this._flyToFrame=q(k,this),this._move(this.unproject(l.add(m.subtract(l).multiplyBy(i(d)/s)),o),this.getScaleZoom(p/h(d),o),{flyTo:!0})):this._move(a,b)._moveEnd(!0)}if(!1===(c=c||{}).animate||!Kb)return this.setView(a,b,c);this._stop();var l=this.project(this.getCenter()),m=this.project(a),n=this.getSize(),o=this._zoom;a=B(a),b=void 0===b?o:b;var p=Math.max(n.x,n.y),r=p*this.getZoomScale(o,b),s=m.distanceTo(l)||1,t=1.42,u=t*t,v=d(0),w=Date.now(),x=(d(1)-v)/t,y=c.duration?1e3*c.duration:1e3*x*.8;return this._moveStart(!0),k.call(this),this},flyToBounds:function(a,b){var c=this._getBoundsCenterZoom(a,b);return this.flyTo(c.center,c.zoom,b)},setMaxBounds:function(a){return(a=z(a)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(a){return this.options.minZoom=a,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(a):this},setMaxZoom:function(a){return this.options.maxZoom=a,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(a):this},panInsideBounds:function(a,b){this._enforcingBounds=!0;var c=this.getCenter(),d=this._limitCenter(c,this._zoom,z(a));return c.equals(d)||this.panTo(d,b),this._enforcingBounds=!1,this},invalidateSize:function(a){if(!this._loaded)return this;a=b({animate:!1,pan:!0},!0===a?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var e=this.getSize(),f=d.divideBy(2).round(),g=e.divideBy(2).round(),h=f.subtract(g);return h.x||h.y?(a.animate&&a.pan?this.panBy(h):(a.pan&&this._rawPanBy(h),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:e})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=b({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c(this._handleGeolocationResponse,this),e=c(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,e,a):navigator.geolocation.getCurrentPosition(d,e,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){var b=a.code,c=a.message||(1===b?"permission denied":2===b?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:b,message:"Geolocation error: "+c+"."})},_handleGeolocationResponse:function(a){var b=new A(a.coords.latitude,a.coords.longitude),c=b.toBounds(a.coords.accuracy),d=this._locateOptions;if(d.setView){var e=this.getBoundsZoom(c);this.setView(b,d.maxZoom?Math.min(e,d.maxZoom):e)}var f={latlng:b,bounds:c,timestamp:a.timestamp};for(var g in a.coords)"number"==typeof a.coords[g]&&(f[g]=a.coords[g]);this.fire("locationfound",f)},addHandler:function(a,b){if(!b)return this;var c=this[a]=new b(this);return this._handlers.push(c),this.options[a]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(a){this._container._leaflet_id=void 0,this._containerId=void 0}ja(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)ja(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,b){var c=ia("div","leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),b||this._mapPane);return a&&(this._panes[a]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds();return new y(this.unproject(a.getBottomLeft()),this.unproject(a.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,b,c){a=z(a),c=v(c||[0,0]);var d=this.getZoom()||0,e=this.getMinZoom(),f=this.getMaxZoom(),g=a.getNorthWest(),h=a.getSouthEast(),i=this.getSize().subtract(c),j=x(this.project(h,d),this.project(g,d)).getSize(),k=Kb?this.options.zoomSnap:1,l=i.x/j.x,m=i.y/j.y,n=b?Math.max(l,m):Math.min(l,m);return d=this.getScaleZoom(n,d),k&&(d=Math.round(d/(k/100))*(k/100),d=b?Math.ceil(d/k)*k:Math.floor(d/k)*k),Math.max(e,Math.min(f,d))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new u(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,b){var c=this._getTopLeftPoint(a,b);return new w(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(void 0===a?this.getZoom():a)},getPane:function(a){return"string"==typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,b){var c=this.options.crs;return b=void 0===b?this._zoom:b,c.scale(a)/c.scale(b)},getScaleZoom:function(a,b){var c=this.options.crs;b=void 0===b?this._zoom:b;var d=c.zoom(a*c.scale(b));return isNaN(d)?1/0:d},project:function(a,b){return b=void 0===b?this._zoom:b,this.options.crs.latLngToPoint(B(a),b)},unproject:function(a,b){return b=void 0===b?this._zoom:b,this.options.crs.pointToLatLng(v(a),b)},layerPointToLatLng:function(a){var b=v(a).add(this.getPixelOrigin());return this.unproject(b)},latLngToLayerPoint:function(a){return this.project(B(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(B(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(z(a))},distance:function(a,b){return this.options.crs.distance(B(a),B(b))},containerPointToLayerPoint:function(a){return v(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return v(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var b=this.containerPointToLayerPoint(v(a));return this.layerPointToLatLng(b)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(B(a)))},mouseEventToContainerPoint:function(a){return aa(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var b=this._container=ga(a);if(!b)throw new Error("Map container not found.");if(b._leaflet_id)throw new Error("Map container is already initialized.");T(b,"scroll",this._onScroll,this),this._containerId=d(b)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Kb,oa(a,"leaflet-container"+(Qb?" leaflet-touch":"")+(Tb?" leaflet-retina":"")+(vb?" leaflet-oldie":"")+(Db?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var b=ha(a,"position");"absolute"!==b&&"relative"!==b&&"fixed"!==b&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wa(this._mapPane,new u(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(oa(a.markerPane,"leaflet-zoom-hide"),oa(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,b){wa(this._mapPane,new u(0,0));var c=!this._loaded;this._loaded=!0,b=this._limitZoom(b),this.fire("viewprereset");var d=this._zoom!==b;this._moveStart(d)._move(a,b)._moveEnd(d),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(a){return a&&this.fire("zoomstart"),this.fire("movestart")},_move:function(a,b,c){void 0===b&&(b=this._zoom);var d=this._zoom!==b;return this._zoom=b,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),(d||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return r(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){wa(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[d(this._container)]=this;var b=a?U:T;b(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&b(window,"resize",this._onResize,this),Kb&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){r(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,b){for(var c,e=[],f="mouseout"===b||"mouseover"===b,g=a.target||a.srcElement,h=!1;g;){if((c=this._targets[d(g)])&&("click"===b||"preclick"===b)&&!a._simulated&&this._draggableMoved(c)){h=!0;break}if(c&&c.listens(b,!0)){if(f&&!ea(g,a))break;if(e.push(c),f)break}if(g===this._container)break;g=g.parentNode}return e.length||h||f||!ea(g,a)||(e=[this]),e},_handleDOMEvent:function(a){if(this._loaded&&!da(a)){var b=a.type;"mousedown"!==b&&"keypress"!==b||Aa(a.target||a.srcElement),this._fireDOMEvent(a,b)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,c,d){if("click"===a.type){var e=b({},a);e.type="preclick",this._fireDOMEvent(e,e.type,d)}if(!a._stopped&&(d=(d||[]).concat(this._findEventTargets(a,c))).length){var f=d[0];"contextmenu"===c&&f.listens(c,!0)&&$(a);var g={originalEvent:a};if("keypress"!==a.type){var h=f.options&&"icon"in f.options;g.containerPoint=h?this.latLngToContainerPoint(f.getLatLng()):this.mouseEventToContainerPoint(a),g.layerPoint=this.containerPointToLayerPoint(g.containerPoint),g.latlng=h?f.getLatLng():this.layerPointToLatLng(g.layerPoint)}for(var i=0;i<d.length;i++)if(d[i].fire(c,g,!0),g.originalEvent._stopped||!1===d[i].options.bubblingMouseEvents&&-1!==n(this._mouseEvents,c))return}},_draggableMoved:function(a){return(a=a.dragging&&a.dragging.enabled()?a:this).dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){return this._loaded?a.call(b||this,{target:this}):this.on("load",a,b),this},_getMapPanePos:function(){return xa(this._mapPane)||new u(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,b){return(a&&void 0!==b?this._getNewPixelOrigin(a,b):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,b){var c=this.getSize()._divideBy(2);return this.project(a,b)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return this.project(a,b)._subtract(d)},_latLngBoundsToNewLayerBounds:function(a,b,c){var d=this._getNewPixelOrigin(c,b);return x([this.project(a.getSouthWest(),b)._subtract(d),this.project(a.getNorthWest(),b)._subtract(d),this.project(a.getSouthEast(),b)._subtract(d),this.project(a.getNorthEast(),b)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,b,c){if(!c)return a;var d=this.project(a,b),e=this.getSize().divideBy(2),f=new w(d.subtract(e),d.add(e)),g=this._getBoundsOffset(f,c,b);return g.round().equals([0,0])?a:this.unproject(d.add(g),b)},_limitOffset:function(a,b){if(!b)return a;var c=this.getPixelBounds(),d=new w(c.min.add(a),c.max.add(a));return a.add(this._getBoundsOffset(d,b))},_getBoundsOffset:function(a,b,c){var d=x(this.project(b.getNorthEast(),c),this.project(b.getSouthWest(),c)),e=d.min.subtract(a.min),f=d.max.subtract(a.max);return new u(this._rebound(e.x,-f.x),this._rebound(e.y,-f.y))},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),c=this.getMaxZoom(),d=Kb?this.options.zoomSnap:1;return d&&(a=Math.round(a/d)*d),Math.max(b,Math.min(c,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pa(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();return!(!0!==(b&&b.animate)&&!this.getSize().contains(c)||(this.panBy(c,b),0))},_createAnimProxy:function(){var a=this._proxy=ia("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(a){var b=lc,c=this._proxy.style[b];va(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),c===this._proxy.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var a=this.getCenter(),b=this.getZoom();va(this._proxy,this.project(a,b),this.getZoomScale(b,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ja(this._proxy),delete this._proxy},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||!1===c.animate||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),e=this._getCenterOffset(a)._divideBy(1-1/d);return!(!0!==c.animate&&!this.getSize().contains(e)||(q(function(){this._moveStart(!0)._animateZoom(a,b,!0)},this),0))},_animateZoom:function(a,b,d,e){d&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=b,oa(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:b,noUpdate:e}),setTimeout(c(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(pa(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),q(function(){this._moveEnd(!0)},this))}}),uc=s.extend({options:{position:"topright"},initialize:function(a){k(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;return b&&b.removeControl(this),this.options.position=a,b&&b.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var b=this._container=this.onAdd(a),c=this.getPosition(),d=a._controlCorners[c];return oa(b,"leaflet-control"),-1!==c.indexOf("bottom")?d.insertBefore(b,d.firstChild):d.appendChild(b),this},remove:function(){return this._map?(ja(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),vc=function(a){return new uc(a)};tc.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){function a(a,e){var f=c+a+" "+c+e;b[a+e]=ia("div",f,d)}var b=this._controlCorners={},c="leaflet-",d=this._controlContainer=ia("div",c+"control-container",this._container);a("top","left"),a("top","right"),a("bottom","left"),a("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)ja(this._controlCorners[a]);ja(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var wc=uc.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,b,c,d){return c<d?-1:d<c?1:0}},initialize:function(a,b,c){k(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var d in a)this._addLayer(a[d],d);for(d in b)this._addLayer(b[d],d,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var b=0;b<this._layers.length;b++)this._layers[b].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return uc.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._map?this._update():this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var b=this._getLayer(d(a));return b&&this._layers.splice(this._layers.indexOf(b),1),this._map?this._update():this},expand:function(){oa(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._form.clientHeight?(oa(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=a+"px"):pa(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pa(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=ia("div",a),c=this.options.collapsed;b.setAttribute("aria-haspopup",!0),Z(b),Y(b);var d=this._form=ia("form",a+"-list");c&&(this._map.on("click",this.collapse,this),yb||T(b,{mouseenter:this.expand,mouseleave:this.collapse},this));var e=this._layersLink=ia("a",a+"-toggle",b);e.href="#",e.title="Layers",Qb?(T(e,"click",_),T(e,"click",this.expand,this)):T(e,"focus",this.expand,this),c||this.expand(),this._baseLayersList=ia("div",a+"-base",d),this._separator=ia("div",a+"-separator",d),this._overlaysList=ia("div",a+"-overlays",d),b.appendChild(d)},_getLayer:function(a){for(var b=0;b<this._layers.length;b++)if(this._layers[b]&&d(this._layers[b].layer)===a)return this._layers[b]},_addLayer:function(a,b,d){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:b,overlay:d}),this.options.sortLayers&&this._layers.sort(c(function(a,b){return this.options.sortFunction(a.layer,b.layer,a.name,b.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ka(this._baseLayersList),ka(this._overlaysList),this._layerControlInputs=[];var a,b,c,d,e=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),b=b||d.overlay,a=a||!d.overlay,e+=d.overlay?0:1;return this.options.hideSingleBase&&(a=a&&e>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=b&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var b=this._getLayer(d(a.target)),c=b.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)},_createRadioElement:function(a,b){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(b?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(a){var b,c=document.createElement("label"),e=this._map.hasLayer(a.layer);a.overlay?((b=document.createElement("input")).type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=e):b=this._createRadioElement("leaflet-base-layers",e),this._layerControlInputs.push(b),b.layerId=d(a.layer),T(b,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+a.name;var g=document.createElement("div");return c.appendChild(g),g.appendChild(b),g.appendChild(f),(a.overlay?this._overlaysList:this._baseLayersList).appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){var a,b,c=this._layerControlInputs,d=[],e=[];this._handlingClick=!0;for(var f=c.length-1;f>=0;f--)a=c[f],b=this._getLayer(a.layerId).layer,a.checked?d.push(b):a.checked||e.push(b);for(f=0;f<e.length;f++)this._map.hasLayer(e[f])&&this._map.removeLayer(e[f]);for(f=0;f<d.length;f++)this._map.hasLayer(d[f])||this._map.addLayer(d[f]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var a,b,c=this._layerControlInputs,d=this._map.getZoom(),e=c.length-1;e>=0;e--)a=c[e],b=this._getLayer(a.layerId).layer,a.disabled=void 0!==b.options.minZoom&&d<b.options.minZoom||void 0!==b.options.maxZoom&&d>b.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),xc=uc.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(a){var b="leaflet-control-zoom",c=ia("div",b+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,b+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,b+"-out",c,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,b,c,d,e){var f=ia("a",c,d);return f.innerHTML=a,f.href="#",f.title=b,f.setAttribute("role","button"),f.setAttribute("aria-label",b),Z(f),T(f,"click",_),T(f,"click",e,this),T(f,"click",this._refocusOnMap,this),f},_updateDisabled:function(){var a=this._map,b="leaflet-disabled";pa(this._zoomInButton,b),pa(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMinZoom())&&oa(this._zoomOutButton,b),(this._disabled||a._zoom===a.getMaxZoom())&&oa(this._zoomInButton,b)}});tc.mergeOptions({zoomControl:!0}),tc.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xc,this.addControl(this.zoomControl))});var yc=uc.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var b=ia("div","leaflet-control-scale"),c=this.options;return this._addScales(c,"leaflet-control-scale-line",b),a.on(c.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),b},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,b,c){a.metric&&(this._mScale=ia("div",b,c)),a.imperial&&(this._iScale=ia("div",b,c))},_update:function(){var a=this._map,b=a.getSize().y/2,c=a.distance(a.containerPointToLatLng([0,b]),a.containerPointToLatLng([this.options.maxWidth,b]));this._updateScales(c)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var b=this._getRoundNum(a),c=b<1e3?b+" m":b/1e3+" km";this._updateScale(this._mScale,c,b/a)},_updateImperial:function(a){var b,c,d,e=3.2808399*a;e>5280?(b=e/5280,c=this._getRoundNum(b),this._updateScale(this._iScale,c+" mi",c/b)):(d=this._getRoundNum(e),this._updateScale(this._iScale,d+" ft",d/e))},_updateScale:function(a,b,c){a.style.width=Math.round(this.options.maxWidth*c)+"px",a.innerHTML=b},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}}),zc=uc.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){k(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=ia("div","leaflet-control-attribution"),Z(this._container);for(var b in a._layers)a._layers[b].getAttribution&&this.addAttribution(a._layers[b].getAttribution());return this._update(),this._container},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var b in this._attributions)this._attributions[b]&&a.push(b);var c=[];this.options.prefix&&c.push(this.options.prefix),a.length&&c.push(a.join(", ")),this._container.innerHTML=c.join(" | ")}}});tc.mergeOptions({attributionControl:!0}),tc.addInitHook(function(){this.options.attributionControl&&(new zc).addTo(this)}),uc.Layers=wc,uc.Zoom=xc,uc.Scale=yc,uc.Attribution=zc,vc.layers=function(a,b,c){return new wc(a,b,c)},vc.zoom=function(a){return new xc(a)},vc.scale=function(a){return new yc(a)},vc.attribution=function(a){return new zc(a)};var Ac,Bc=s.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),Cc={Events:ib},Dc=Qb?"touchstart mousedown":"mousedown",Ec={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Fc={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Gc=jb.extend({options:{clickTolerance:3},initialize:function(a,b,c,d){k(this,d),this._element=a,this._dragStartTarget=b||a,this._preventOutline=c},enable:function(){this._enabled||(T(this._dragStartTarget,Dc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Gc._dragging===this&&this.finishDrag(),U(this._dragStartTarget,Dc,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!na(this._element,"leaflet-zoom-anim")&&!(Gc._dragging||a.shiftKey||1!==a.which&&1!==a.button&&!a.touches||(Gc._dragging=this,this._preventOutline&&Aa(this._element),ya(),ob(),this._moving)))){this.fire("down");var b=a.touches?a.touches[0]:a;this._startPoint=new u(b.clientX,b.clientY),T(document,Fc[a.type],this._onMove,this),T(document,Ec[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&a.touches.length>1)this._moved=!0;else{var b=a.touches&&1===a.touches.length?a.touches[0]:a,c=new u(b.clientX,b.clientY).subtract(this._startPoint);(c.x||c.y)&&(Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||($(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=xa(this._element).subtract(c),oa(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),oa(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,r(this._animRequest),this._lastEvent=a,this._animRequest=q(this._updatePosition,this,!0)))}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),wa(this._element,this._newPos),this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){pa(document.body,"leaflet-dragging"),this._lastTarget&&(pa(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var a in Fc)U(document,Fc[a],this._onMove,this),U(document,Ec[a],this._onUp,this);za(),pb(),this._moved&&this._moving&&(r(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Gc._dragging=!1}}),Hc=(Object.freeze||Object)({simplify:Ca,pointToSegmentDistance:Da,closestPointOnSegment:function(a,b,c){return La(a,b,c)},clipSegment:Ha,_getEdgeIntersection:Ia,_getBitCode:Ja,_sqClosestPointOnSegment:La,isFlat:Ma,_flat:Na}),Ic=(Object.freeze||Object)({clipPolygon:Oa}),Jc={project:function(a){return new u(a.lng,a.lat)},unproject:function(a){return new A(a.y,a.x)},bounds:new w([-180,-90],[180,90])},Kc={R:6378137,R_MINOR:6356752.314245179,bounds:new w([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(a){var b=Math.PI/180,c=this.R,d=a.lat*b,e=this.R_MINOR/c,f=Math.sqrt(1-e*e),g=f*Math.sin(d),h=Math.tan(Math.PI/4-d/2)/Math.pow((1-g)/(1+g),f/2);return d=-c*Math.log(Math.max(h,1e-10)),new u(a.lng*b*c,d)},unproject:function(a){for(var b,c=180/Math.PI,d=this.R,e=this.R_MINOR/d,f=Math.sqrt(1-e*e),g=Math.exp(-a.y/d),h=Math.PI/2-2*Math.atan(g),i=0,j=.1;i<15&&Math.abs(j)>1e-7;i++)b=f*Math.sin(h),b=Math.pow((1-b)/(1+b),f/2),h+=j=Math.PI/2-2*Math.atan(g*b)-h;return new A(h*c,a.x*c/d)}},Lc=(Object.freeze||Object)({LonLat:Jc,Mercator:Kc,SphericalMercator:mb}),Mc=b({},lb,{code:"EPSG:3395",projection:Kc,transformation:function(){var a=.5/(Math.PI*Kc.R);return D(a,.5,-a,.5)}()}),Nc=b({},lb,{code:"EPSG:4326",projection:Jc,transformation:D(1/180,1,-1/180,.5)}),Oc=b({},kb,{projection:Jc,transformation:D(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,b){var c=b.lng-a.lng,d=b.lat-a.lat;return Math.sqrt(c*c+d*d)},infinite:!0});kb.Earth=lb,kb.EPSG3395=Mc,kb.EPSG3857=rb,kb.EPSG900913=sb,kb.EPSG4326=Nc,kb.Simple=Oc;var Pc=jb.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[d(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[d(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var b=a.target;if(b.hasLayer(this)){if(this._map=b,this._zoomAnimated=b._zoomAnimated,this.getEvents){var c=this.getEvents();b.on(c,this),this.once("remove",function(){b.off(c,this)},this)}this.onAdd(b),this.getAttribution&&b.attributionControl&&b.attributionControl.addAttribution(this.getAttribution()),
this.fire("add"),b.fire("layeradd",{layer:this})}}});tc.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var b=d(a);return this._layers[b]?this:(this._layers[b]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var b=d(a);return this._layers[b]?(this._loaded&&a.onRemove(this),a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution()),delete this._layers[b],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return!!a&&d(a)in this._layers},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},_addLayers:function(a){for(var b=0,c=(a=a?cb(a)?a:[a]:[]).length;b<c;b++)this.addLayer(a[b])},_addZoomLimit:function(a){!isNaN(a.options.maxZoom)&&isNaN(a.options.minZoom)||(this._zoomBoundLayers[d(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var b=d(a);this._zoomBoundLayers[b]&&(delete this._zoomBoundLayers[b],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,b=-1/0,c=this._getZoomSpan();for(var d in this._zoomBoundLayers){var e=this._zoomBoundLayers[d].options;a=void 0===e.minZoom?a:Math.min(a,e.minZoom),b=void 0===e.maxZoom?b:Math.max(b,e.maxZoom)}this._layersMaxZoom=b===-1/0?void 0:b,this._layersMinZoom=a===1/0?void 0:a,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Qc=Pc.extend({initialize:function(a){this._layers={};var b,c;if(a)for(b=0,c=a.length;b<c;b++)this.addLayer(a[b])},addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[b]&&this._map.removeLayer(this._layers[b]),delete this._layers[b],this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){for(var a in this._layers)this.removeLayer(this._layers[a]);return this},invoke:function(a){var b,c,d=Array.prototype.slice.call(arguments,1);for(b in this._layers)(c=this._layers[b])[a]&&c[a].apply(c,d);return this},onAdd:function(a){for(var b in this._layers)a.addLayer(this._layers[b])},onRemove:function(a){for(var b in this._layers)a.removeLayer(this._layers[b])},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];for(var b in this._layers)a.push(this._layers[b]);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return d(a)}}),Rc=Qc.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Qc.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Qc.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new y;for(var b in this._layers){var c=this._layers[b];a.extend(c.getBounds?c.getBounds():c.getLatLng())}return a}}),Sc=s.extend({initialize:function(a){k(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);if(!c){if("icon"===a)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,b&&"IMG"===b.tagName?b:null);return this._setIconStyles(d,a),d},_setIconStyles:function(a,b){var c=this.options,d=c[b+"Size"];"number"==typeof d&&(d=[d,d]);var e=v(d),f=v("shadow"===b&&c.shadowAnchor||c.iconAnchor||e&&e.divideBy(2,!0));a.className="leaflet-marker-"+b+" "+(c.className||""),f&&(a.style.marginLeft=-f.x+"px",a.style.marginTop=-f.y+"px"),e&&(a.style.width=e.x+"px",a.style.height=e.y+"px")},_createImg:function(a,b){return b=b||document.createElement("img"),b.src=a,b},_getIconUrl:function(a){return Tb&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),Tc=Sc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return Tc.imagePath||(Tc.imagePath=this._detectIconPath()),(this.options.imagePath||Tc.imagePath)+Sc.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=ia("div","leaflet-default-icon-path",document.body),b=ha(a,"background-image")||ha(a,"backgroundImage");return document.body.removeChild(a),b=null===b||0!==b.indexOf("url")?"":b.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,"")}}),Uc=Bc.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Gc(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),oa(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pa(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(a){var b=this._marker,c=b._shadow,d=xa(b._icon),e=b._map.layerPointToLatLng(d);c&&wa(c,d),b._latlng=e,a.latlng=e,a.oldLatLng=this._oldLatLng,b.fire("move",a).fire("drag",a)},_onDragEnd:function(a){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Vc=Pc.extend({options:{icon:new Tc,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(a,b){k(this,b),this._latlng=B(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var b=this._latlng;return this._latlng=B(a),this.update(),this.fire("move",{oldLatLng:b,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,b="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=a.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,a.title&&(c.title=a.title),a.alt&&(c.alt=a.alt)),oa(c,b),a.keyboard&&(c.tabIndex="0"),this._icon=c,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var e=a.icon.createShadow(this._shadow),f=!1;e!==this._shadow&&(this._removeShadow(),f=!0),e&&(oa(e,b),e.alt=""),this._shadow=e,a.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),e&&f&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),ja(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ja(this._shadow),this._shadow=null},_setPos:function(a){wa(this._icon,a),this._shadow&&wa(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(b)},_initInteraction:function(){if(this.options.interactive&&(oa(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Uc)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Uc(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;sa(this._icon,a),this._shadow&&sa(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),Wc=Pc.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return k(this,a),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(Qb?10:0)}}),Xc=Wc.extend({options:{fill:!0,radius:10},initialize:function(a,b){k(this,b),this._latlng=B(a),this._radius=this.options.radius},setLatLng:function(a){return this._latlng=B(a),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var b=a&&a.radius||this._radius;return Wc.prototype.setStyle.call(this,a),this.setRadius(b),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,b=this._radiusY||a,c=this._clickTolerance(),d=[a+c,b+c];this._pxBounds=new w(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Yc=Xc.extend({initialize:function(a,c,d){if("number"==typeof c&&(c=b({},d,{radius:c})),k(this,c),this._latlng=B(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new y(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Wc.prototype.setStyle,_project:function(){var a=this._latlng.lng,b=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===lb.distance){var e=Math.PI/180,f=this._mRadius/lb.R/e,g=c.project([b+f,a]),h=c.project([b-f,a]),i=g.add(h).divideBy(2),j=c.unproject(i).lat,k=Math.acos((Math.cos(f*e)-Math.sin(b*e)*Math.sin(j*e))/(Math.cos(b*e)*Math.cos(j*e)))/e;(isNaN(k)||0===k)&&(k=f/Math.cos(Math.PI/180*b)),this._point=i.subtract(c.getPixelOrigin()),this._radius=isNaN(k)?0:Math.max(Math.round(i.x-c.project([j,a-k]).x),1),this._radiusY=Math.max(Math.round(i.y-g.y),1)}else{var l=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(l).x}this._updateBounds()}}),Zc=Wc.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,b){k(this,b),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var b,c,d=1/0,e=null,f=La,g=0,h=this._parts.length;g<h;g++)for(var i=this._parts[g],j=1,k=i.length;j<k;j++){var l=f(a,b=i[j-1],c=i[j],!0);l<d&&(d=l,e=f(a,b,c))}return e&&(e.distance=Math.sqrt(d)),e},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h=this._rings[0],i=h.length;if(!i)return null;for(a=0,b=0;a<i-1;a++)b+=h[a].distanceTo(h[a+1])/2;if(0===b)return this._map.layerPointToLatLng(h[0]);for(a=0,d=0;a<i-1;a++)if(e=h[a],f=h[a+1],c=e.distanceTo(f),(d+=c)>b)return g=(d-b)/c,this._map.layerPointToLatLng([f.x-g*(f.x-e.x),f.y-g*(f.y-e.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,b){return b=b||this._defaultShape(),a=B(a),b.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new y,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Ma(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var b=[],c=Ma(a),d=0,e=a.length;d<e;d++)c?(b[d]=B(a[d]),this._bounds.extend(b[d])):b[d]=this._convertLatLngs(a[d]);return b},_project:function(){var a=new w;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a);var b=this._clickTolerance(),c=new u(b,b);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(c),a.max._add(c),this._pxBounds=a)},_projectLatlngs:function(a,b,c){var d,e,f=a[0]instanceof A,g=a.length;if(f){for(e=[],d=0;d<g;d++)e[d]=this._map.latLngToLayerPoint(a[d]),c.extend(e[d]);b.push(e)}else for(d=0;d<g;d++)this._projectLatlngs(a[d],b,c)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var b,c,d,e,f,g,h,i=this._parts;for(b=0,d=0,e=this._rings.length;b<e;b++)for(c=0,f=(h=this._rings[b]).length;c<f-1;c++)(g=Ha(h[c],h[c+1],a,c,!0))&&(i[d]=i[d]||[],i[d].push(g[0]),g[1]===h[c+1]&&c!==f-2||(i[d].push(g[1]),d++))}},_simplifyPoints:function(){for(var a=this._parts,b=this.options.smoothFactor,c=0,d=a.length;c<d;c++)a[c]=Ca(a[c],b)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,b){var c,d,e,f,g,h,i=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(c=0,f=this._parts.length;c<f;c++)for(d=0,e=(g=(h=this._parts[c]).length)-1;d<g;e=d++)if((b||0!==d)&&Da(a,h[e],h[d])<=i)return!0;return!1}});Zc._flat=Na;var $c=Zc.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var a,b,c,d,e,f,g,h,i,j=this._rings[0],k=j.length;if(!k)return null;for(f=g=h=0,a=0,b=k-1;a<k;b=a++)c=j[a],d=j[b],e=c.y*d.x-d.y*c.x,g+=(c.x+d.x)*e,h+=(c.y+d.y)*e,f+=3*e;return i=0===f?j[0]:[g/f,h/f],this._map.layerPointToLatLng(i)},_convertLatLngs:function(a){var b=Zc.prototype._convertLatLngs.call(this,a),c=b.length;return c>=2&&b[0]instanceof A&&b[0].equals(b[c-1])&&b.pop(),b},_setLatLngs:function(a){Zc.prototype._setLatLngs.call(this,a),Ma(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ma(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,b=this.options.weight,c=new u(b,b);if(a=new w(a.min.subtract(c),a.max.add(c)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var d,e=0,f=this._rings.length;e<f;e++)(d=Oa(this._rings[e],a,!0)).length&&this._parts.push(d)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var b,c,d,e,f,g,h,i,j=!1;if(!this._pxBounds.contains(a))return!1;for(e=0,h=this._parts.length;e<h;e++)for(f=0,g=(i=(b=this._parts[e]).length)-1;f<i;g=f++)c=b[f],d=b[g],c.y>a.y!=d.y>a.y&&a.x<(d.x-c.x)*(a.y-c.y)/(d.y-c.y)+c.x&&(j=!j);return j||Zc.prototype._containsPoint.call(this,a,!0)}}),_c=Rc.extend({initialize:function(a,b){k(this,b),this._layers={},a&&this.addData(a)},addData:function(a){var b,c,d,e=cb(a)?a:a.features;if(e){for(b=0,c=e.length;b<c;b++)((d=e[b]).geometries||d.geometry||d.features||d.coordinates)&&this.addData(d);return this}var f=this.options;if(f.filter&&!f.filter(a))return this;var g=Pa(a,f);return g?(g.feature=Va(a),g.defaultOptions=g.options,this.resetStyle(g),f.onEachFeature&&f.onEachFeature(a,g),this.addLayer(g)):this},resetStyle:function(a){return a.options=b({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this},setStyle:function(a){return this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){"function"==typeof b&&(b=b(a.feature)),a.setStyle&&a.setStyle(b)}}),ad={toGeoJSON:function(a){return Ua(this,{type:"Point",coordinates:Sa(this.getLatLng(),a)})}};Vc.include(ad),Yc.include(ad),Xc.include(ad),Zc.include({toGeoJSON:function(a){var b=!Ma(this._latlngs),c=Ta(this._latlngs,b?1:0,!1,a);return Ua(this,{type:(b?"Multi":"")+"LineString",coordinates:c})}}),$c.include({toGeoJSON:function(a){var b=!Ma(this._latlngs),c=b&&!Ma(this._latlngs[0]),d=Ta(this._latlngs,c?2:b?1:0,!0,a);return b||(d=[d]),Ua(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}}),Qc.include({toMultiPoint:function(a){var b=[];return this.eachLayer(function(c){b.push(c.toGeoJSON(a).geometry.coordinates)}),Ua(this,{type:"MultiPoint",coordinates:b})},toGeoJSON:function(a){var b=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===b)return this.toMultiPoint(a);var c="GeometryCollection"===b,d=[];return this.eachLayer(function(b){if(b.toGeoJSON){var e=b.toGeoJSON(a);if(c)d.push(e.geometry);else{var f=Va(e);"FeatureCollection"===f.type?d.push.apply(d,f.features):d.push(f)}}}),c?Ua(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});var bd=Wa,cd=Pc.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,b,c){this._url=a,this._bounds=z(b),k(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(oa(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ja(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&la(this._image),this},bringToBack:function(){return this._map&&ma(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=z(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._image=ia("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":"")+(this.options.className||""));a.onselectstart=g,a.onmousemove=g,a.onload=c(this.fire,this,"load"),a.onerror=c(this._overlayOnError,this,"error"),this.options.crossOrigin&&(a.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),a.src=this._url,a.alt=this.options.alt},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;va(this._image,c,b)},_reset:function(){var a=this._image,b=new w(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=b.getSize();wa(a,b.min),a.style.width=c.x+"px",a.style.height=c.y+"px"},_updateOpacity:function(){sa(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)}}),dd=cd.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var a="VIDEO"===this._url.tagName,b=this._image=a?this._url:ia("video");if(b.class=b.class||"",b.class+="leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""),b.onselectstart=g,b.onmousemove=g,b.onloadeddata=c(this.fire,this,"load"),!a){cb(this._url)||(this._url=[this._url]),b.autoplay=!!this.options.autoplay,b.loop=!!this.options.loop;for(var d=0;d<this._url.length;d++){var e=ia("source");e.src=this._url[d],b.appendChild(e)}}}}),ed=Pc.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,b){k(this,a),this._source=b},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&sa(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&sa(this._container,1),this.bringToFront()},onRemove:function(a){a._fadeAnimated?(sa(this._container,0),this._removeTimeout=setTimeout(c(ja,void 0,this._container),200)):ja(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=B(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&la(this._container),this},bringToBack:function(){return this._map&&ma(this._container),this},_updateContent:function(){if(this._content){var a=this._contentNode,b="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof b)a.innerHTML=b;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),b=v(this.options.offset),c=this._getAnchor();this._zoomAnimated?wa(this._container,a.add(c)):b=b.add(a).add(c);var d=this._containerBottom=-b.y,e=this._containerLeft=-Math.round(this._containerWidth/2)+b.x;this._container.style.bottom=d+"px",this._container.style.left=e+"px"}},_getAnchor:function(){return[0,0]}}),fd=ed.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(a){return a.openPopup(this),this},onAdd:function(a){ed.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Wc||this._source.on("preclick",X))},onRemove:function(a){ed.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Wc||this._source.off("preclick",X))},getEvents:function(){var a=ed.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this._close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a="leaflet-popup",b=this._container=ia("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=ia("div",a+"-content-wrapper",b);if(this._contentNode=ia("div",a+"-content",c),Z(c),Y(this._contentNode),T(c,"contextmenu",X),this._tipContainer=ia("div",a+"-tip-container",b),this._tip=ia("div",a+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=ia("a",a+"-close-button",b);d.href="#close",d.innerHTML="&#215;",T(d,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var a=this._contentNode,b=a.style;b.width="",b.whiteSpace="nowrap";var c=a.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),b.width=c+1+"px",b.whiteSpace="",b.height="";var d=a.offsetHeight,e=this.options.maxHeight;e&&d>e?(b.height=e+"px",oa(a,"leaflet-popup-scrolled")):pa(a,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),c=this._getAnchor();wa(this._container,b.add(c))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,b=parseInt(ha(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+b,d=this._containerWidth,e=new u(this._containerLeft,-c-this._containerBottom);e._add(xa(this._container));var f=a.layerPointToContainerPoint(e),g=v(this.options.autoPanPadding),h=v(this.options.autoPanPaddingTopLeft||g),i=v(this.options.autoPanPaddingBottomRight||g),j=a.getSize(),k=0,l=0;f.x+d+i.x>j.x&&(k=f.x+d-j.x+i.x),f.x-k-h.x<0&&(k=f.x-h.x),f.y+c+i.y>j.y&&(l=f.y+c-j.y+i.y),f.y-l-h.y<0&&(l=f.y-h.y),(k||l)&&a.fire("autopanstart").panBy([k,l])}},_onCloseButtonClick:function(a){this._close(),_(a)},_getAnchor:function(){return v(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});tc.mergeOptions({closePopupOnClick:!0}),tc.include({openPopup:function(a,b,c){return a instanceof fd||(a=new fd(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=a,this.addLayer(a))},closePopup:function(a){return a&&a!==this._popup||(a=this._popup,this._popup=null),a&&this.removeLayer(a),this}}),Pc.include({bindPopup:function(a,b){return a instanceof fd?(k(a,b),this._popup=a,a._source=this):(this._popup&&!b||(this._popup=new fd(b,this)),this._popup.setContent(a)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a,b){if(a instanceof Pc||(b=a,a=this),a instanceof Rc)for(var c in this._layers){a=this._layers[c];break}return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,b)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(a){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(a)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){var b=a.layer||a.target;this._popup&&this._map&&(_(a),b instanceof Wc?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===b?this.closePopup():this.openPopup(b,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){13===a.originalEvent.keyCode&&this._openPopup(a)}});var gd=ed.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(a){ed.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){ed.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=ed.prototype.getEvents.call(this);return Qb&&!this.options.permanent&&(a.preclick=this._close),a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var a="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ia("div",a)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var b=this._map,c=this._container,d=b.latLngToContainerPoint(b.getCenter()),e=b.layerPointToContainerPoint(a),f=this.options.direction,g=c.offsetWidth,h=c.offsetHeight,i=v(this.options.offset),j=this._getAnchor();"top"===f?a=a.add(v(-g/2+i.x,-h+i.y+j.y,!0)):"bottom"===f?a=a.subtract(v(g/2-i.x,-i.y,!0)):"center"===f?a=a.subtract(v(g/2+i.x,h/2-j.y+i.y,!0)):"right"===f||"auto"===f&&e.x<d.x?(f="right",a=a.add(v(i.x+j.x,j.y-h/2+i.y,!0))):(f="left",a=a.subtract(v(g+j.x-i.x,h/2-j.y-i.y,!0))),pa(c,"leaflet-tooltip-right"),pa(c,"leaflet-tooltip-left"),pa(c,"leaflet-tooltip-top"),pa(c,"leaflet-tooltip-bottom"),oa(c,"leaflet-tooltip-"+f),wa(c,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&sa(this._container,a)},_animateZoom:function(a){var b=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(b)},_getAnchor:function(){return v(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});tc.include({openTooltip:function(a,b,c){return a instanceof gd||(a=new gd(c).setContent(a)),b&&a.setLatLng(b),this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){return a&&this.removeLayer(a),this}}),Pc.include({bindTooltip:function(a,b){return a instanceof gd?(k(a,b),this._tooltip=a,a._source=this):(this._tooltip&&!b||(this._tooltip=new gd(b,this)),this._tooltip.setContent(a)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(a||!this._tooltipHandlersAdded){var b=a?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),Qb&&(c.click=this._openTooltip)),this[b](c),this._tooltipHandlersAdded=!a}},openTooltip:function(a,b){if(a instanceof Pc||(b=a,a=this),a instanceof Rc)for(var c in this._layers){a=this._layers[c];break}
return b||(b=a.getCenter?a.getCenter():a.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,b),this._tooltip.options.interactive&&this._tooltip._container&&(oa(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(pa(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(a){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var b=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(b,this._tooltip.options.sticky?a.latlng:void 0)},_moveTooltip:function(a){var b,c,d=a.latlng;this._tooltip.options.sticky&&a.originalEvent&&(b=this._map.mouseEventToContainerPoint(a.originalEvent),c=this._map.containerPointToLayerPoint(b),d=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(d)}});var hd=Sc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var b=a&&"DIV"===a.tagName?a:document.createElement("div"),c=this.options;if(b.innerHTML=!1!==c.html?c.html:"",c.bgPos){var d=v(c.bgPos);b.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(b,"icon"),b},createShadow:function(){return null}});Sc.Default=Tc;var id=Pc.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lb,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){k(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),ja(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(la(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ma(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=e(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof u?a:new u(a,a)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var b,c=this.getPane().children,d=-a(-1/0,1/0),e=0,f=c.length;e<f;e++)b=c[e].style.zIndex,c[e]!==this._container&&b&&(d=a(d,+b));isFinite(d)&&(this.options.zIndex=d+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!vb){sa(this._container,this.options.opacity);var a=+new Date,b=!1,c=!1;for(var d in this._tiles){var e=this._tiles[d];if(e.current&&e.loaded){var f=Math.min(1,(a-e.loaded)/200);sa(e.el,f),f<1?b=!0:(e.active?c=!0:this._onOpaqueTile(e),e.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),b&&(r(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=ia("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,b=this.options.maxZoom;if(void 0!==a){for(var c in this._levels)this._levels[c].el.children.length||c===a?(this._levels[c].el.style.zIndex=b-Math.abs(a-c),this._onUpdateLevel(c)):(ja(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var d=this._levels[a],e=this._map;return d||((d=this._levels[a]={}).el=ia("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=b,d.origin=e.project(e.unproject(e.getPixelOrigin()),a).round(),d.zoom=a,this._setZoomTransform(d,e.getCenter(),e.getZoom()),d.el.offsetWidth,this._onCreateLevel(d)),this._level=d,d}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var a,b,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)(b=this._tiles[a]).retain=b.current;for(a in this._tiles)if((b=this._tiles[a]).current&&!b.active){var d=b.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var b in this._tiles)this._tiles[b].coords.z===a&&this._removeTile(b)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)ja(this._levels[a].el),this._onRemoveLevel(a),delete this._levels[a];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(a,b,c,d){var e=Math.floor(a/2),f=Math.floor(b/2),g=c-1,h=new u(+e,+f);h.z=+g;var i=this._tileCoordsToKey(h),j=this._tiles[i];return j&&j.active?(j.retain=!0,!0):(j&&j.loaded&&(j.retain=!0),g>d&&this._retainParent(e,f,g,d))},_retainChildren:function(a,b,c,d){for(var e=2*a;e<2*a+2;e++)for(var f=2*b;f<2*b+2;f++){var g=new u(e,f);g.z=c+1;var h=this._tileCoordsToKey(g),i=this._tiles[h];i&&i.active?i.retain=!0:(i&&i.loaded&&(i.retain=!0),c+1<d&&this._retainChildren(e,f,c+1,d))}},_resetView:function(a){var b=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),b,b)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var b=this.options;return void 0!==b.minNativeZoom&&a<b.minNativeZoom?b.minNativeZoom:void 0!==b.maxNativeZoom&&b.maxNativeZoom<a?b.maxNativeZoom:a},_setView:function(a,b,c,d){var e=this._clampZoom(Math.round(b));(void 0!==this.options.maxZoom&&e>this.options.maxZoom||void 0!==this.options.minZoom&&e<this.options.minZoom)&&(e=void 0);var f=this.options.updateWhenZooming&&e!==this._tileZoom;d&&!f||(this._tileZoom=e,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==e&&this._update(a),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(a,b)},_setZoomTransforms:function(a,b){for(var c in this._levels)this._setZoomTransform(this._levels[c],a,b)},_setZoomTransform:function(a,b,c){var d=this._map.getZoomScale(c,a.zoom),e=a.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(b,c)).round();Kb?va(a.el,e,d):wa(a.el,e)},_resetGrid:function(){var a=this._map,b=a.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e)),this._wrapX=b.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,b.wrapLng[0]],d).x/c.x),Math.ceil(a.project([0,b.wrapLng[1]],d).x/c.y)],this._wrapY=b.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([b.wrapLat[0],0],d).y/c.x),Math.ceil(a.project([b.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var b=this._map,c=b._animatingZoom?Math.max(b._animateToZoom,b.getZoom()):b.getZoom(),d=b.getZoomScale(c,this._tileZoom),e=b.project(a,this._tileZoom).floor(),f=b.getSize().divideBy(2*d);return new w(e.subtract(f),e.add(f))},_update:function(a){var b=this._map;if(b){var c=this._clampZoom(b.getZoom());if(void 0===a&&(a=b.getCenter()),void 0!==this._tileZoom){var d=this._getTiledPixelBounds(a),e=this._pxBoundsToTileRange(d),f=e.getCenter(),g=[],h=this.options.keepBuffer,i=new w(e.getBottomLeft().subtract([h,-h]),e.getTopRight().add([h,-h]));if(!(isFinite(e.min.x)&&isFinite(e.min.y)&&isFinite(e.max.x)&&isFinite(e.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var j in this._tiles){var k=this._tiles[j].coords;k.z===this._tileZoom&&i.contains(new u(k.x,k.y))||(this._tiles[j].current=!1)}if(Math.abs(c-this._tileZoom)>1)this._setView(a,c);else{for(var l=e.min.y;l<=e.max.y;l++)for(var m=e.min.x;m<=e.max.x;m++){var n=new u(m,l);n.z=this._tileZoom,this._isValidTile(n)&&(this._tiles[this._tileCoordsToKey(n)]||g.push(n))}if(g.sort(function(a,b){return a.distanceTo(f)-b.distanceTo(f)}),0!==g.length){this._loading||(this._loading=!0,this.fire("loading"));var o=document.createDocumentFragment();for(m=0;m<g.length;m++)this._addTile(g[m],o);this._level.el.appendChild(o)}}}}},_isValidTile:function(a){var b=this._map.options.crs;if(!b.infinite){var c=this._globalTileRange;if(!b.wrapLng&&(a.x<c.min.x||a.x>c.max.x)||!b.wrapLat&&(a.y<c.min.y||a.y>c.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(a);return z(this.options.bounds).overlaps(d)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToBounds:function(a){var b=this._map,c=this.getTileSize(),d=a.scaleBy(c),e=d.add(c),f=new y(b.unproject(d,a.z),b.unproject(e,a.z));return this.options.noWrap||b.wrapLatLngBounds(f),f},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var b=a.split(":"),c=new u(+b[0],+b[1]);return c.z=+b[2],c},_removeTile:function(a){var b=this._tiles[a];b&&(ja(b.el),delete this._tiles[a],this.fire("tileunload",{tile:b.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){oa(a,"leaflet-tile");var b=this.getTileSize();a.style.width=b.x+"px",a.style.height=b.y+"px",a.onselectstart=g,a.onmousemove=g,vb&&this.options.opacity<1&&sa(a,this.options.opacity),yb&&!zb&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,b){var d=this._getTilePos(a),e=this._tileCoordsToKey(a),f=this.createTile(this._wrapCoords(a),c(this._tileReady,this,a));this._initTile(f),this.createTile.length<2&&q(c(this._tileReady,this,a,null,f)),wa(f,d),this._tiles[e]={el:f,coords:a,current:!0},b.appendChild(f),this.fire("tileloadstart",{tile:f,coords:a})},_tileReady:function(a,b,d){if(this._map){b&&this.fire("tileerror",{error:b,tile:d,coords:a});var e=this._tileCoordsToKey(a);(d=this._tiles[e])&&(d.loaded=+new Date,this._map._fadeAnimated?(sa(d.el,0),r(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),b||(oa(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),vb||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))}},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var b=new u(this._wrapX?f(a.x,this._wrapX):a.x,this._wrapY?f(a.y,this._wrapY):a.y);return b.z=a.z,b},_pxBoundsToTileRange:function(a){var b=this.getTileSize();return new w(a.min.unscaleBy(b).floor(),a.max.unscaleBy(b).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),jd=id.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(a,b){this._url=a,(b=k(this,b)).detectRetina&&Tb&&b.maxZoom>0&&(b.tileSize=Math.floor(b.tileSize/2),b.zoomReverse?(b.zoomOffset--,b.minZoom++):(b.zoomOffset++,b.maxZoom--),b.minZoom=Math.max(0,b.minZoom)),"string"==typeof b.subdomains&&(b.subdomains=b.subdomains.split("")),yb||this.on("tileunload",this._onTileRemove)},setUrl:function(a,b){return this._url=a,b||this.redraw(),this},createTile:function(a,b){var d=document.createElement("img");return T(d,"load",c(this._tileOnLoad,this,b,d)),T(d,"error",c(this._tileOnError,this,b,d)),this.options.crossOrigin&&(d.crossOrigin=""),d.alt="",d.setAttribute("role","presentation"),d.src=this.getTileUrl(a),d},getTileUrl:function(a){var c={r:Tb?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-a.y;this.options.tms&&(c.y=d),c["-y"]=d}return m(this._url,b(c,this.options))},_tileOnLoad:function(a,b){vb?setTimeout(c(a,this,null,b),0):a(null,b)},_tileOnError:function(a,b,c){var d=this.options.errorTileUrl;d&&b.src!==d&&(b.src=d),a(c,b)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,b=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset;return c&&(a=b-a),a+d},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b]},_abortLoading:function(){var a,b;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&((b=this._tiles[a].el).onload=g,b.onerror=g,b.complete||(b.src=db,ja(b)))}}),kd=jd.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var d=b({},this.defaultWmsParams);for(var e in c)e in this.options||(d[e]=c[e]);c=k(this,c),d.width=d.height=c.tileSize*(c.detectRetina&&Tb?2:1),this.wmsParams=d},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var b=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[b]=this._crs.code,jd.prototype.onAdd.call(this,a)},getTileUrl:function(a){var b=this._tileCoordsToBounds(a),c=this._crs.project(b.getNorthWest()),d=this._crs.project(b.getSouthEast()),e=(this._wmsVersion>=1.3&&this._crs===Nc?[d.y,c.x,c.y,d.x]:[c.x,d.y,d.x,c.y]).join(","),f=jd.prototype.getTileUrl.call(this,a);return f+l(this.wmsParams,f,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+e},setParams:function(a,c){return b(this.wmsParams,a),c||this.redraw(),this}});jd.WMS=kd,Xa.wms=function(a,b){return new kd(a,b)};var ld=Pc.extend({options:{padding:.1},initialize:function(a){k(this,a),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&oa(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,b){var c=this._map.getZoomScale(b,this._zoom),d=xa(this._container),e=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,b),g=this._map.project(a,b).subtract(f),h=e.multiplyBy(-c).add(d).add(e).subtract(g);Kb?va(this._container,h,c):wa(this._container,h)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,b=this._map.getSize(),c=this._map.containerPointToLayerPoint(b.multiplyBy(-a)).round();this._bounds=new w(c,c.add(b.multiplyBy(1+2*a)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),md=ld.extend({getEvents:function(){var a=ld.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ld.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");T(a,"mousemove",e(this._onMouseMove,32,this),this),T(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),T(a,"mouseout",this._handleMouseOut,this),this._ctx=a.getContext("2d")},_destroyContainer:function(){delete this._ctx,ja(this._container),U(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var a in this._layers)this._layers[a]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},ld.prototype._update.call(this);var a=this._bounds,b=this._container,c=a.getSize(),d=Tb?2:1;wa(b,a.min),b.width=d*c.x,b.height=d*c.y,b.style.width=c.x+"px",b.style.height=c.y+"px",Tb&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){ld.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[d(a)]=a;var b=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=b),this._drawLast=b,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var b=a._order,c=b.next,d=b.prev;c?c.prev=d:this._drawLast=d,d?d.next=c:this._drawFirst=c,delete a._order,delete this._layers[L.stamp(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var b,c=a.options.dashArray.split(","),d=[];for(b=0;b<c.length;b++)d.push(Number(c[b]));a.options._dashArray=d}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var b=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new w,this._redrawBounds.extend(a._pxBounds.min.subtract([b,b])),this._redrawBounds.extend(a._pxBounds.max.add([b,b]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var b=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,b.x,b.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,b=this._redrawBounds;if(this._ctx.save(),b){var c=b.getSize();this._ctx.beginPath(),this._ctx.rect(b.min.x,b.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)a=d.layer,(!b||a._pxBounds&&a._pxBounds.intersects(b))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,b){if(this._drawing){var c,d,e,f,g=a._parts,h=g.length,i=this._ctx;if(h){for(this._drawnLayers[a._leaflet_id]=a,i.beginPath(),c=0;c<h;c++){for(d=0,e=g[c].length;d<e;d++)f=g[c][d],i[d?"lineTo":"moveTo"](f.x,f.y);b&&i.closePath()}this._fillStroke(i,a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var b=a._point,c=this._ctx,d=a._radius,e=(a._radiusY||d)/d;this._drawnLayers[a._leaflet_id]=a,1!==e&&(c.save(),c.scale(1,e)),c.beginPath(),c.arc(b.x,b.y/e,d,0,2*Math.PI,!1),1!==e&&c.restore(),this._fillStroke(c,a)}},_fillStroke:function(a,b){var c=b.options;c.fill&&(a.globalAlpha=c.fillOpacity,a.fillStyle=c.fillColor||c.color,a.fill(c.fillRule||"evenodd")),c.stroke&&0!==c.weight&&(a.setLineDash&&a.setLineDash(b.options&&b.options._dashArray||[]),a.globalAlpha=c.opacity,a.lineWidth=c.weight,a.strokeStyle=c.color,a.lineCap=c.lineCap,a.lineJoin=c.lineJoin,a.stroke())},_onClick:function(a){for(var b,c,d=this._map.mouseEventToLayerPoint(a),e=this._drawFirst;e;e=e.next)(b=e.layer).options.interactive&&b._containsPoint(d)&&!this._map._draggableMoved(b)&&(c=b);c&&(ca(a),this._fireEvent([c],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var b=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,b)}},_handleMouseOut:function(a){var b=this._hoveredLayer;b&&(pa(this._container,"leaflet-interactive"),this._fireEvent([b],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,b){for(var c,d,e=this._drawFirst;e;e=e.next)(c=e.layer).options.interactive&&c._containsPoint(b)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(a),d&&(oa(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseover"),this._hoveredLayer=d)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,b,c){this._map._fireDOMEvent(b,c||b.type,a)},_bringToFront:function(a){var b=a._order,c=b.next,d=b.prev;c&&(c.prev=d,d?d.next=c:c&&(this._drawFirst=c),b.prev=this._drawLast,this._drawLast.next=b,b.next=null,this._drawLast=b,this._requestRedraw(a))},_bringToBack:function(a){var b=a._order,c=b.next,d=b.prev;d&&(d.next=c,c?c.prev=d:d&&(this._drawLast=d),b.prev=null,b.next=this._drawFirst,this._drawFirst.prev=b,this._drawFirst=b,this._requestRedraw(a))}}),nd=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),od={_initContainer:function(){this._container=ia("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ld.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var b=a._container=nd("shape");oa(b,"leaflet-vml-shape "+(this.options.className||"")),b.coordsize="1 1",a._path=nd("path"),b.appendChild(a._path),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){var b=a._container;this._container.appendChild(b),a.options.interactive&&a.addInteractiveTarget(b)},_removePath:function(a){var b=a._container;ja(b),a.removeInteractiveTarget(b),delete this._layers[d(a)]},_updateStyle:function(a){var b=a._stroke,c=a._fill,d=a.options,e=a._container;e.stroked=!!d.stroke,e.filled=!!d.fill,d.stroke?(b||(b=a._stroke=nd("stroke")),e.appendChild(b),b.weight=d.weight+"px",b.color=d.color,b.opacity=d.opacity,d.dashArray?b.dashStyle=cb(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):b.dashStyle="",b.endcap=d.lineCap.replace("butt","flat"),b.joinstyle=d.lineJoin):b&&(e.removeChild(b),a._stroke=null),d.fill?(c||(c=a._fill=nd("fill")),e.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(e.removeChild(c),a._fill=null)},_updateCircle:function(a){var b=a._point.round(),c=Math.round(a._radius),d=Math.round(a._radiusY||c);this._setPath(a,a._empty()?"M0 0":"AL "+b.x+","+b.y+" "+c+","+d+" 0,23592600")},_setPath:function(a,b){a._path.v=b},_bringToFront:function(a){la(a._container)},_bringToBack:function(a){ma(a._container)}},pd=Wb?nd:E,qd=ld.extend({getEvents:function(){var a=ld.prototype.getEvents.call(this);return a.zoomstart=this._onZoomStart,a},_initContainer:function(){this._container=pd("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pd("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ja(this._container),U(this._container),delete this._container,delete this._rootGroup},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){ld.prototype._update.call(this);var a=this._bounds,b=a.getSize(),c=this._container;this._svgSize&&this._svgSize.equals(b)||(this._svgSize=b,c.setAttribute("width",b.x),c.setAttribute("height",b.y)),wa(c,a.min),c.setAttribute("viewBox",[a.min.x,a.min.y,b.x,b.y].join(" ")),this.fire("update")}},_initPath:function(a){var b=a._path=pd("path");a.options.className&&oa(b,a.options.className),a.options.interactive&&oa(b,"leaflet-interactive"),this._updateStyle(a),this._layers[d(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){ja(a._path),a.removeInteractiveTarget(a._path),delete this._layers[d(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var b=a._path,c=a.options;b&&(c.stroke?(b.setAttribute("stroke",c.color),b.setAttribute("stroke-opacity",c.opacity),b.setAttribute("stroke-width",c.weight),b.setAttribute("stroke-linecap",c.lineCap),b.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?b.setAttribute("stroke-dasharray",c.dashArray):b.removeAttribute("stroke-dasharray"),c.dashOffset?b.setAttribute("stroke-dashoffset",c.dashOffset):b.removeAttribute("stroke-dashoffset")):b.setAttribute("stroke","none"),c.fill?(b.setAttribute("fill",c.fillColor||c.color),b.setAttribute("fill-opacity",c.fillOpacity),b.setAttribute("fill-rule",c.fillRule||"evenodd")):b.setAttribute("fill","none"))},_updatePoly:function(a,b){this._setPath(a,F(a._parts,b))},_updateCircle:function(a){var b=a._point,c=a._radius,d="a"+c+","+(a._radiusY||c)+" 0 1,0 ",e=a._empty()?"M0 0":"M"+(b.x-c)+","+b.y+d+2*c+",0 "+d+2*-c+",0 ";this._setPath(a,e)},_setPath:function(a,b){a._path.setAttribute("d",b)},_bringToFront:function(a){la(a._path)},_bringToBack:function(a){ma(a._path)}});Wb&&qd.include(od),tc.include({getRenderer:function(a){var b=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return b||(b=this._renderer=this.options.preferCanvas&&Ya()||Za()),this.hasLayer(b)||this.addLayer(b),b},_getPaneRenderer:function(a){if("overlayPane"===a||void 0===a)return!1;var b=this._paneRenderers[a];return void 0===b&&(b=qd&&Za({pane:a})||md&&Ya({pane:a}),this._paneRenderers[a]=b),b}});var rd=$c.extend({initialize:function(a,b){$c.prototype.initialize.call(this,this._boundsToLatLngs(a),b)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=z(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});qd.create=pd,qd.pointsToPath=F,_c.geometryToLayer=Pa,_c.coordsToLatLng=Qa,_c.coordsToLatLngs=Ra,_c.latLngToCoords=Sa,_c.latLngsToCoords=Ta,_c.getFeature=Ua,_c.asFeature=Va,tc.mergeOptions({boxZoom:!0});var sd=Bc.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){T(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){U(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ja(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._clearDeferredResetState(),this._resetState(),ob(),ya(),this._startPoint=this._map.mouseEventToContainerPoint(a),T(document,{contextmenu:_,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=ia("div","leaflet-zoom-box",this._container),oa(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var b=new w(this._point,this._startPoint),c=b.getSize();wa(this._box,b.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(ja(this._box),pa(this._container,"leaflet-crosshair")),pb(),za(),U(document,{contextmenu:_,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if((1===a.which||1===a.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var b=new y(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(b).fire("boxzoomend",{boxZoomBounds:b})}},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});tc.addInitHook("addHandler","boxZoom",sd),tc.mergeOptions({doubleClickZoom:!0});var td=Bc.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom(),d=b.options.zoomDelta,e=a.originalEvent.shiftKey?c-d:c+d;"center"===b.options.doubleClickZoom?b.setZoom(e):b.setZoomAround(a.containerPoint,e)}});tc.addInitHook("addHandler","doubleClickZoom",td),tc.mergeOptions({dragging:!0,inertia:!zb,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ud=Bc.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Gc(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}oa(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pa(this._map._container,"leaflet-grab"),pa(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var b=z(this._map.options.maxBounds);this._offsetLimit=x(this._map.latLngToContainerPoint(b.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(b.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var b=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(b),b-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",a).fire("drag",a)},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),b=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=b.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,b){return a-(a-b)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),b=this._offsetLimit;a.x<b.min.x&&(a.x=this._viscousLimit(a.x,b.min.x)),a.y<b.min.y&&(a.y=this._viscousLimit(a.y,b.min.y)),a.x>b.max.x&&(a.x=this._viscousLimit(a.x,b.max.x)),a.y>b.max.y&&(a.y=this._viscousLimit(a.y,b.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,e=(d-b+c)%a+b-c,f=(d+b+c)%a-b-c,g=Math.abs(e+c)<Math.abs(f+c)?e:f;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=g},_onDragEnd:function(a){var b=this._map,c=b.options,d=!c.inertia||this._times.length<2;if(b.fire("dragend",a),d)b.fire("moveend");else{
var e=this._lastPos.subtract(this._positions[0]),f=(this._lastTime-this._times[0])/1e3,g=c.easeLinearity,h=e.multiplyBy(g/f),i=h.distanceTo([0,0]),j=Math.min(c.inertiaMaxSpeed,i),k=h.multiplyBy(j/i),l=j/(c.inertiaDeceleration*g),m=k.multiplyBy(-l/2).round();m.x||m.y?(m=b._limitOffset(m,b.options.maxBounds),q(function(){b.panBy(m,{duration:l,easeLinearity:g,noMoveStart:!0,animate:!0})})):b.fire("moveend")}}});tc.addInitHook("addHandler","dragging",ud),tc.mergeOptions({keyboard:!0,keyboardPanDelta:80});var vd=Bc.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),T(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),U(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,b=document.documentElement,c=a.scrollTop||b.scrollTop,d=a.scrollLeft||b.scrollLeft;this._map._container.focus(),window.scrollTo(d,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var b,c,d=this._panKeys={},e=this.keyCodes;for(b=0,c=e.left.length;b<c;b++)d[e.left[b]]=[-1*a,0];for(b=0,c=e.right.length;b<c;b++)d[e.right[b]]=[a,0];for(b=0,c=e.down.length;b<c;b++)d[e.down[b]]=[0,a];for(b=0,c=e.up.length;b<c;b++)d[e.up[b]]=[0,-1*a]},_setZoomDelta:function(a){var b,c,d=this._zoomKeys={},e=this.keyCodes;for(b=0,c=e.zoomIn.length;b<c;b++)d[e.zoomIn[b]]=a;for(b=0,c=e.zoomOut.length;b<c;b++)d[e.zoomOut[b]]=-a},_addHooks:function(){T(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){U(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b,c=a.keyCode,d=this._map;if(c in this._panKeys){if(d._panAnim&&d._panAnim._inProgress)return;b=this._panKeys[c],a.shiftKey&&(b=v(b).multiplyBy(3)),d.panBy(b),d.options.maxBounds&&d.panInsideBounds(d.options.maxBounds)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else{if(27!==c||!d._popup)return;d.closePopup()}_(a)}}});tc.addInitHook("addHandler","keyboard",vd),tc.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var wd=Bc.extend({addHooks:function(){T(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){U(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var b=ba(a),d=this._map.options.wheelDebounceTime;this._delta+=b,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var e=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),e),_(a)},_performZoom:function(){var a=this._map,b=a.getZoom(),c=this._map.options.zoomSnap||0;a._stop();var d=this._delta/(4*this._map.options.wheelPxPerZoomLevel),e=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,f=c?Math.ceil(e/c)*c:e,g=a._limitZoom(b+(this._delta>0?f:-f))-b;this._delta=0,this._startTime=null,g&&("center"===a.options.scrollWheelZoom?a.setZoom(b+g):a.setZoomAround(this._lastMousePos,b+g))}});tc.addInitHook("addHandler","scrollWheelZoom",wd),tc.mergeOptions({tap:!0,tapTolerance:15});var xd=Bc.extend({addHooks:function(){T(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){U(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches){if($(a),this._fireClick=!0,a.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var b=a.touches[0],d=b.target;this._startPos=this._newPos=new u(b.clientX,b.clientY),d.tagName&&"a"===d.tagName.toLowerCase()&&oa(d,"leaflet-active"),this._holdTimeout=setTimeout(c(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",b))},this),1e3),this._simulateEvent("mousedown",b),T(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){if(clearTimeout(this._holdTimeout),U(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&a&&a.changedTouches){var b=a.changedTouches[0],c=b.target;c&&c.tagName&&"a"===c.tagName.toLowerCase()&&pa(c,"leaflet-active"),this._simulateEvent("mouseup",b),this._isTapValid()&&this._simulateEvent("click",b)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){var b=a.touches[0];this._newPos=new u(b.clientX,b.clientY),this._simulateEvent("mousemove",b)},_simulateEvent:function(a,b){var c=document.createEvent("MouseEvents");c._simulated=!0,b.target._simulatedClick=!0,c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)}});Qb&&!Pb&&tc.addInitHook("addHandler","tap",xd),tc.mergeOptions({touchZoom:Qb&&!zb,bounceAtZoomLimits:!0});var yd=Bc.extend({addHooks:function(){oa(this._map._container,"leaflet-touch-zoom"),T(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pa(this._map._container,"leaflet-touch-zoom"),U(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var b=this._map;if(a.touches&&2===a.touches.length&&!b._animatingZoom&&!this._zooming){var c=b.mouseEventToContainerPoint(a.touches[0]),d=b.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=b.getSize()._divideBy(2),this._startLatLng=b.containerPointToLatLng(this._centerPoint),"center"!==b.options.touchZoom&&(this._pinchStartLatLng=b.containerPointToLatLng(c.add(d)._divideBy(2))),this._startDist=c.distanceTo(d),this._startZoom=b.getZoom(),this._moved=!1,this._zooming=!0,b._stop(),T(document,"touchmove",this._onTouchMove,this),T(document,"touchend",this._onTouchEnd,this),$(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var b=this._map,d=b.mouseEventToContainerPoint(a.touches[0]),e=b.mouseEventToContainerPoint(a.touches[1]),f=d.distanceTo(e)/this._startDist;if(this._zoom=b.getScaleZoom(f,this._startZoom),!b.options.bounceAtZoomLimits&&(this._zoom<b.getMinZoom()&&f<1||this._zoom>b.getMaxZoom()&&f>1)&&(this._zoom=b._limitZoom(this._zoom)),"center"===b.options.touchZoom){if(this._center=this._startLatLng,1===f)return}else{var g=d._add(e)._divideBy(2)._subtract(this._centerPoint);if(1===f&&0===g.x&&0===g.y)return;this._center=b.unproject(b.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(b._moveStart(!0),this._moved=!0),r(this._animRequest);var h=c(b._move,b,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=q(h,this,!0),$(a)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,r(this._animRequest),U(document,"touchmove",this._onTouchMove),U(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});tc.addInitHook("addHandler","touchZoom",yd),tc.BoxZoom=sd,tc.DoubleClickZoom=td,tc.Drag=ud,tc.Keyboard=vd,tc.ScrollWheelZoom=wd,tc.Tap=xd,tc.TouchZoom=yd;var zd=window.L;window.L=a,Object.freeze=$a,a.version="1.2.0",a.noConflict=function(){return window.L=zd,this},a.Control=uc,a.control=vc,a.Browser=Xb,a.Evented=jb,a.Mixin=Cc,a.Util=hb,a.Class=s,a.Handler=Bc,a.extend=b,a.bind=c,a.stamp=d,a.setOptions=k,a.DomEvent=kc,a.DomUtil=rc,a.PosAnimation=sc,a.Draggable=Gc,a.LineUtil=Hc,a.PolyUtil=Ic,a.Point=u,a.point=v,a.Bounds=w,a.bounds=x,a.Transformation=C,a.transformation=D,a.Projection=Lc,a.LatLng=A,a.latLng=B,a.LatLngBounds=y,a.latLngBounds=z,a.CRS=kb,a.GeoJSON=_c,a.geoJSON=Wa,a.geoJson=bd,a.Layer=Pc,a.LayerGroup=Qc,a.layerGroup=function(a){return new Qc(a)},a.FeatureGroup=Rc,a.featureGroup=function(a){return new Rc(a)},a.ImageOverlay=cd,a.imageOverlay=function(a,b,c){return new cd(a,b,c)},a.VideoOverlay=dd,a.videoOverlay=function(a,b,c){return new dd(a,b,c)},a.DivOverlay=ed,a.Popup=fd,a.popup=function(a,b){return new fd(a,b)},a.Tooltip=gd,a.tooltip=function(a,b){return new gd(a,b)},a.Icon=Sc,a.icon=function(a){return new Sc(a)},a.DivIcon=hd,a.divIcon=function(a){return new hd(a)},a.Marker=Vc,a.marker=function(a,b){return new Vc(a,b)},a.TileLayer=jd,a.tileLayer=Xa,a.GridLayer=id,a.gridLayer=function(a){return new id(a)},a.SVG=qd,a.svg=Za,a.Renderer=ld,a.Canvas=md,a.canvas=Ya,a.Path=Wc,a.CircleMarker=Xc,a.circleMarker=function(a,b){return new Xc(a,b)},a.Circle=Yc,a.circle=function(a,b,c){return new Yc(a,b,c)},a.Polyline=Zc,a.polyline=function(a,b){return new Zc(a,b)},a.Polygon=$c,a.polygon=function(a,b){return new $c(a,b)},a.Rectangle=rd,a.rectangle=function(a,b){return new rd(a,b)},a.Map=tc,a.map=function(a,b){return new tc(a,b)}}),function(a,b){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(a,b){b=b||ca;var c=b.createElement("script");c.text=a,b.head.appendChild(c).parentNode.removeChild(c)}function d(a){var b=!!a&&"length"in a&&a.length,c=pa.type(a);return"function"!==c&&!pa.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}function e(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()}function f(a,b,c){return pa.isFunction(b)?pa.grep(a,function(a,d){return!!b.call(a,d,a)!==c}):b.nodeType?pa.grep(a,function(a){return a===b!==c}):"string"!=typeof b?pa.grep(a,function(a){return ha.call(b,a)>-1!==c}):za.test(b)?pa.filter(b,a,c):(b=pa.filter(b,a),pa.grep(a,function(a){return ha.call(b,a)>-1!==c&&1===a.nodeType}))}function g(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function h(a){var b={};return pa.each(a.match(Ea)||[],function(a,c){b[c]=!0}),b}function i(a){return a}function j(a){throw a}function k(a,b,c,d){var e;try{a&&pa.isFunction(e=a.promise)?e.call(a).done(b).fail(c):a&&pa.isFunction(e=a.then)?e.call(a,b,c):b.apply(void 0,[a].slice(d))}catch(a){c.apply(void 0,[a])}}function l(){ca.removeEventListener("DOMContentLoaded",l),a.removeEventListener("load",l),pa.ready()}function m(){this.expando=pa.expando+m.uid++}function n(a){return"true"===a||"false"!==a&&("null"===a?null:a===+a+""?+a:La.test(a)?JSON.parse(a):a)}function o(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Ma,"-$&").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c=n(c)}catch(e){}Ka.set(a,b,c)}else c=void 0;return c}function p(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return pa.css(a,b,"")},i=h(),j=c&&c[3]||(pa.cssNumber[b]?"":"px"),k=(pa.cssNumber[b]||"px"!==j&&+i)&&Oa.exec(pa.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do{f=f||".5",k/=f,pa.style(a,b,k+j)}while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}function q(a){var b,c=a.ownerDocument,d=a.nodeName,e=Sa[d];return e||(b=c.body.appendChild(c.createElement(d)),e=pa.css(b,"display"),b.parentNode.removeChild(b),"none"===e&&(e="block"),Sa[d]=e,e)}function r(a,b){for(var c,d,e=[],f=0,g=a.length;f<g;f++)d=a[f],d.style&&(c=d.style.display,b?("none"===c&&(e[f]=Ja.get(d,"display")||null,e[f]||(d.style.display="")),""===d.style.display&&Qa(d)&&(e[f]=q(d))):"none"!==c&&(e[f]="none",Ja.set(d,"display",c)));for(f=0;f<g;f++)null!=e[f]&&(a[f].style.display=e[f]);return a}function s(a,b){var c;return c=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):[],void 0===b||b&&e(a,b)?pa.merge([a],c):c}function t(a,b){for(var c=0,d=a.length;c<d;c++)Ja.set(a[c],"globalEval",!b||Ja.get(b[c],"globalEval"))}function u(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],n=0,o=a.length;n<o;n++)if((f=a[n])||0===f)if("object"===pa.type(f))pa.merge(m,f.nodeType?[f]:f);else if(Xa.test(f)){for(g=g||l.appendChild(b.createElement("div")),h=(Ua.exec(f)||["",""])[1].toLowerCase(),i=Wa[h]||Wa._default,g.innerHTML=i[1]+pa.htmlPrefilter(f)+i[2],k=i[0];k--;)g=g.lastChild;pa.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));for(l.textContent="",n=0;f=m[n++];)if(d&&pa.inArray(f,d)>-1)e&&e.push(f);else if(j=pa.contains(f.ownerDocument,f),g=s(l.appendChild(f),"script"),j&&t(g),c)for(k=0;f=g[k++];)Va.test(f.type||"")&&c.push(f);return l}function v(){return!0}function w(){return!1}function x(){try{return ca.activeElement}catch(a){}}function y(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)y(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=w;else if(!e)return a;return 1===f&&(g=e,e=function(a){return pa().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=pa.guid++)),a.each(function(){pa.event.add(this,b,e,d,c)})}function z(a,b){return e(a,"table")&&e(11!==b.nodeType?b:b.firstChild,"tr")?pa(">tbody",a)[0]||a:a}function A(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function B(a){var b=db.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function C(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(Ja.hasData(a)&&(f=Ja.access(a),g=Ja.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)pa.event.add(b,e,j[e][c])}Ka.hasData(a)&&(h=Ka.access(a),i=pa.extend({},h),Ka.set(b,i))}}function D(a,b){var c=b.nodeName.toLowerCase();"input"===c&&Ta.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function E(a,b,d,e){b=fa.apply([],b);var f,g,h,i,j,k,l=0,m=a.length,n=m-1,o=b[0],p=pa.isFunction(o);if(p||m>1&&"string"==typeof o&&!na.checkClone&&cb.test(o))return a.each(function(c){var f=a.eq(c);p&&(b[0]=o.call(this,c,f.html())),E(f,b,d,e)});if(m&&(f=u(b,a[0].ownerDocument,!1,a,e),g=f.firstChild,1===f.childNodes.length&&(f=g),g||e)){for(h=pa.map(s(f,"script"),A),i=h.length;l<m;l++)j=f,l!==n&&(j=pa.clone(j,!0,!0),i&&pa.merge(h,s(j,"script"))),d.call(a[l],j,l);if(i)for(k=h[h.length-1].ownerDocument,pa.map(h,B),l=0;l<i;l++)j=h[l],Va.test(j.type||"")&&!Ja.access(j,"globalEval")&&pa.contains(k,j)&&(j.src?pa._evalUrl&&pa._evalUrl(j.src):c(j.textContent.replace(eb,""),k))}return a}function F(a,b,c){for(var d,e=b?pa.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||pa.cleanData(s(d)),d.parentNode&&(c&&pa.contains(d.ownerDocument,d)&&t(s(d,"script")),d.parentNode.removeChild(d));return a}function G(a,b,c){var d,e,f,g,h=a.style;return c=c||hb(a),c&&(g=c.getPropertyValue(b)||c[b],""!==g||pa.contains(a.ownerDocument,a)||(g=pa.style(a,b)),!na.pixelMarginRight()&&gb.test(g)&&fb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function H(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function I(a){if(a in nb)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=mb.length;c--;)if((a=mb[c]+b)in nb)return a}function J(a){var b=pa.cssProps[a];return b||(b=pa.cssProps[a]=I(a)||a),b}function K(a,b,c){var d=Oa.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function L(a,b,c,d,e){var f,g=0;for(f=c===(d?"border":"content")?4:"width"===b?1:0;f<4;f+=2)"margin"===c&&(g+=pa.css(a,c+Pa[f],!0,e)),d?("content"===c&&(g-=pa.css(a,"padding"+Pa[f],!0,e)),"margin"!==c&&(g-=pa.css(a,"border"+Pa[f]+"Width",!0,e))):(g+=pa.css(a,"padding"+Pa[f],!0,e),"padding"!==c&&(g+=pa.css(a,"border"+Pa[f]+"Width",!0,e)));return g}function M(a,b,c){var d,e=hb(a),f=G(a,b,e),g="border-box"===pa.css(a,"boxSizing",!1,e);return gb.test(f)?f:(d=g&&(na.boxSizingReliable()||f===a.style[b]),"auto"===f&&(f=a["offset"+b[0].toUpperCase()+b.slice(1)]),(f=parseFloat(f)||0)+L(a,b,c||(g?"border":"content"),d,e)+"px")}function N(a,b,c,d,e){return new N.prototype.init(a,b,c,d,e)}function O(){pb&&(!1===ca.hidden&&a.requestAnimationFrame?a.requestAnimationFrame(O):a.setTimeout(O,pa.fx.interval),pa.fx.tick())}function P(){return a.setTimeout(function(){ob=void 0}),ob=pa.now()}function Q(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=Pa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function R(a,b,c){for(var d,e=(U.tweeners[b]||[]).concat(U.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function S(a,b,c){var d,e,f,g,h,i,j,k,l="width"in b||"height"in b,m=this,n={},o=a.style,p=a.nodeType&&Qa(a),q=Ja.get(a,"fxshow");c.queue||(g=pa._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,h=g.empty.fire,g.empty.fire=function(){g.unqueued||h()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--,pa.queue(a,"fx").length||g.empty.fire()})}));for(d in b)if(e=b[d],qb.test(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}n[d]=q&&q[d]||pa.style(a,d)}if((i=!pa.isEmptyObject(b))||!pa.isEmptyObject(n)){l&&1===a.nodeType&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=q&&q.display,null==j&&(j=Ja.get(a,"display")),k=pa.css(a,"display"),"none"===k&&(j?k=j:(r([a],!0),j=a.style.display||j,k=pa.css(a,"display"),r([a]))),("inline"===k||"inline-block"===k&&null!=j)&&"none"===pa.css(a,"float")&&(i||(m.done(function(){o.display=j}),null==j&&(k=o.display,j="none"===k?"":k)),o.display="inline-block")),c.overflow&&(o.overflow="hidden",m.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]})),i=!1;for(d in n)i||(q?"hidden"in q&&(p=q.hidden):q=Ja.access(a,"fxshow",{display:j}),f&&(q.hidden=!p),p&&r([a],!0),m.done(function(){p||r([a]),Ja.remove(a,"fxshow");for(d in n)pa.style(a,d,n[d])})),i=R(p?q[d]:0,d,m),d in q||(q[d]=i.start,p&&(i.end=i.start,i.start=0))}}function T(a,b){var c,d,e,f,g;for(c in a)if(d=pa.camelCase(c),e=b[d],f=a[c],Array.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=pa.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function U(a,b,c){var d,e,f=0,g=U.prefilters.length,h=pa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=ob||P(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(i||h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:pa.extend({},b),opts:pa.extend(!0,{specialEasing:{},easing:pa.easing._default},c),originalProperties:b,originalOptions:c,startTime:ob||P(),duration:c.duration,tweens:[],createTween:function(b,c){var d=pa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(T(k,j.opts.specialEasing);f<g;f++)if(d=U.prefilters[f].call(j,a,k,j.opts))return pa.isFunction(d.stop)&&(pa._queueHooks(j.elem,j.opts.queue).stop=pa.proxy(d.stop,d)),d;return pa.map(k,R,j),pa.isFunction(j.opts.start)&&j.opts.start.call(a,j),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always),pa.fx.timer(pa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j}function V(a){return(a.match(Ea)||[]).join(" ")}function W(a){return a.getAttribute&&a.getAttribute("class")||""}function X(a,b,c,d){var e;if(Array.isArray(b))pa.each(b,function(b,e){c||Bb.test(a)?d(a,e):X(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==pa.type(b))d(a,b);else for(e in b)X(a+"["+e+"]",b[e],c,d)}function Y(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(Ea)||[];if(pa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Z(a,b,c,d){function e(h){var i;return f[h]=!0,pa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===Nb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function $(a,b){var c,d,e=pa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&pa.extend(!0,a,d),a}function _(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function aa(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}var ba=[],ca=a.document,da=Object.getPrototypeOf,ea=ba.slice,fa=ba.concat,ga=ba.push,ha=ba.indexOf,ia={},ja=ia.toString,ka=ia.hasOwnProperty,la=ka.toString,ma=la.call(Object),na={},oa="3.2.1",pa=function(a,b){return new pa.fn.init(a,b)},qa=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ra=/^-ms-/,sa=/-([a-z])/g,ta=function(a,b){return b.toUpperCase()};pa.fn=pa.prototype={jquery:oa,constructor:pa,length:0,toArray:function(){return ea.call(this)},get:function(a){return null==a?ea.call(this):a<0?this[a+this.length]:this[a]},pushStack:function(a){var b=pa.merge(this.constructor(),a);return b.prevObject=this,b},each:function(a){return pa.each(this,a)},map:function(a){return this.pushStack(pa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(ea.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:ga,sort:ba.sort,splice:ba.splice},pa.extend=pa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||pa.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(pa.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&pa.isPlainObject(c)?c:{},g[b]=pa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},pa.extend({expando:"jQuery"+(oa+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===pa.type(a)},isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=pa.type(a);return("number"===b||"string"===b)&&!isNaN(a-parseFloat(a))},isPlainObject:function(a){var b,c;return!(!a||"[object Object]"!==ja.call(a))&&(!(b=da(a))||"function"==typeof(c=ka.call(b,"constructor")&&b.constructor)&&la.call(c)===ma)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?ia[ja.call(a)]||"object":typeof a},globalEval:function(a){c(a)},camelCase:function(a){return a.replace(ra,"ms-").replace(sa,ta)},each:function(a,b){var c,e=0;if(d(a))for(c=a.length;e<c&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:function(a){return null==a?"":(a+"").replace(qa,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?pa.merge(c,"string"==typeof a?[a]:a):ga.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:ha.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)!b(a[e],e)!==g&&d.push(a[e]);return d},map:function(a,b,c){var e,f,g=0,h=[];if(d(a))for(e=a.length;g<e;g++)null!=(f=b(a[g],g,c))&&h.push(f);else for(g in a)null!=(f=b(a[g],g,c))&&h.push(f);return fa.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;if("string"==typeof b&&(c=a[b],b=a,a=c),pa.isFunction(a))return d=ea.call(arguments,2),e=function(){return a.apply(b||this,d.concat(ea.call(arguments)))},e.guid=a.guid=a.guid||pa.guid++,e},now:Date.now,support:na}),"function"==typeof Symbol&&(pa.fn[Symbol.iterator]=ba[Symbol.iterator]),pa.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){ia["[object "+b+"]"]=b.toLowerCase()});var ua=function(a){function b(a,b,c,d){var e,f,g,h,i,j,k,m=b&&b.ownerDocument,o=b?b.nodeType:9;if(c=c||[],"string"!=typeof a||!a||1!==o&&9!==o&&11!==o)return c;if(!d&&((b?b.ownerDocument||b:P)!==H&&G(b),b=b||H,J)){if(11!==o&&(i=ra.exec(a)))if(e=i[1]){if(9===o){if(!(g=b.getElementById(e)))return c;if(g.id===e)return c.push(g),c}else if(m&&(g=m.getElementById(e))&&N(b,g)&&g.id===e)return c.push(g),c}else{if(i[2])return $.apply(c,b.getElementsByTagName(a)),c;if((e=i[3])&&w.getElementsByClassName&&b.getElementsByClassName)return $.apply(c,b.getElementsByClassName(e)),c}if(w.qsa&&!U[a+" "]&&(!K||!K.test(a))){if(1!==o)m=b,k=a;else if("object"!==b.nodeName.toLowerCase()){for((h=b.getAttribute("id"))?h=h.replace(va,wa):b.setAttribute("id",h=O),j=A(a),f=j.length;f--;)j[f]="#"+h+" "+n(j[f]);k=j.join(","),m=sa.test(a)&&l(b.parentNode)||b}if(k)try{return $.apply(c,m.querySelectorAll(k)),c}catch(p){}finally{h===O&&b.removeAttribute("id")}}}return C(a.replace(ha,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>x.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[O]=!0,a}function e(a){var b=H.createElement("fieldset");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=c.length;d--;)x.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return function(b){return"form"in b?b.parentNode&&!1===b.disabled?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&ya(b)===a:b.disabled===a:"label"in b&&b.disabled===a}}function k(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function l(a){return a&&void 0!==a.getElementsByTagName&&a}function m(){}function n(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=b.next,f=e||d,g=c&&"parentNode"===f,h=R++;return b.first?function(b,c,e){for(;b=b[d];)if(1===b.nodeType||g)return a(b,c,e);return!1}:function(b,c,i){var j,k,l,m=[Q,h];if(i){for(;b=b[d];)if((1===b.nodeType||g)&&a(b,c,i))return!0}else for(;b=b[d];)if(1===b.nodeType||g)if(l=b[O]||(b[O]={}),k=l[b.uniqueID]||(l[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((j=k[f])&&j[0]===Q&&j[1]===h)return m[2]=j[2];if(k[f]=m,m[2]=a(b,c,i))return!0}return!1}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,c,d){for(var e=0,f=c.length;e<f;e++)b(a,c[e],d);return d}function r(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function s(a,b,c,e,f,g){return e&&!e[O]&&(e=s(e)),f&&!f[O]&&(f=s(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=d||q(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?p:r(p,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=r(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?aa(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=r(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function t(a){for(var b,c,d,e=a.length,f=x.relative[a[0].type],g=f||x.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return aa(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==D)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];h<e;h++)if(c=x.relative[a[h].type])k=[o(p(k),c)];else{if(c=x.filter[a[h].type].apply(null,a[h].matches),c[O]){for(d=++h;d<e&&!x.relative[a[d].type];d++);return s(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ha,"$1"),c,h<d&&t(a.slice(h,d)),d<e&&t(a=a.slice(d)),d<e&&n(a))}k.push(c)}return p(k)}function u(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],q=[],s=D,t=d||f&&x.find.TAG("*",j),u=Q+=null==s?1:Math.random()||.1,v=t.length;for(j&&(D=g===H||g||j);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0,g||k.ownerDocument===H||(G(k),h=!J);m=a[l++];)if(m(k,g||H,h)){i.push(k);break}j&&(Q=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,q,g,h);if(d){if(n>0)for(;o--;)p[o]||q[o]||(q[o]=Y.call(i));q=r(q)}$.apply(i,q),j&&!d&&q.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(Q=u,D=s),p};return e?d(g):g}var v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O="sizzle"+1*new Date,P=a.document,Q=0,R=0,S=c(),T=c(),U=c(),V=function(a,b){return a===b&&(F=!0),0},W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,aa=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ba="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ca="[\\x20\\t\\r\\n\\f]",da="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ea="\\["+ca+"*("+da+")(?:"+ca+"*([*^$|!~]?=)"+ca+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+da+"))|)"+ca+"*\\]",fa=":("+da+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ea+")*)|.*)\\)|)",ga=new RegExp(ca+"+","g"),ha=new RegExp("^"+ca+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ca+"+$","g"),ia=new RegExp("^"+ca+"*,"+ca+"*"),ja=new RegExp("^"+ca+"*([>+~]|"+ca+")"+ca+"*"),ka=new RegExp("="+ca+"*([^\\]'\"]*?)"+ca+"*\\]","g"),la=new RegExp(fa),ma=new RegExp("^"+da+"$"),na={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da+"|[*])"),ATTR:new RegExp("^"+ea),PSEUDO:new RegExp("^"+fa),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ca+"*(even|odd|(([+-]|)(\\d*)n|)"+ca+"*(?:([+-]|)"+ca+"*(\\d+)|))"+ca+"*\\)|)","i"),bool:new RegExp("^(?:"+ba+")$","i"),needsContext:new RegExp("^"+ca+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ca+"*((?:-\\d)?\\d*)"+ca+"*\\)|)(?=[^-]|$)","i")},oa=/^(?:input|select|textarea|button)$/i,pa=/^h\d$/i,qa=/^[^{]+\{\s*\[native \w/,ra=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,sa=/[+~]/,ta=new RegExp("\\\\([\\da-f]{1,6}"+ca+"?|("+ca+")|.)","ig"),ua=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},va=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,wa=function(a,b){return b?"\0"===a?"":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},xa=function(){G()},ya=o(function(a){return!0===a.disabled&&("form"in a||"label"in a)},{dir:"parentNode",next:"legend"});try{$.apply(X=_.call(P.childNodes),P.childNodes),
X[P.childNodes.length].nodeType}catch(za){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}w=b.support={},z=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},G=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:P;return d!==H&&9===d.nodeType&&d.documentElement?(H=d,I=H.documentElement,J=!z(H),P!==H&&(c=H.defaultView)&&c.top!==c&&(c.addEventListener?c.addEventListener("unload",xa,!1):c.attachEvent&&c.attachEvent("onunload",xa)),w.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),w.getElementsByTagName=e(function(a){return a.appendChild(H.createComment("")),!a.getElementsByTagName("*").length}),w.getElementsByClassName=qa.test(H.getElementsByClassName),w.getById=e(function(a){return I.appendChild(a).id=O,!H.getElementsByName||!H.getElementsByName(O).length}),w.getById?(x.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){return a.getAttribute("id")===b}},x.find.ID=function(a,b){if(void 0!==b.getElementById&&J){var c=b.getElementById(a);return c?[c]:[]}}):(x.filter.ID=function(a){var b=a.replace(ta,ua);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}},x.find.ID=function(a,b){if(void 0!==b.getElementById&&J){var c,d,e,f=b.getElementById(a);if(f){if((c=f.getAttributeNode("id"))&&c.value===a)return[f];for(e=b.getElementsByName(a),d=0;f=e[d++];)if((c=f.getAttributeNode("id"))&&c.value===a)return[f]}return[]}}),x.find.TAG=w.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):w.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},x.find.CLASS=w.getElementsByClassName&&function(a,b){if(void 0!==b.getElementsByClassName&&J)return b.getElementsByClassName(a)},L=[],K=[],(w.qsa=qa.test(H.querySelectorAll))&&(e(function(a){I.appendChild(a).innerHTML="<a id='"+O+"'></a><select id='"+O+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&K.push("[*^$]="+ca+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||K.push("\\["+ca+"*(?:value|"+ba+")"),a.querySelectorAll("[id~="+O+"-]").length||K.push("~="),a.querySelectorAll(":checked").length||K.push(":checked"),a.querySelectorAll("a#"+O+"+*").length||K.push(".#.+[+~]")}),e(function(a){a.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var b=H.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&K.push("name"+ca+"*[*^$|!~]?="),2!==a.querySelectorAll(":enabled").length&&K.push(":enabled",":disabled"),I.appendChild(a).disabled=!0,2!==a.querySelectorAll(":disabled").length&&K.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),K.push(",.*:")})),(w.matchesSelector=qa.test(M=I.matches||I.webkitMatchesSelector||I.mozMatchesSelector||I.oMatchesSelector||I.msMatchesSelector))&&e(function(a){w.disconnectedMatch=M.call(a,"*"),M.call(a,"[s!='']:x"),L.push("!=",fa)}),K=K.length&&new RegExp(K.join("|")),L=L.length&&new RegExp(L.join("|")),b=qa.test(I.compareDocumentPosition),N=b||qa.test(I.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},V=b?function(a,b){if(a===b)return F=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c||(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!w.sortDetached&&b.compareDocumentPosition(a)===c?a===H||a.ownerDocument===P&&N(P,a)?-1:b===H||b.ownerDocument===P&&N(P,b)?1:E?aa(E,a)-aa(E,b):0:4&c?-1:1)}:function(a,b){if(a===b)return F=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===H?-1:b===H?1:e?-1:f?1:E?aa(E,a)-aa(E,b):0;if(e===f)return g(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?g(h[d],i[d]):h[d]===P?-1:i[d]===P?1:0},H):H},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==H&&G(a),c=c.replace(ka,"='$1']"),w.matchesSelector&&J&&!U[c+" "]&&(!L||!L.test(c))&&(!K||!K.test(c)))try{var d=M.call(a,c);if(d||w.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(za){}return b(c,H,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==H&&G(a),N(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==H&&G(a);var c=x.attrHandle[b.toLowerCase()],d=c&&W.call(x.attrHandle,b.toLowerCase())?c(a,b,!J):void 0;return void 0!==d?d:w.attributes||!J?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.escape=function(a){return(a+"").replace(va,wa)},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(F=!w.detectDuplicates,E=!w.sortStable&&a.slice(0),a.sort(V),F){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return E=null,a},y=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=y(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=y(b);return c},x=b.selectors={cacheLength:50,createPseudo:d,match:na,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ta,ua),a[3]=(a[3]||a[4]||a[5]||"").replace(ta,ua),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return na.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&la.test(c)&&(b=A(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ta,ua).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=S[a+" "];return b||(b=new RegExp("(^|"+ca+")"+a+"("+ca+"|$)"))&&S(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:!c||(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ga," ")+" ").indexOf(d)>-1:"|="===c&&(f===d||f.slice(0,d.length+1)===d+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(m=q,l=m[O]||(m[O]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===Q&&j[1],t=n&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[Q,n,t];break}}else if(s&&(m=b,l=m[O]||(m[O]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===Q&&j[1],t=n),!1===t)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&(l=m[O]||(m[O]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[Q,t]),m!==b)););return(t-=e)===d||t%d==0&&t/d>=0}}},PSEUDO:function(a,c){var e,f=x.pseudos[a]||x.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[O]?f(c):f.length>1?(e=[a,a,"",c],x.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=aa(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=B(a.replace(ha,"$1"));return e[O]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(ta,ua),function(b){return(b.textContent||b.innerText||y(b)).indexOf(a)>-1}}),lang:d(function(a){return ma.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(ta,ua).toLowerCase(),function(b){var c;do{if(c=J?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===I},focus:function(a){return a===H.activeElement&&(!H.hasFocus||H.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:j(!1),disabled:j(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!x.pseudos.empty(a)},header:function(a){return pa.test(a.nodeName)},input:function(a){return oa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[c<0?c+b:c]}),even:k(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:k(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},x.pseudos.nth=x.pseudos.eq;for(v in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[v]=h(v);for(v in{submit:!0,reset:!0})x.pseudos[v]=i(v);return m.prototype=x.filters=x.pseudos,x.setFilters=new m,A=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=T[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=x.preFilter;h;){d&&!(e=ia.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ja.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ha," ")}),h=h.slice(d.length));for(g in x.filter)!(e=na[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):T(a,i).slice(0)},B=b.compile=function(a,b){var c,d=[],e=[],f=U[a+" "];if(!f){for(b||(b=A(a)),c=b.length;c--;)f=t(b[c]),f[O]?d.push(f):e.push(f);f=U(a,u(e,d)),f.selector=a}return f},C=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,k=!d&&A(a=j.selector||a);if(c=c||[],1===k.length){if(f=k[0]=k[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&9===b.nodeType&&J&&x.relative[f[1].type]){if(!(b=(x.find.ID(g.matches[0].replace(ta,ua),b)||[])[0]))return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=na.needsContext.test(a)?0:f.length;e--&&(g=f[e],!x.relative[h=g.type]);)if((i=x.find[h])&&(d=i(g.matches[0].replace(ta,ua),sa.test(f[0].type)&&l(b.parentNode)||b))){if(f.splice(e,1),!(a=d.length&&n(f)))return $.apply(c,d),c;break}}return(j||B(a,k))(d,b,!J,c,!b||sa.test(a)&&l(b.parentNode)||b),c},w.sortStable=O.split("").sort(V).join("")===O,w.detectDuplicates=!!F,G(),w.sortDetached=e(function(a){return 1&a.compareDocumentPosition(H.createElement("fieldset"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),w.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ba,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);pa.find=ua,pa.expr=ua.selectors,pa.expr[":"]=pa.expr.pseudos,pa.uniqueSort=pa.unique=ua.uniqueSort,pa.text=ua.getText,pa.isXMLDoc=ua.isXML,pa.contains=ua.contains,pa.escapeSelector=ua.escape;var va=function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&pa(a).is(c))break;d.push(a)}return d},wa=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},xa=pa.expr.match.needsContext,ya=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,za=/^.[^:#\[\.,]*$/;pa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?pa.find.matchesSelector(d,a)?[d]:[]:pa.find.matches(a,pa.grep(b,function(a){return 1===a.nodeType}))},pa.fn.extend({find:function(a){var b,c,d=this.length,e=this;if("string"!=typeof a)return this.pushStack(pa(a).filter(function(){for(b=0;b<d;b++)if(pa.contains(e[b],this))return!0}));for(c=this.pushStack([]),b=0;b<d;b++)pa.find(a,e[b],c);return d>1?pa.uniqueSort(c):c},filter:function(a){return this.pushStack(f(this,a||[],!1))},not:function(a){return this.pushStack(f(this,a||[],!0))},is:function(a){return!!f(this,"string"==typeof a&&xa.test(a)?pa(a):a||[],!1).length}});var Aa,Ba=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(pa.fn.init=function(a,b,c){var d,e;if(!a)return this;if(c=c||Aa,"string"==typeof a){if(!(d="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:Ba.exec(a))||!d[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(d[1]){if(b=b instanceof pa?b[0]:b,pa.merge(this,pa.parseHTML(d[1],b&&b.nodeType?b.ownerDocument||b:ca,!0)),ya.test(d[1])&&pa.isPlainObject(b))for(d in b)pa.isFunction(this[d])?this[d](b[d]):this.attr(d,b[d]);return this}return e=ca.getElementById(d[2]),e&&(this[0]=e,this.length=1),this}return a.nodeType?(this[0]=a,this.length=1,this):pa.isFunction(a)?void 0!==c.ready?c.ready(a):a(pa):pa.makeArray(a,this)}).prototype=pa.fn,Aa=pa(ca);var Ca=/^(?:parents|prev(?:Until|All))/,Da={children:!0,contents:!0,next:!0,prev:!0};pa.fn.extend({has:function(a){var b=pa(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(pa.contains(this,b[a]))return!0})},closest:function(a,b){var c,d=0,e=this.length,f=[],g="string"!=typeof a&&pa(a);if(!xa.test(a))for(;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&pa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?pa.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?ha.call(pa(a),this[0]):ha.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(pa.uniqueSort(pa.merge(this.get(),pa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),pa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return va(a,"parentNode")},parentsUntil:function(a,b,c){return va(a,"parentNode",c)},next:function(a){return g(a,"nextSibling")},prev:function(a){return g(a,"previousSibling")},nextAll:function(a){return va(a,"nextSibling")},prevAll:function(a){return va(a,"previousSibling")},nextUntil:function(a,b,c){return va(a,"nextSibling",c)},prevUntil:function(a,b,c){return va(a,"previousSibling",c)},siblings:function(a){return wa((a.parentNode||{}).firstChild,a)},children:function(a){return wa(a.firstChild)},contents:function(a){return e(a,"iframe")?a.contentDocument:(e(a,"template")&&(a=a.content||a),pa.merge([],a.childNodes))}},function(a,b){pa.fn[a]=function(c,d){var e=pa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=pa.filter(d,e)),this.length>1&&(Da[a]||pa.uniqueSort(e),Ca.test(a)&&e.reverse()),this.pushStack(e)}});var Ea=/[^\x20\t\r\n\f]+/g;pa.Callbacks=function(a){a="string"==typeof a?h(a):pa.extend({},a);var b,c,d,e,f=[],g=[],i=-1,j=function(){for(e=e||a.once,d=b=!0;g.length;i=-1)for(c=g.shift();++i<f.length;)!1===f[i].apply(c[0],c[1])&&a.stopOnFalse&&(i=f.length,c=!1);a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},k={add:function(){return f&&(c&&!b&&(i=f.length-1,g.push(c)),function b(c){pa.each(c,function(c,d){pa.isFunction(d)?a.unique&&k.has(d)||f.push(d):d&&d.length&&"string"!==pa.type(d)&&b(d)})}(arguments),c&&!b&&j()),this},remove:function(){return pa.each(arguments,function(a,b){for(var c;(c=pa.inArray(b,f,c))>-1;)f.splice(c,1),c<=i&&i--}),this},has:function(a){return a?pa.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||b||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||j()),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},pa.extend({Deferred:function(b){var c=[["notify","progress",pa.Callbacks("memory"),pa.Callbacks("memory"),2],["resolve","done",pa.Callbacks("once memory"),pa.Callbacks("once memory"),0,"resolved"],["reject","fail",pa.Callbacks("once memory"),pa.Callbacks("once memory"),1,"rejected"]],d="pending",e={state:function(){return d},always:function(){return f.done(arguments).fail(arguments),this},catch:function(a){return e.then(null,a)},pipe:function(){var a=arguments;return pa.Deferred(function(b){pa.each(c,function(c,d){var e=pa.isFunction(a[d[4]])&&a[d[4]];f[d[1]](function(){var a=e&&e.apply(this,arguments);a&&pa.isFunction(a.promise)?a.promise().progress(b.notify).done(b.resolve).fail(b.reject):b[d[0]+"With"](this,e?[a]:arguments)})}),a=null}).promise()},then:function(b,d,e){function f(b,c,d,e){return function(){var h=this,k=arguments,l=function(){var a,l;if(!(b<g)){if((a=d.apply(h,k))===c.promise())throw new TypeError("Thenable self-resolution");l=a&&("object"==typeof a||"function"==typeof a)&&a.then,pa.isFunction(l)?e?l.call(a,f(g,c,i,e),f(g,c,j,e)):(g++,l.call(a,f(g,c,i,e),f(g,c,j,e),f(g,c,i,c.notifyWith))):(d!==i&&(h=void 0,k=[a]),(e||c.resolveWith)(h,k))}},m=e?l:function(){try{l()}catch(a){pa.Deferred.exceptionHook&&pa.Deferred.exceptionHook(a,m.stackTrace),b+1>=g&&(d!==j&&(h=void 0,k=[a]),c.rejectWith(h,k))}};b?m():(pa.Deferred.getStackHook&&(m.stackTrace=pa.Deferred.getStackHook()),a.setTimeout(m))}}var g=0;return pa.Deferred(function(a){c[0][3].add(f(0,a,pa.isFunction(e)?e:i,a.notifyWith)),c[1][3].add(f(0,a,pa.isFunction(b)?b:i)),c[2][3].add(f(0,a,pa.isFunction(d)?d:j))}).promise()},promise:function(a){return null!=a?pa.extend(a,e):e}},f={};return pa.each(c,function(a,b){var g=b[2],h=b[5];e[b[1]]=g.add,h&&g.add(function(){d=h},c[3-a][2].disable,c[0][2].lock),g.add(b[3].fire),f[b[0]]=function(){return f[b[0]+"With"](this===f?void 0:this,arguments),this},f[b[0]+"With"]=g.fireWith}),e.promise(f),b&&b.call(f,f),f},when:function(a){var b=arguments.length,c=b,d=Array(c),e=ea.call(arguments),f=pa.Deferred(),g=function(a){return function(c){d[a]=this,e[a]=arguments.length>1?ea.call(arguments):c,--b||f.resolveWith(d,e)}};if(b<=1&&(k(a,f.done(g(c)).resolve,f.reject,!b),"pending"===f.state()||pa.isFunction(e[c]&&e[c].then)))return f.then();for(;c--;)k(e[c],g(c),f.reject);return f.promise()}});var Fa=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;pa.Deferred.exceptionHook=function(b,c){a.console&&a.console.warn&&b&&Fa.test(b.name)&&a.console.warn("jQuery.Deferred exception: "+b.message,b.stack,c)},pa.readyException=function(b){a.setTimeout(function(){throw b})};var Ga=pa.Deferred();pa.fn.ready=function(a){return Ga.then(a).catch(function(a){pa.readyException(a)}),this},pa.extend({isReady:!1,readyWait:1,ready:function(a){(!0===a?--pa.readyWait:pa.isReady)||(pa.isReady=!0,!0!==a&&--pa.readyWait>0||Ga.resolveWith(ca,[pa]))}}),pa.ready.then=Ga.then,"complete"===ca.readyState||"loading"!==ca.readyState&&!ca.documentElement.doScroll?a.setTimeout(pa.ready):(ca.addEventListener("DOMContentLoaded",l),a.addEventListener("load",l));var Ha=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===pa.type(c)){e=!0;for(h in c)Ha(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,pa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(pa(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},Ia=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};m.uid=1,m.prototype={cache:function(a){var b=a[this.expando];return b||(b={},Ia(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[pa.camelCase(b)]=c;else for(d in b)e[pa.camelCase(d)]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][pa.camelCase(b)]},access:function(a,b,c){return void 0===b||b&&"string"==typeof b&&void 0===c?this.get(a,b):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d=a[this.expando];if(void 0!==d){if(void 0!==b){Array.isArray(b)?b=b.map(pa.camelCase):(b=pa.camelCase(b),b=b in d?[b]:b.match(Ea)||[]),c=b.length;for(;c--;)delete d[b[c]]}(void 0===b||pa.isEmptyObject(d))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!pa.isEmptyObject(b)}};var Ja=new m,Ka=new m,La=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ma=/[A-Z]/g;pa.extend({hasData:function(a){return Ka.hasData(a)||Ja.hasData(a)},data:function(a,b,c){return Ka.access(a,b,c)},removeData:function(a,b){Ka.remove(a,b)},_data:function(a,b,c){return Ja.access(a,b,c)},_removeData:function(a,b){Ja.remove(a,b)}}),pa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=Ka.get(f),1===f.nodeType&&!Ja.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=pa.camelCase(d.slice(5)),o(f,d,e[d])));Ja.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){Ka.set(this,a)}):Ha(this,function(b){var c;if(f&&void 0===b){if(void 0!==(c=Ka.get(f,a)))return c;if(void 0!==(c=o(f,a)))return c}else this.each(function(){Ka.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){Ka.remove(this,a)})}}),pa.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=Ja.get(a,b),c&&(!d||Array.isArray(c)?d=Ja.access(a,b,pa.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=pa.queue(a,b),d=c.length,e=c.shift(),f=pa._queueHooks(a,b),g=function(){pa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return Ja.get(a,c)||Ja.access(a,c,{empty:pa.Callbacks("once memory").add(function(){Ja.remove(a,[b+"queue",c])})})}}),pa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?pa.queue(this[0],a):void 0===b?this:this.each(function(){var c=pa.queue(this,a,b);pa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&pa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){pa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=pa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=Ja.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Na=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Oa=new RegExp("^(?:([+-])=|)("+Na+")([a-z%]*)$","i"),Pa=["Top","Right","Bottom","Left"],Qa=function(a,b){return a=b||a,"none"===a.style.display||""===a.style.display&&pa.contains(a.ownerDocument,a)&&"none"===pa.css(a,"display")},Ra=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},Sa={};pa.fn.extend({show:function(){return r(this,!0)},hide:function(){return r(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Qa(this)?pa(this).show():pa(this).hide()})}});var Ta=/^(?:checkbox|radio)$/i,Ua=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Va=/^$|\/(?:java|ecma)script/i,Wa={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Wa.optgroup=Wa.option,Wa.tbody=Wa.tfoot=Wa.colgroup=Wa.caption=Wa.thead,Wa.th=Wa.td;var Xa=/<|&#?\w+;/;!function(){var a=ca.createDocumentFragment(),b=a.appendChild(ca.createElement("div")),c=ca.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),na.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",na.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var Ya=ca.documentElement,Za=/^key/,$a=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_a=/^([^.]*)(?:\.(.+)|)/;pa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=Ja.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),e&&pa.find.matchesSelector(Ya,e),c.guid||(c.guid=pa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return void 0!==pa&&pa.event.triggered!==b.type?pa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(Ea)||[""],j=b.length;j--;)h=_a.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=pa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=pa.event.special[n]||{},k=pa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&pa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,o,g)||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),pa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=Ja.hasData(a)&&Ja.get(a);if(q&&(i=q.events)){for(b=(b||"").match(Ea)||[""],j=b.length;j--;)if(h=_a.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=pa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,o,q.handle)||pa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)pa.event.remove(a,n+b[j],c,d,!0);pa.isEmptyObject(i)&&Ja.remove(a,"handle events")}},dispatch:function(a){var b,c,d,e,f,g,h=pa.event.fix(a),i=new Array(arguments.length),j=(Ja.get(this,"events")||{})[h.type]||[],k=pa.event.special[h.type]||{};for(i[0]=h,b=1;b<arguments.length;b++)i[b]=arguments[b];if(h.delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,h)){for(g=pa.event.handlers.call(this,h,j),b=0;(e=g[b++])&&!h.isPropagationStopped();)for(h.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!h.isImmediatePropagationStopped();)h.rnamespace&&!h.rnamespace.test(f.namespace)||(h.handleObj=f,h.data=f.data,void 0!==(d=((pa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,i))&&!1===(h.result=d)&&(h.preventDefault(),h.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,h),h.result}},handlers:function(a,b){var c,d,e,f,g,h=[],i=b.delegateCount,j=a.target;if(i&&j.nodeType&&!("click"===a.type&&a.button>=1))for(;j!==this;j=j.parentNode||this)if(1===j.nodeType&&("click"!==a.type||!0!==j.disabled)){for(f=[],g={},c=0;c<i;c++)d=b[c],e=d.selector+" ",void 0===g[e]&&(g[e]=d.needsContext?pa(e,this).index(j)>-1:pa.find(e,this,null,[j]).length),g[e]&&f.push(d);f.length&&h.push({elem:j,handlers:f})}return j=this,i<b.length&&h.push({elem:j,handlers:b.slice(i)}),h},addProp:function(a,b){Object.defineProperty(pa.Event.prototype,a,{enumerable:!0,configurable:!0,get:pa.isFunction(b)?function(){if(this.originalEvent)return b(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[a]},set:function(b){Object.defineProperty(this,a,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(a){return a[pa.expando]?a:new pa.Event(a)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==x()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===x()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&e(this,"input"))return this.click(),!1},_default:function(a){return e(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},pa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},pa.Event=function(a,b){if(!(this instanceof pa.Event))return new pa.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?v:w,this.target=a.target&&3===a.target.nodeType?a.target.parentNode:a.target,this.currentTarget=a.currentTarget,this.relatedTarget=a.relatedTarget):this.type=a,b&&pa.extend(this,b),this.timeStamp=a&&a.timeStamp||pa.now(),this[pa.expando]=!0},pa.Event.prototype={constructor:pa.Event,isDefaultPrevented:w,isPropagationStopped:w,isImmediatePropagationStopped:w,isSimulated:!1,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=v,a&&!this.isSimulated&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=v,a&&!this.isSimulated&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=v,a&&!this.isSimulated&&a.stopImmediatePropagation(),this.stopPropagation()}},pa.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(a){var b=a.button;return null==a.which&&Za.test(a.type)?null!=a.charCode?a.charCode:a.keyCode:!a.which&&void 0!==b&&$a.test(a.type)?1&b?1:2&b?3:4&b?2:0:a.which}},pa.event.addProp),pa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){pa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||pa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),pa.fn.extend({on:function(a,b,c,d){return y(this,a,b,c,d)},one:function(a,b,c,d){return y(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,pa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=w),this.each(function(){pa.event.remove(this,a,c,b)})}})
;var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,bb=/<script|<style|<link/i,cb=/checked\s*(?:[^=]|=\s*.checked.)/i,db=/^true\/(.*)/,eb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;pa.extend({htmlPrefilter:function(a){return a.replace(ab,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=pa.contains(a.ownerDocument,a);if(!(na.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||pa.isXMLDoc(a)))for(g=s(h),f=s(a),d=0,e=f.length;d<e;d++)D(f[d],g[d]);if(b)if(c)for(f=f||s(a),g=g||s(h),d=0,e=f.length;d<e;d++)C(f[d],g[d]);else C(a,h);return g=s(h,"script"),g.length>0&&t(g,!i&&s(a,"script")),h},cleanData:function(a){for(var b,c,d,e=pa.event.special,f=0;void 0!==(c=a[f]);f++)if(Ia(c)){if(b=c[Ja.expando]){if(b.events)for(d in b.events)e[d]?pa.event.remove(c,d):pa.removeEvent(c,d,b.handle);c[Ja.expando]=void 0}c[Ka.expando]&&(c[Ka.expando]=void 0)}}}),pa.fn.extend({detach:function(a){return F(this,a,!0)},remove:function(a){return F(this,a)},text:function(a){return Ha(this,function(a){return void 0===a?pa.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return E(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){z(this,a).appendChild(a)}})},prepend:function(){return E(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=z(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return E(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return E(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(pa.cleanData(s(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return pa.clone(this,a,b)})},html:function(a){return Ha(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!bb.test(a)&&!Wa[(Ua.exec(a)||["",""])[1].toLowerCase()]){a=pa.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(pa.cleanData(s(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return E(this,arguments,function(b){var c=this.parentNode;pa.inArray(this,a)<0&&(pa.cleanData(s(this)),c&&c.replaceChild(b,this))},a)}}),pa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){pa.fn[a]=function(a){for(var c,d=[],e=pa(a),f=e.length-1,g=0;g<=f;g++)c=g===f?this:this.clone(!0),pa(e[g])[b](c),ga.apply(d,c.get());return this.pushStack(d)}});var fb=/^margin/,gb=new RegExp("^("+Na+")(?!px)[a-z%]+$","i"),hb=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)};!function(){function b(){if(h){h.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",Ya.appendChild(g);var b=a.getComputedStyle(h);c="1%"!==b.top,f="2px"===b.marginLeft,d="4px"===b.width,h.style.marginRight="50%",e="4px"===b.marginRight,Ya.removeChild(g),h=null}}var c,d,e,f,g=ca.createElement("div"),h=ca.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",na.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),pa.extend(na,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return b(),d},pixelMarginRight:function(){return b(),e},reliableMarginLeft:function(){return b(),f}}))}();var ib=/^(none|table(?!-c[ea]).+)/,jb=/^--/,kb={position:"absolute",visibility:"hidden",display:"block"},lb={letterSpacing:"0",fontWeight:"400"},mb=["Webkit","Moz","ms"],nb=ca.createElement("div").style;pa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=G(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=pa.camelCase(b),i=jb.test(b),j=a.style;if(i||(b=J(h)),g=pa.cssHooks[b]||pa.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:j[b];f=typeof c,"string"===f&&(e=Oa.exec(c))&&e[1]&&(c=p(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(pa.cssNumber[h]?"":"px")),na.clearCloneStyle||""!==c||0!==b.indexOf("background")||(j[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i?j.setProperty(b,c):j[b]=c))}},css:function(a,b,c,d){var e,f,g,h=pa.camelCase(b);return jb.test(b)||(b=J(h)),g=pa.cssHooks[b]||pa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=G(a,b,d)),"normal"===e&&b in lb&&(e=lb[b]),""===c||c?(f=parseFloat(e),!0===c||isFinite(f)?f||0:e):e}}),pa.each(["height","width"],function(a,b){pa.cssHooks[b]={get:function(a,c,d){if(c)return!ib.test(pa.css(a,"display"))||a.getClientRects().length&&a.getBoundingClientRect().width?M(a,b,d):Ra(a,kb,function(){return M(a,b,d)})},set:function(a,c,d){var e,f=d&&hb(a),g=d&&L(a,b,d,"border-box"===pa.css(a,"boxSizing",!1,f),f);return g&&(e=Oa.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=pa.css(a,b)),K(a,c,g)}}}),pa.cssHooks.marginLeft=H(na.reliableMarginLeft,function(a,b){if(b)return(parseFloat(G(a,"marginLeft"))||a.getBoundingClientRect().left-Ra(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),pa.each({margin:"",padding:"",border:"Width"},function(a,b){pa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+Pa[d]+b]=f[d]||f[d-2]||f[0];return e}},fb.test(a)||(pa.cssHooks[a+b].set=K)}),pa.fn.extend({css:function(a,b){return Ha(this,function(a,b,c){var d,e,f={},g=0;if(Array.isArray(b)){for(d=hb(a),e=b.length;g<e;g++)f[b[g]]=pa.css(a,b[g],!1,d);return f}return void 0!==c?pa.style(a,b,c):pa.css(a,b)},a,b,arguments.length>1)}}),pa.Tween=N,N.prototype={constructor:N,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||pa.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(pa.cssNumber[c]?"":"px")},cur:function(){var a=N.propHooks[this.prop];return a&&a.get?a.get(this):N.propHooks._default.get(this)},run:function(a){var b,c=N.propHooks[this.prop];return this.options.duration?this.pos=b=pa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):N.propHooks._default.set(this),this}},N.prototype.init.prototype=N.prototype,N.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=pa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){pa.fx.step[a.prop]?pa.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[pa.cssProps[a.prop]]&&!pa.cssHooks[a.prop]?a.elem[a.prop]=a.now:pa.style(a.elem,a.prop,a.now+a.unit)}}},N.propHooks.scrollTop=N.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},pa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},pa.fx=N.prototype.init,pa.fx.step={};var ob,pb,qb=/^(?:toggle|show|hide)$/,rb=/queueHooks$/;pa.Animation=pa.extend(U,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return p(c.elem,a,Oa.exec(b),c),c}]},tweener:function(a,b){pa.isFunction(a)?(b=a,a=["*"]):a=a.match(Ea);for(var c,d=0,e=a.length;d<e;d++)c=a[d],U.tweeners[c]=U.tweeners[c]||[],U.tweeners[c].unshift(b)},prefilters:[S],prefilter:function(a,b){b?U.prefilters.unshift(a):U.prefilters.push(a)}}),pa.speed=function(a,b,c){var d=a&&"object"==typeof a?pa.extend({},a):{complete:c||!c&&b||pa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!pa.isFunction(b)&&b};return pa.fx.off?d.duration=0:"number"!=typeof d.duration&&(d.duration in pa.fx.speeds?d.duration=pa.fx.speeds[d.duration]:d.duration=pa.fx.speeds._default),null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){pa.isFunction(d.old)&&d.old.call(this),d.queue&&pa.dequeue(this,d.queue)},d},pa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Qa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=pa.isEmptyObject(a),f=pa.speed(b,c,d),g=function(){var b=U(this,pa.extend({},a),f);(e||Ja.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=pa.timers,g=Ja.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&rb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||pa.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=Ja.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=pa.timers,g=d?d.length:0;for(c.finish=!0,pa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),pa.each(["toggle","show","hide"],function(a,b){var c=pa.fn[b];pa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Q(b,!0),a,d,e)}}),pa.each({slideDown:Q("show"),slideUp:Q("hide"),slideToggle:Q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){pa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),pa.timers=[],pa.fx.tick=function(){var a,b=0,c=pa.timers;for(ob=pa.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||pa.fx.stop(),ob=void 0},pa.fx.timer=function(a){pa.timers.push(a),pa.fx.start()},pa.fx.interval=13,pa.fx.start=function(){pb||(pb=!0,O())},pa.fx.stop=function(){pb=null},pa.fx.speeds={slow:600,fast:200,_default:400},pa.fn.delay=function(b,c){return b=pa.fx?pa.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=ca.createElement("input"),b=ca.createElement("select"),c=b.appendChild(ca.createElement("option"));a.type="checkbox",na.checkOn=""!==a.value,na.optSelected=c.selected,a=ca.createElement("input"),a.value="t",a.type="radio",na.radioValue="t"===a.value}();var sb,tb=pa.expr.attrHandle;pa.fn.extend({attr:function(a,b){return Ha(this,pa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){pa.removeAttr(this,a)})}}),pa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?pa.prop(a,b,c):(1===f&&pa.isXMLDoc(a)||(e=pa.attrHooks[b.toLowerCase()]||(pa.expr.match.bool.test(b)?sb:void 0)),void 0!==c?null===c?void pa.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=pa.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!na.radioValue&&"radio"===b&&e(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d=0,e=b&&b.match(Ea);if(e&&1===a.nodeType)for(;c=e[d++];)a.removeAttribute(c)}}),sb={set:function(a,b,c){return!1===b?pa.removeAttr(a,c):a.setAttribute(c,c),c}},pa.each(pa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=tb[b]||pa.find.attr;tb[b]=function(a,b,d){var e,f,g=b.toLowerCase();return d||(f=tb[g],tb[g]=e,e=null!=c(a,b,d)?g:null,tb[g]=f),e}});var ub=/^(?:input|select|textarea|button)$/i,vb=/^(?:a|area)$/i;pa.fn.extend({prop:function(a,b){return Ha(this,pa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[pa.propFix[a]||a]})}}),pa.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&pa.isXMLDoc(a)||(b=pa.propFix[b]||b,e=pa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=pa.find.attr(a,"tabindex");return b?parseInt(b,10):ub.test(a.nodeName)||vb.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),na.optSelected||(pa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),pa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){pa.propFix[this.toLowerCase()]=this}),pa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(pa.isFunction(a))return this.each(function(b){pa(this).addClass(a.call(this,b,W(this)))});if("string"==typeof a&&a)for(b=a.match(Ea)||[];c=this[i++];)if(e=W(c),d=1===c.nodeType&&" "+V(e)+" "){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=V(d),e!==h&&c.setAttribute("class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(pa.isFunction(a))return this.each(function(b){pa(this).removeClass(a.call(this,b,W(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(Ea)||[];c=this[i++];)if(e=W(c),d=1===c.nodeType&&" "+V(e)+" "){for(g=0;f=b[g++];)for(;d.indexOf(" "+f+" ")>-1;)d=d.replace(" "+f+" "," ");h=V(d),e!==h&&c.setAttribute("class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):pa.isFunction(a)?this.each(function(c){pa(this).toggleClass(a.call(this,c,W(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c)for(d=0,e=pa(this),f=a.match(Ea)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!==c||(b=W(this),b&&Ja.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===a?"":Ja.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&(" "+V(W(c))+" ").indexOf(b)>-1)return!0;return!1}});var wb=/\r/g;pa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=pa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,pa(this).val()):a,null==e?e="":"number"==typeof e?e+="":Array.isArray(e)&&(e=pa.map(e,function(a){return null==a?"":a+""})),(b=pa.valHooks[this.type]||pa.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=pa.valHooks[e.type]||pa.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(wb,""):null==c?"":c)}}}),pa.extend({valHooks:{option:{get:function(a){var b=pa.find.attr(a,"value");return null!=b?b:V(pa.text(a))}},select:{get:function(a){var b,c,d,f=a.options,g=a.selectedIndex,h="select-one"===a.type,i=h?null:[],j=h?g+1:f.length;for(d=g<0?j:h?g:0;d<j;d++)if(c=f[d],(c.selected||d===g)&&!c.disabled&&(!c.parentNode.disabled||!e(c.parentNode,"optgroup"))){if(b=pa(c).val(),h)return b;i.push(b)}return i},set:function(a,b){for(var c,d,e=a.options,f=pa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=pa.inArray(pa.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),pa.each(["radio","checkbox"],function(){pa.valHooks[this]={set:function(a,b){if(Array.isArray(b))return a.checked=pa.inArray(pa(a).val(),b)>-1}},na.checkOn||(pa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var xb=/^(?:focusinfocus|focusoutblur)$/;pa.extend(pa.event,{trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||ca],n=ka.call(b,"type")?b.type:b,o=ka.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||ca,3!==d.nodeType&&8!==d.nodeType&&!xb.test(n+pa.event.triggered)&&(n.indexOf(".")>-1&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[pa.expando]?b:new pa.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:pa.makeArray(c,[b]),l=pa.event.special[n]||{},e||!l.trigger||!1!==l.trigger.apply(d,c))){if(!e&&!l.noBubble&&!pa.isWindow(d)){for(i=l.delegateType||n,xb.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||ca)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(Ja.get(g,"events")||{})[b.type]&&Ja.get(g,"handle"),k&&k.apply(g,c),(k=j&&g[j])&&k.apply&&Ia(g)&&(b.result=k.apply(g,c),!1===b.result&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&!1!==l._default.apply(m.pop(),c)||!Ia(d)||j&&pa.isFunction(d[n])&&!pa.isWindow(d)&&(h=d[j],h&&(d[j]=null),pa.event.triggered=n,d[n](),pa.event.triggered=void 0,h&&(d[j]=h)),b.result}},simulate:function(a,b,c){var d=pa.extend(new pa.Event,c,{type:a,isSimulated:!0});pa.event.trigger(d,null,b)}}),pa.fn.extend({trigger:function(a,b){return this.each(function(){pa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return pa.event.trigger(a,b,c,!0)}}),pa.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(a,b){pa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),pa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),na.focusin="onfocusin"in a,na.focusin||pa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){pa.event.simulate(b,a.target,pa.event.fix(a))};pa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=Ja.access(d,b);e||d.addEventListener(a,c,!0),Ja.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=Ja.access(d,b)-1;e?Ja.access(d,b,e):(d.removeEventListener(a,c,!0),Ja.remove(d,b))}}});var yb=a.location,zb=pa.now(),Ab=/\?/;pa.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||pa.error("Invalid XML: "+b),c};var Bb=/\[\]$/,Cb=/\r?\n/g,Db=/^(?:submit|button|image|reset|file)$/i,Eb=/^(?:input|select|textarea|keygen)/i;pa.param=function(a,b){var c,d=[],e=function(a,b){var c=pa.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(null==c?"":c)};if(Array.isArray(a)||a.jquery&&!pa.isPlainObject(a))pa.each(a,function(){e(this.name,this.value)});else for(c in a)X(c,a[c],b,e);return d.join("&")},pa.fn.extend({serialize:function(){return pa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=pa.prop(this,"elements");return a?pa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!pa(this).is(":disabled")&&Eb.test(this.nodeName)&&!Db.test(a)&&(this.checked||!Ta.test(a))}).map(function(a,b){var c=pa(this).val();return null==c?null:Array.isArray(c)?pa.map(c,function(a){return{name:b.name,value:a.replace(Cb,"\r\n")}}):{name:b.name,value:c.replace(Cb,"\r\n")}}).get()}});var Fb=/%20/g,Gb=/#.*$/,Hb=/([?&])_=[^&]*/,Ib=/^(.*?):[ \t]*([^\r\n]*)$/gm,Jb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Kb=/^(?:GET|HEAD)$/,Lb=/^\/\//,Mb={},Nb={},Ob="*/".concat("*"),Pb=ca.createElement("a");Pb.href=yb.href,pa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yb.href,type:"GET",isLocal:Jb.test(yb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ob,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":pa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?$($(a,pa.ajaxSettings),b):$(pa.ajaxSettings,a)},ajaxPrefilter:Y(Mb),ajaxTransport:Y(Nb),ajax:function(b,c){function d(b,c,d,h){var j,m,n,u,v,w=c;k||(k=!0,i&&a.clearTimeout(i),e=void 0,g=h||"",x.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(u=_(o,x,d)),u=aa(o,u,x,j),j?(o.ifModified&&(v=x.getResponseHeader("Last-Modified"),v&&(pa.lastModified[f]=v),(v=x.getResponseHeader("etag"))&&(pa.etag[f]=v)),204===b||"HEAD"===o.type?w="nocontent":304===b?w="notmodified":(w=u.state,m=u.data,n=u.error,j=!n)):(n=w,!b&&w||(w="error",b<0&&(b=0))),x.status=b,x.statusText=(c||w)+"",j?r.resolveWith(p,[m,w,x]):r.rejectWith(p,[x,w,n]),x.statusCode(t),t=void 0,l&&q.trigger(j?"ajaxSuccess":"ajaxError",[x,o,j?m:n]),s.fireWith(p,[x,w]),l&&(q.trigger("ajaxComplete",[x,o]),--pa.active||pa.event.trigger("ajaxStop")))}"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m,n,o=pa.ajaxSetup({},c),p=o.context||o,q=o.context&&(p.nodeType||p.jquery)?pa(p):pa.event,r=pa.Deferred(),s=pa.Callbacks("once memory"),t=o.statusCode||{},u={},v={},w="canceled",x={readyState:0,getResponseHeader:function(a){var b;if(k){if(!h)for(h={};b=Ib.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return k?g:null},setRequestHeader:function(a,b){return null==k&&(a=v[a.toLowerCase()]=v[a.toLowerCase()]||a,u[a]=b),this},overrideMimeType:function(a){return null==k&&(o.mimeType=a),this},statusCode:function(a){var b;if(a)if(k)x.always(a[x.status]);else for(b in a)t[b]=[t[b],a[b]];return this},abort:function(a){var b=a||w;return e&&e.abort(b),d(0,b),this}};if(r.promise(x),o.url=((b||o.url||yb.href)+"").replace(Lb,yb.protocol+"//"),o.type=c.method||c.type||o.method||o.type,o.dataTypes=(o.dataType||"*").toLowerCase().match(Ea)||[""],null==o.crossDomain){j=ca.createElement("a");try{j.href=o.url,j.href=j.href,o.crossDomain=Pb.protocol+"//"+Pb.host!=j.protocol+"//"+j.host}catch(y){o.crossDomain=!0}}if(o.data&&o.processData&&"string"!=typeof o.data&&(o.data=pa.param(o.data,o.traditional)),Z(Mb,o,c,x),k)return x;l=pa.event&&o.global,l&&0==pa.active++&&pa.event.trigger("ajaxStart"),o.type=o.type.toUpperCase(),o.hasContent=!Kb.test(o.type),f=o.url.replace(Gb,""),o.hasContent?o.data&&o.processData&&0===(o.contentType||"").indexOf("application/x-www-form-urlencoded")&&(o.data=o.data.replace(Fb,"+")):(n=o.url.slice(f.length),o.data&&(f+=(Ab.test(f)?"&":"?")+o.data,delete o.data),!1===o.cache&&(f=f.replace(Hb,"$1"),n=(Ab.test(f)?"&":"?")+"_="+zb+++n),o.url=f+n),o.ifModified&&(pa.lastModified[f]&&x.setRequestHeader("If-Modified-Since",pa.lastModified[f]),pa.etag[f]&&x.setRequestHeader("If-None-Match",pa.etag[f])),(o.data&&o.hasContent&&!1!==o.contentType||c.contentType)&&x.setRequestHeader("Content-Type",o.contentType),x.setRequestHeader("Accept",o.dataTypes[0]&&o.accepts[o.dataTypes[0]]?o.accepts[o.dataTypes[0]]+("*"!==o.dataTypes[0]?", "+Ob+"; q=0.01":""):o.accepts["*"]);for(m in o.headers)x.setRequestHeader(m,o.headers[m]);if(o.beforeSend&&(!1===o.beforeSend.call(p,x,o)||k))return x.abort();if(w="abort",s.add(o.complete),x.done(o.success),x.fail(o.error),e=Z(Nb,o,c,x)){if(x.readyState=1,l&&q.trigger("ajaxSend",[x,o]),k)return x;o.async&&o.timeout>0&&(i=a.setTimeout(function(){x.abort("timeout")},o.timeout));try{k=!1,e.send(u,d)}catch(y){if(k)throw y;d(-1,y)}}else d(-1,"No Transport");return x},getJSON:function(a,b,c){return pa.get(a,b,c,"json")},getScript:function(a,b){return pa.get(a,void 0,b,"script")}}),pa.each(["get","post"],function(a,b){pa[b]=function(a,c,d,e){return pa.isFunction(c)&&(e=e||d,d=c,c=void 0),pa.ajax(pa.extend({url:a,type:b,dataType:e,data:c,success:d},pa.isPlainObject(a)&&a))}}),pa._evalUrl=function(a){return pa.ajax({url:a,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},pa.fn.extend({wrapAll:function(a){var b;return this[0]&&(pa.isFunction(a)&&(a=a.call(this[0])),b=pa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this},wrapInner:function(a){return pa.isFunction(a)?this.each(function(b){pa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=pa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=pa.isFunction(a);return this.each(function(c){pa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(a){return this.parent(a).not("body").each(function(){pa(this).replaceWith(this.childNodes)}),this}}),pa.expr.pseudos.hidden=function(a){return!pa.expr.pseudos.visible(a)},pa.expr.pseudos.visible=function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)},pa.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Qb={0:200,1223:204},Rb=pa.ajaxSettings.xhr();na.cors=!!Rb&&"withCredentials"in Rb,na.ajax=Rb=!!Rb,pa.ajaxTransport(function(b){var c,d;if(na.cors||Rb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Qb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),pa.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),pa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return pa.globalEval(a),a}}}),pa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),pa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=pa("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),ca.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Sb=[],Tb=/(=)\?(?=&|$)|\?\?/;pa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Sb.pop()||pa.expando+"_"+zb++;return this[a]=!0,a}}),pa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Tb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Tb.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=pa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Tb,"$1"+e):!1!==b.jsonp&&(b.url+=(Ab.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||pa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?pa(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Sb.push(e)),g&&pa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),na.createHTMLDocument=function(){var a=ca.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),pa.parseHTML=function(a,b,c){if("string"!=typeof a)return[];"boolean"==typeof b&&(c=b,b=!1);var d,e,f;return b||(na.createHTMLDocument?(b=ca.implementation.createHTMLDocument(""),d=b.createElement("base"),d.href=ca.location.href,b.head.appendChild(d)):b=ca),e=ya.exec(a),f=!c&&[],e?[b.createElement(e[1])]:(e=u([a],b,f),f&&f.length&&pa(f).remove(),pa.merge([],e.childNodes))},pa.fn.load=function(a,b,c){var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=V(a.slice(h)),a=a.slice(0,h)),pa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&pa.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?pa("<div>").append(pa.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},pa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){pa.fn[b]=function(a){return this.on(b,a)}}),pa.expr.pseudos.animated=function(a){return pa.grep(pa.timers,function(b){return a===b.elem}).length},pa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=pa.css(a,"position"),l=pa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=pa.css(a,"top"),i=pa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),pa.isFunction(b)&&(b=b.call(a,c,pa.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},pa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){pa.offset.setOffset(this,a,b)});var b,c,d,e,f=this[0];if(f)return f.getClientRects().length?(d=f.getBoundingClientRect(),b=f.ownerDocument,c=b.documentElement,e=b.defaultView,{top:d.top+e.pageYOffset-c.clientTop,left:d.left+e.pageXOffset-c.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===pa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),e(a[0],"html")||(d=a.offset()),d={top:d.top+pa.css(a[0],"borderTopWidth",!0),left:d.left+pa.css(a[0],"borderLeftWidth",!0)}),{top:b.top-d.top-pa.css(c,"marginTop",!0),left:b.left-d.left-pa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===pa.css(a,"position");)a=a.offsetParent;return a||Ya})}}),pa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;pa.fn[a]=function(d){return Ha(this,function(a,d,e){var f;if(pa.isWindow(a)?f=a:9===a.nodeType&&(f=a.defaultView),void 0===e)return f?f[b]:a[d];f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e},a,d,arguments.length)}}),pa.each(["top","left"],function(a,b){pa.cssHooks[b]=H(na.pixelPosition,function(a,c){if(c)return c=G(a,b),gb.test(c)?pa(a).position()[b]+"px":c})}),pa.each({Height:"height",Width:"width"},function(a,b){pa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){pa.fn[d]=function(e,f){var g=arguments.length&&(c||"boolean"!=typeof e),h=c||(!0===e||!0===f?"margin":"border");return Ha(this,function(b,c,e){var f;return pa.isWindow(b)?0===d.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a]:9===b.nodeType?(f=b.documentElement,Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])):void 0===e?pa.css(b,c,h):pa.style(b,c,e,h)},b,g?e:void 0,g)}})}),pa.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}}),pa.holdReady=function(a){a?pa.readyWait++:pa.ready(!0)},pa.isArray=Array.isArray,pa.parseJSON=JSON.parse,pa.nodeName=e,
"function"==typeof define&&define.amd&&define("jquery",[],function(){return pa});var Ub=a.jQuery,Vb=a.$;return pa.noConflict=function(b){return a.$===pa&&(a.$=Vb),b&&a.jQuery===pa&&(a.jQuery=Ub),pa},b||(a.jQuery=a.$=pa),pa}),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.mapboxgl=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){!function(b,e){"object"==typeof d&&void 0!==c?c.exports=e():"function"==typeof a&&a.amd?a(e):b.glMatrix=e()}(this,function(){"use strict";function a(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a}function b(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a}function c(){var a=new Float32Array(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a}function d(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+f*h,a[1]=e*i+g*h,a[2]=d*-h+f*i,a[3]=e*-h+g*i,a}function e(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1];return a[0]=d*h,a[1]=e*h,a[2]=f*i,a[3]=g*i,a}function f(){var a=new Float32Array(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function g(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function h(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function i(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function j(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null}function k(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a}function l(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a}function m(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}function n(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a}function o(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a}function p(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a}function q(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a}return function(){var a=new Float32Array(3);a[0]=0,a[1]=0,a[2]=0}(),function(){var a=new Float32Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=0}(),{vec3:{transformMat3:a},vec4:{transformMat4:b},mat2:{create:c,rotate:d,scale:e},mat3:{create:f,fromRotation:g},mat4:{create:h,identity:i,translate:l,scale:m,multiply:k,perspective:p,rotateX:n,rotateZ:o,invert:j,ortho:q}}})},{}],2:[function(b,c,d){!function(b,e){"object"==typeof d&&void 0!==c?c.exports=e():"function"==typeof a&&a.amd?a(e):b.ShelfPack=e()}(this,function(){function a(a,b,c){c=c||{},this.w=a||64,this.h=b||64,this.autoResize=!!c.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function b(a,b,c){this.x=0,this.y=a,this.w=this.free=b,this.h=c}function c(a,b,c,d,e,f,g){this.id=a,this.x=b,this.y=c,this.w=d,this.h=e,this.maxw=f||d,this.maxh=g||e,this.refcount=0}return a.prototype.pack=function(a,b){a=[].concat(a),b=b||{};for(var c,d,e,f,g=[],h=0;h<a.length;h++)if(c=a[h].w||a[h].width,d=a[h].h||a[h].height,e=a[h].id,c&&d){if(!(f=this.packOne(c,d,e)))continue;b.inPlace&&(a[h].x=f.x,a[h].y=f.y,a[h].id=f.id),g.push(f)}if(this.shelves.length>0){for(var i=0,j=0,k=0;k<this.shelves.length;k++){var l=this.shelves[k];j+=l.h,i=Math.max(l.w-l.free,i)}this.resize(i,j)}return g},a.prototype.packOne=function(a,c,d){var e,f,g,h,i={freebin:-1,shelf:-1,waste:1/0},j=0;if("string"==typeof d||"number"==typeof d){if(e=this.getBin(d))return this.ref(e),e;"number"==typeof d&&(this.maxId=Math.max(d,this.maxId))}else d=++this.maxId;for(h=0;h<this.freebins.length;h++){if(e=this.freebins[h],c===e.maxh&&a===e.maxw)return this.allocFreebin(h,a,c,d);c>e.maxh||a>e.maxw||c<=e.maxh&&a<=e.maxw&&(g=e.maxw*e.maxh-a*c)<i.waste&&(i.waste=g,i.freebin=h)}for(h=0;h<this.shelves.length;h++)if(f=this.shelves[h],j+=f.h,!(a>f.free)){if(c===f.h)return this.allocShelf(h,a,c,d);c>f.h||c<f.h&&(g=(f.h-c)*a)<i.waste&&(i.freebin=-1,i.waste=g,i.shelf=h)}if(-1!==i.freebin)return this.allocFreebin(i.freebin,a,c,d);if(-1!==i.shelf)return this.allocShelf(i.shelf,a,c,d);if(c<=this.h-j&&a<=this.w)return f=new b(j,this.w,c),this.allocShelf(this.shelves.push(f)-1,a,c,d);if(this.autoResize){var k,l,m,n;return k=l=this.h,m=n=this.w,(m<=k||a>m)&&(n=2*Math.max(a,m)),(k<m||c>k)&&(l=2*Math.max(c,k)),this.resize(n,l),this.packOne(a,c,d)}return null},a.prototype.allocFreebin=function(a,b,c,d){var e=this.freebins.splice(a,1)[0];return e.id=d,e.w=b,e.h=c,e.refcount=0,this.bins[d]=e,this.ref(e),e},a.prototype.allocShelf=function(a,b,c,d){var e=this.shelves[a],f=e.alloc(b,c,d);return this.bins[d]=f,this.ref(f),f},a.prototype.getBin=function(a){return this.bins[a]},a.prototype.ref=function(a){if(1==++a.refcount){var b=a.h;this.stats[b]=1+(0|this.stats[b])}return a.refcount},a.prototype.unref=function(a){return 0===a.refcount?0:(0==--a.refcount&&(this.stats[a.h]--,delete this.bins[a.id],this.freebins.push(a)),a.refcount)},a.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},a.prototype.resize=function(a,b){this.w=a,this.h=b;for(var c=0;c<this.shelves.length;c++)this.shelves[c].resize(a);return!0},b.prototype.alloc=function(a,b,d){if(a>this.free||b>this.h)return null;var e=this.x;return this.x+=a,this.free-=a,new c(d,e,this.y,a,b,a,this.h)},b.prototype.resize=function(a){return this.free+=a-this.w,this.w=a,!0},a})},{}],3:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){this.fontSize=a||24,this.buffer=void 0===b?3:b,this.cutoff=d||.25,this.fontFamily=e||"sans-serif",this.fontWeight=f||"normal",this.radius=c||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function e(a,b,c,d,e,g,h){for(var i=0;i<b;i++){for(var j=0;j<c;j++)d[j]=a[j*b+i];for(f(d,e,g,h,c),j=0;j<c;j++)a[j*b+i]=e[j]}for(j=0;j<c;j++){for(i=0;i<b;i++)d[i]=a[j*b+i];for(f(d,e,g,h,b),i=0;i<b;i++)a[j*b+i]=Math.sqrt(e[i])}}function f(a,b,c,d,e){c[0]=0,d[0]=-g,d[1]=+g;for(var f=1,h=0;f<e;f++){for(var i=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);i<=d[h];)h--,i=(a[f]+f*f-(a[c[h]]+c[h]*c[h]))/(2*f-2*c[h]);h++,c[h]=f,d[h]=i,d[h+1]=+g}for(f=0,h=0;f<e;f++){for(;d[h+1]<f;)h++;b[f]=(f-c[h])*(f-c[h])+a[c[h]]}}b.exports=d;var g=1e20;d.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var b=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var f=b.data[4*d+3]/255;this.gridOuter[d]=1===f?0:0===f?g:Math.pow(Math.max(0,.5-f),2),this.gridInner[d]=1===f?g:0===f?0:Math.pow(Math.max(0,f-.5),2)}for(e(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),e(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++){var h=this.gridOuter[d]-this.gridInner[d];c[d]=Math.max(0,Math.min(255,Math.round(255-255*(h/this.radius+this.cutoff))))}return c}},{}],4:[function(a,b,c){function d(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=c,this.p2y=d}b.exports=d,d.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},d.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},d.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},d.prototype.solveCurveX=function(a,b){void 0===b&&(b=1e-6);var c,d,e,f,g;for(e=a,g=0;g<8;g++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;var h=this.sampleCurveDerivativeX(e);if(Math.abs(h)<1e-6)break;e-=f/h}if(c=0,d=1,(e=a)<c)return c;if(e>d)return d;for(;c<d;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},d.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))}},{}],5:[function(b,c,d){!function(b,e){"object"==typeof d&&void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e(b.WhooTS=b.WhooTS||{})}(this,function(a){function b(a,b,d,e,f,g){return g=g||{},a+"?"+["bbox="+c(d,e,f),"format="+(g.format||"image/png"),"service="+(g.service||"WMS"),"version="+(g.version||"1.1.1"),"request="+(g.request||"GetMap"),"srs="+(g.srs||"EPSG:3857"),"width="+(g.width||256),"height="+(g.height||256),"layers="+b].join("&")}function c(a,b,c){b=Math.pow(2,c)-b-1;var e=d(256*a,256*b,c),f=d(256*(a+1),256*(b+1),c);return e[0]+","+e[1]+","+f[0]+","+f[1]}function d(a,b,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,b*d-2*Math.PI*6378137/2]}a.getURL=b,a.getTileBBox=c,a.getMercCoords=d,Object.defineProperty(a,"__esModule",{value:!0})})},{}],6:[function(a,b,c){function d(a){return a=Math.round(a),a<0?0:a>255?255:a}function e(a){return a<0?0:a>1?1:a}function f(a){return d("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function g(a){return e("%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))}function h(a,b,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a}function i(a){var b=a.replace(/ /g,"").toLowerCase();if(b in j)return j[b].slice();if("#"===b[0]){if(4===b.length){var c=parseInt(b.substr(1),16);return c>=0&&c<=4095?[(3840&c)>>4|(3840&c)>>8,240&c|(240&c)>>4,15&c|(15&c)<<4,1]:null}if(7===b.length){var c=parseInt(b.substr(1),16);return c>=0&&c<=16777215?[(16711680&c)>>16,(65280&c)>>8,255&c,1]:null}return null}var e=b.indexOf("("),i=b.indexOf(")");if(-1!==e&&i+1===b.length){var k=b.substr(0,e),l=b.substr(e+1,i-(e+1)).split(","),m=1;switch(k){case"rgba":if(4!==l.length)return null;m=g(l.pop());case"rgb":return 3!==l.length?null:[f(l[0]),f(l[1]),f(l[2]),m];case"hsla":if(4!==l.length)return null;m=g(l.pop());case"hsl":if(3!==l.length)return null;var n=(parseFloat(l[0])%360+360)%360/360,o=g(l[1]),p=g(l[2]),q=p<=.5?p*(o+1):p+o-p*o,r=2*p-q;return[d(255*h(r,q,n+1/3)),d(255*h(r,q,n)),d(255*h(r,q,n-1/3)),m];default:return null}}return null}var j={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{c.parseCSSColor=i}catch(k){}},{}],7:[function(a,b,c){"use strict";function d(a,b,c){c=c||2;var d=b&&b.length,f=d?b[0]*c:a.length,h=e(a,0,f,c,!0),i=[];if(!h)return i;var j,k,m,n,o,p,q;if(d&&(h=l(a,b,h,c)),a.length>80*c){j=m=a[0],k=n=a[1];for(var r=c;r<f;r+=c)o=a[r],p=a[r+1],o<j&&(j=o),p<k&&(k=p),o>m&&(m=o),p>n&&(n=p);q=Math.max(m-j,n-k)}return g(h,i,c,j,k,q),i}function e(a,b,c,d,e){var f,g;if(e===F(a,b,c,d)>0)for(f=b;f<c;f+=d)g=C(f,a[f],a[f+1],g);else for(f=c-d;f>=b;f-=d)g=C(f,a[f],a[f+1],g);return g&&w(g,g.next)&&(D(g),g=g.next),g}function f(a,b){if(!a)return a;b||(b=a);var c,d=a;do{if(c=!1,d.steiner||!w(d,d.next)&&0!==v(d.prev,d,d.next))d=d.next;else{if(D(d),(d=b=d.prev)===d.next)return null;c=!0}}while(c||d!==b);return b}function g(a,b,c,d,e,l,m){if(a){!m&&l&&p(a,d,e,l);for(var n,o,q=a;a.prev!==a.next;)if(n=a.prev,o=a.next,l?i(a,d,e,l):h(a))b.push(n.i/c),b.push(a.i/c),b.push(o.i/c),D(a),a=o.next,q=o.next;else if((a=o)===q){m?1===m?(a=j(a,b,c),g(a,b,c,d,e,l,2)):2===m&&k(a,b,c,d,e,l):g(f(a),b,c,d,e,l,1);break}}}function h(a){var b=a.prev,c=a,d=a.next;if(v(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(t(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&v(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function i(a,b,c,d){var e=a.prev,f=a,g=a.next;if(v(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,i=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,j=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,k=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,l=r(h,i,b,c,d),m=r(j,k,b,c,d),n=a.nextZ;n&&n.z<=m;){if(n!==a.prev&&n!==a.next&&t(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.nextZ}for(n=a.prevZ;n&&n.z>=l;){if(n!==a.prev&&n!==a.next&&t(e.x,e.y,f.x,f.y,g.x,g.y,n.x,n.y)&&v(n.prev,n,n.next)>=0)return!1;n=n.prevZ}return!0}function j(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;!w(e,f)&&x(e,d,d.next,f)&&z(e,f)&&z(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),D(d),D(d.next),d=a=f),d=d.next}while(d!==a);return d}function k(a,b,c,d,e,h){var i=a;do{for(var j=i.next.next;j!==i.prev;){if(i.i!==j.i&&u(i,j)){var k=B(i,j);return i=f(i,i.next),k=f(k,k.next),g(i,b,c,d,e,h),void g(k,b,c,d,e,h)}j=j.next}i=i.next}while(i!==a)}function l(a,b,c,d){var g,h,i,j,k,l=[];for(g=0,h=b.length;g<h;g++)i=b[g]*d,j=g<h-1?b[g+1]*d:a.length,k=e(a,i,j,d,!1),k===k.next&&(k.steiner=!0),l.push(s(k));for(l.sort(m),g=0;g<l.length;g++)n(l[g],c),c=f(c,c.next);return c}function m(a,b){return a.x-b.x}function n(a,b){if(b=o(a,b)){var c=B(b,a);f(c,c.next)}}function o(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(h<=e&&h>g){if(g=h,h===e){if(f===d.y)return d;if(f===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(e===g)return c.prev;var i,j=c,k=c.x,l=c.y,m=1/0;for(d=c.next;d!==j;)e>=d.x&&d.x>=k&&t(f<l?e:g,f,k,l,f<l?g:e,f,d.x,d.y)&&((i=Math.abs(f-d.y)/(e-d.x))<m||i===m&&d.x>c.x)&&z(d,a)&&(c=d,m=i),d=d.next;return c}function p(a,b,c,d){var e=a;do{null===e.z&&(e.z=r(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,q(e)}function q(a){var b,c,d,e,f,g,h,i,j=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<j&&(h++,d=d.nextZ);b++);for(i=j;h>0||i>0&&d;)0===h?(e=d,d=d.nextZ,i--):0!==i&&d?c.z<=d.z?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,i--):(e=c,c=c.nextZ,h--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,j*=2}while(g>1);return a}function r(a,b,c,d,e){return a=32767*(a-c)/e,b=32767*(b-d)/e,a=16711935&(a|a<<8),a=252645135&(a|a<<4),a=858993459&(a|a<<2),a=1431655765&(a|a<<1),b=16711935&(b|b<<8),b=252645135&(b|b<<4),b=858993459&(b|b<<2),b=1431655765&(b|b<<1),a|b<<1}function s(a){var b=a,c=a;do{b.x<c.x&&(c=b),b=b.next}while(b!==a);return c}function t(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function u(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!y(a,b)&&z(a,b)&&z(b,a)&&A(a,b)}function v(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function w(a,b){return a.x===b.x&&a.y===b.y}function x(a,b,c,d){return!!(w(a,b)&&w(c,d)||w(a,d)&&w(c,b))||v(a,b,c)>0!=v(a,b,d)>0&&v(c,d,a)>0!=v(c,d,b)>0}function y(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&x(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}function z(a,b){return v(a.prev,a,a.next)<0?v(a,b,a.next)>=0&&v(a,a.prev,b)>=0:v(a,b,a.prev)<0||v(a,a.next,b)<0}function A(a,b){var c=a,d=!1,e=(a.x+b.x)/2,f=(a.y+b.y)/2;do{c.y>f!=c.next.y>f&&e<(c.next.x-c.x)*(f-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==a);return d}function B(a,b){var c=new E(a.i,a.x,a.y),d=new E(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function C(a,b,c,d){var e=new E(a,b,c);return d?(e.next=d.next,e.prev=d,d.next.prev=e,d.next=e):(e.prev=e,e.next=e),e}function D(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function E(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function F(a,b,c,d){for(var e=0,f=b,g=c-d;f<c;f+=d)e+=(a[g]-a[f])*(a[f+1]+a[g+1]),g=f;return e}b.exports=d,d.deviation=function(a,b,c,d){var e=b&&b.length,f=e?b[0]*c:a.length,g=Math.abs(F(a,0,f,c));if(e)for(var h=0,i=b.length;h<i;h++){var j=b[h]*c,k=h<i-1?b[h+1]*c:a.length;g-=Math.abs(F(a,j,k,c))}var l=0;for(h=0;h<d.length;h+=3){var m=d[h]*c,n=d[h+1]*c,o=d[h+2]*c;l+=Math.abs((a[m]-a[o])*(a[n+1]-a[m+1])-(a[m]-a[n])*(a[o+1]-a[m+1]))}return 0===g&&0===l?0:Math.abs((l-g)/g)},d.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);e>0&&(d+=a[e-1].length,c.holes.push(d))}return c}},{}],8:[function(a,b,c){function d(a){var b,c,e,j,k,l;switch(typeof a){case"object":if(null===a)return null;if(f(a)){for(e="[",c=a.length-1,b=0;b<c;b++)e+=d(a[b])+",";return c>-1&&(e+=d(a[b])),e+"]"}for(j=g(a).sort(),c=j.length,e="{",k=j[b=0],l=c>0&&void 0!==a[k];b<c;)l?(e+='"'+k.replace(h,i)+'":'+d(a[k]),k=j[++b],(l=b<c&&void 0!==a[k])&&(e+=",")):(k=j[++b],l=b<c&&void 0!==a[k]);return e+"}";case"undefined":return null;case"string":return'"'+a.replace(h,i)+'"';default:return a}}var e={}.toString,f=Array.isArray||function(a){return"[object Array]"===e.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},h=/[\u0000-\u001f"\\]/g,i=function(a){var b=a.charCodeAt(0);switch(b){case 34:return'\\"';case 92:return"\\\\";case 12:return"\\f";case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 8:return"\\b";default:return b>15?"\\u00"+b.toString(16):"\\u000"+b.toString(16)}};b.exports=function(a){if(void 0!==a)return""+d(a)},b.exports.stringSearch=h,b.exports.stringReplace=i},{}],9:[function(a,b,c){function d(a){if("Polygon"===a.type)return e(a.coordinates);if("MultiPolygon"===a.type){for(var b=0,c=0;c<a.coordinates.length;c++)b+=e(a.coordinates[c]);return b}return null}function e(a){var b=0;if(a&&a.length>0){b+=Math.abs(f(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(f(a[c]))}return b}function f(a){var b=0;if(a.length>2){for(var c,d,e=0;e<a.length-1;e++)c=a[e],d=a[e+1],b+=g(d[0]-c[0])*(2+Math.sin(g(c[1]))+Math.sin(g(d[1])));b=b*h.RADIUS*h.RADIUS/2}return b}function g(a){return a*Math.PI/180}var h=a("wgs84");b.exports.geometry=d,b.exports.ring=f},{wgs84:52}],10:[function(a,b,c){function d(a,b){switch(a&&a.type||null){case"FeatureCollection":return a.features=a.features.map(e(d,b)),a;case"Feature":return a.geometry=d(a.geometry,b),a;case"Polygon":case"MultiPolygon":return f(a,b);default:return a}}function e(a,b){return function(c){return a(c,b)}}function f(a,b){return"Polygon"===a.type?a.coordinates=g(a.coordinates,b):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(e(g,b))),a}function g(a,b){b=!!b,a[0]=h(a[0],!b);for(var c=1;c<a.length;c++)a[c]=h(a[c],b);return a}function h(a,b){return i(a)===b?a:a.reverse()}function i(a){return j.ring(a)>=0}var j=a("geojson-area");b.exports=d},{"geojson-area":9}],11:[function(a,b,c){"use strict";function d(a,b,c,d,g,i,j,k){if(c/=b,d/=b,j>=c&&k<=d)return a;if(j>d||k<c)return null;for(var l=[],m=0;m<a.length;m++){var n,o,p=a[m],q=p.geometry,r=p.type;if(n=p.min[g],o=p.max[g],n>=c&&o<=d)l.push(p);else if(!(n>d||o<c)){var s=1===r?e(q,c,d,g):f(q,c,d,g,i,3===r);s.length&&l.push(h(p.tags,r,s,p.id))}}return l.length?l:null}function e(a,b,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=g[d];h>=b&&h<=c&&e.push(g)}return e}function f(a,b,c,d,e,f){for(var h=[],i=0;i<a.length;i++){var j,k,l,m=0,n=0,o=null,p=a[i],q=p.area,r=p.dist,s=p.outer,t=p.length,u=[];for(k=0;k<t-1;k++)j=o||p[k],o=p[k+1],m=n||j[d],n=o[d],m<b?n>c?(u.push(e(j,o,b),e(j,o,c)),f||(u=g(h,u,q,r,s))):n>=b&&u.push(e(j,o,b)):m>c?n<b?(u.push(e(j,o,c),e(j,o,b)),f||(u=g(h,u,q,r,s))):n<=c&&u.push(e(j,o,c)):(u.push(j),n<b?(u.push(e(j,o,b)),f||(u=g(h,u,q,r,s))):n>c&&(u.push(e(j,o,c)),f||(u=g(h,u,q,r,s))));j=p[t-1],m=j[d],m>=b&&m<=c&&u.push(j),l=u[u.length-1],f&&l&&(u[0][0]!==l[0]||u[0][1]!==l[1])&&u.push(u[0]),g(h,u,q,r,s)}return h}function g(a,b,c,d,e){return b.length&&(b.area=c,b.dist=d,void 0!==e&&(b.outer=e),a.push(b)),[]}b.exports=d;var h=a("./feature")},{"./feature":13}],12:[function(a,b,c){"use strict";function d(a,b){var c=[];if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)e(c,a.features[d],b);else"Feature"===a.type?e(c,a,b):e(c,{geometry:a},b);return c}function e(a,b,c){if(null!==b.geometry){var d,h,i,k,l=b.geometry,m=l.type,n=l.coordinates,o=b.properties,p=b.id;if("Point"===m)a.push(j(o,1,[g(n)],p));else if("MultiPoint"===m)a.push(j(o,1,f(n),p));else if("LineString"===m)a.push(j(o,2,[f(n,c)],p));else if("MultiLineString"===m||"Polygon"===m){for(i=[],d=0;d<n.length;d++)k=f(n[d],c),"Polygon"===m&&(k.outer=0===d),i.push(k);a.push(j(o,"Polygon"===m?3:2,i,p))}else if("MultiPolygon"===m){for(i=[],d=0;d<n.length;d++)for(h=0;h<n[d].length;h++)k=f(n[d][h],c),k.outer=0===h,i.push(k);a.push(j(o,3,i,p))}else{if("GeometryCollection"!==m)throw new Error("Input data is not a valid GeoJSON object.");for(d=0;d<l.geometries.length;d++)e(a,{geometry:l.geometries[d],properties:o},c)}}}function f(a,b){for(var c=[],d=0;d<a.length;d++)c.push(g(a[d]));return b&&(i(c,b),h(c)),c}function g(a){var b=Math.sin(a[1]*Math.PI/180),c=a[0]/360+.5,d=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return d=d<0?0:d>1?1:d,[c,d,0]}function h(a){for(var b,c,d=0,e=0,f=0;f<a.length-1;f++)b=c||a[f],c=a[f+1],d+=b[0]*c[1]-c[0]*b[1],e+=Math.abs(c[0]-b[0])+Math.abs(c[1]-b[1]);a.area=Math.abs(d/2),a.dist=e}b.exports=d;var i=a("./simplify"),j=a("./feature")},{"./feature":13,"./simplify":15}],13:[function(a,b,c){"use strict";function d(a,b,c,d){var f={id:d||null,type:b,geometry:c,tags:a||null,min:[1/0,1/0],max:[-1/0,-1/0]};return e(f),f}function e(a){var b=a.geometry,c=a.min,d=a.max;if(1===a.type)f(c,d,b);else for(var e=0;e<b.length;e++)f(c,d,b[e]);return a}function f(a,b,c){for(var d,e=0;e<c.length;e++)d=c[e],a[0]=Math.min(d[0],a[0]),b[0]=Math.max(d[0],b[0]),a[1]=Math.min(d[1],a[1]),b[1]=Math.max(d[1],b[1])}b.exports=d},{}],14:[function(a,b,c){"use strict";function d(a,b){return new e(a,b)}function e(a,b){b=this.options=i(Object.create(this.options),b);var c=b.debug;c&&console.time("preprocess data");var d=1<<b.maxZoom,e=k(a,b.tolerance/(d*b.extent));this.tiles={},this.tileCoords=[],c&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",b.indexMaxZoom,b.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),e=n(e,b.buffer/b.extent,g),e.length&&this.splitTile(e,0,0,0),c&&(e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function f(a,b,c){return 32*((1<<a)*c+b)+a}function g(a,b,c){return[c,(c-a[0])*(b[1]-a[1])/(b[0]-a[0])+a[1],1]}function h(a,b,c){return[(c-a[1])*(b[0]-a[0])/(b[1]-a[1])+a[0],c,1]}function i(a,b){for(var c in b)a[c]=b[c];return a}function j(a,b,c){var d=a.source;if(1!==d.length)return!1;var e=d[0];if(3!==e.type||e.geometry.length>1)return!1;var f=e.geometry[0].length;if(5!==f)return!1;for(var g=0;g<f;g++){var h=l.point(e.geometry[0][g],b,a.z2,a.x,a.y);if(h[0]!==-c&&h[0]!==b+c||h[1]!==-c&&h[1]!==b+c)return!1}return!0}b.exports=d;var k=a("./convert"),l=a("./transform"),m=a("./clip"),n=a("./wrap"),o=a("./tile");e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0},e.prototype.splitTile=function(a,b,c,d,e,i,k){for(var l=[a,b,c,d],n=this.options,p=n.debug,q=null;l.length;){d=l.pop(),c=l.pop(),b=l.pop(),a=l.pop();var r=1<<b,s=f(b,c,d),t=this.tiles[s],u=b===n.maxZoom?0:n.tolerance/(r*n.extent);if(!t&&(p>1&&console.time("creation"),t=this.tiles[s]=o(a,r,c,d,u,b===n.maxZoom),this.tileCoords.push({z:b,x:c,y:d}),p)){p>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",b,c,d,t.numFeatures,t.numPoints,t.numSimplified),console.timeEnd("creation"));var v="z"+b;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(t.source=a,e){if(b===n.maxZoom||b===e)continue;var w=1<<e-b;if(c!==Math.floor(i/w)||d!==Math.floor(k/w))continue}else if(b===n.indexMaxZoom||t.numPoints<=n.indexMaxPoints)continue;if(n.solidChildren||!j(t,n.extent,n.buffer)){t.source=null,p>1&&console.time("clipping");var x,y,z,A,B,C,D=.5*n.buffer/n.extent,E=.5-D,F=.5+D,G=1+D;x=y=z=A=null,B=m(a,r,c-D,c+F,0,g,t.min[0],t.max[0]),C=m(a,r,c+E,c+G,0,g,t.min[0],t.max[0]),B&&(x=m(B,r,d-D,d+F,1,h,t.min[1],t.max[1]),y=m(B,r,d+E,d+G,1,h,t.min[1],t.max[1])),C&&(z=m(C,r,d-D,d+F,1,h,t.min[1],t.max[1]),A=m(C,r,d+E,d+G,1,h,t.min[1],t.max[1])),p>1&&console.timeEnd("clipping"),a.length&&(l.push(x||[],b+1,2*c,2*d),l.push(y||[],b+1,2*c,2*d+1),l.push(z||[],b+1,2*c+1,2*d),l.push(A||[],b+1,2*c+1,2*d+1))}else e&&(q=b)}return q},e.prototype.getTile=function(a,b,c){var d=this.options,e=d.extent,g=d.debug,h=1<<a;b=(b%h+h)%h;var i=f(a,b,c);if(this.tiles[i])return l.tile(this.tiles[i],e);g>1&&console.log("drilling down to z%d-%d-%d",a,b,c);for(var k,m=a,n=b,o=c;!k&&m>0;)m--,n=Math.floor(n/2),o=Math.floor(o/2),k=this.tiles[f(m,n,o)];if(!k||!k.source)return null;if(g>1&&console.log("found parent tile z%d-%d-%d",m,n,o),j(k,e,d.buffer))return l.tile(k,e);g>1&&console.time("drilling down");var p=this.splitTile(k.source,m,n,o,a,b,c);if(g>1&&console.timeEnd("drilling down"),null!==p){var q=1<<a-p;i=f(p,Math.floor(b/q),Math.floor(c/q))}return this.tiles[i]?l.tile(this.tiles[i],e):null}},{"./clip":11,"./convert":12,"./tile":16,"./transform":17,"./wrap":18}],
15:[function(a,b,c){"use strict";function d(a,b){var c,d,f,g,h=b*b,i=a.length,j=0,k=i-1,l=[];for(a[j][2]=1,a[k][2]=1;k;){for(d=0,c=j+1;c<k;c++)(f=e(a[c],a[j],a[k]))>d&&(g=c,d=f);d>h?(a[g][2]=d,l.push(j),l.push(g),j=g):(k=l.pop(),j=l.pop())}}function e(a,b,c){var d=b[0],e=b[1],f=c[0],g=c[1],h=a[0],i=a[1],j=f-d,k=g-e;if(0!==j||0!==k){var l=((h-d)*j+(i-e)*k)/(j*j+k*k);l>1?(d=f,e=g):l>0&&(d+=j*l,e+=k*l)}return j=h-d,k=i-e,j*j+k*k}b.exports=d},{}],16:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){for(var h={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:c,y:d,z2:b,transformed:!1,min:[2,1],max:[-1,0]},i=0;i<a.length;i++){h.numFeatures++,e(h,a[i],f,g);var j=a[i].min,k=a[i].max;j[0]<h.min[0]&&(h.min[0]=j[0]),j[1]<h.min[1]&&(h.min[1]=j[1]),k[0]>h.max[0]&&(h.max[0]=k[0]),k[1]>h.max[1]&&(h.max[1]=k[1])}return h}function e(a,b,c,d){var e,g,h,i,j=b.geometry,k=b.type,l=[],m=c*c;if(1===k)for(e=0;e<j.length;e++)l.push(j[e]),a.numPoints++,a.numSimplified++;else for(e=0;e<j.length;e++)if(h=j[e],d||!(2===k&&h.dist<c||3===k&&h.area<m)){var n=[];for(g=0;g<h.length;g++)i=h[g],(d||i[2]>m)&&(n.push(i),a.numSimplified++),a.numPoints++;3===k&&f(n,h.outer),l.push(n)}else a.numPoints+=h.length;if(l.length){var o={geometry:l,type:k,tags:b.tags||null};null!==b.id&&(o.id=b.id),a.features.push(o)}}function f(a,b){g(a)<0===b&&a.reverse()}function g(a){for(var b,c,d=0,e=0,f=a.length,g=f-1;e<f;g=e++)b=a[e],c=a[g],d+=(c[0]-b[0])*(b[1]+c[1]);return d}b.exports=d},{}],17:[function(a,b,c){"use strict";function d(a,b){if(a.transformed)return a;var c,d,f,g=a.z2,h=a.x,i=a.y;for(c=0;c<a.features.length;c++){var j=a.features[c],k=j.geometry;if(1===j.type)for(d=0;d<k.length;d++)k[d]=e(k[d],b,g,h,i);else for(d=0;d<k.length;d++){var l=k[d];for(f=0;f<l.length;f++)l[f]=e(l[f],b,g,h,i)}}return a.transformed=!0,a}function e(a,b,c,d,e){return[Math.round(b*(a[0]*c-d)),Math.round(b*(a[1]*c-e))]}c.tile=d,c.point=e},{}],18:[function(a,b,c){"use strict";function d(a,b,c){var d=a,f=g(a,1,-1-b,b,0,c,-1,2),h=g(a,1,1-b,2+b,0,c,-1,2);return(f||h)&&(d=g(a,1,-b,1+b,0,c,-1,2)||[],f&&(d=e(f,1).concat(d)),h&&(d=d.concat(e(h,-1)))),d}function e(a,b){for(var c=[],d=0;d<a.length;d++){var e,g=a[d],i=g.type;if(1===i)e=f(g.geometry,b);else{e=[];for(var j=0;j<g.geometry.length;j++)e.push(f(g.geometry[j],b))}c.push(h(g.tags,i,e,g.id))}return c}function f(a,b){var c=[];c.area=a.area,c.dist=a.dist;for(var d=0;d<a.length;d++)c.push([a[d][0]+b,a[d][1],a[d][2]]);return c}var g=a("./clip"),h=a("./feature");b.exports=d},{"./clip":11,"./feature":13}],19:[function(a,b,c){"use strict";function d(a,b,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var f=new Int32Array(this.arrayBuffer);a=f[0],b=f[1],c=f[2],this.d=b+2*c;for(var g=0;g<this.d*this.d;g++){var h=f[e+g],i=f[e+g+1];d.push(h===i?null:f.subarray(h,i))}var j=f[e+d.length],k=f[e+d.length+1];this.keys=f.subarray(j,k),this.bboxes=f.subarray(k),this.insert=this._insertReadonly}else{this.d=b+2*c;for(var l=0;l<this.d*this.d;l++)d.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=a,this.padding=c,this.scale=b/a,this.uid=0;var m=c/b*a;this.min=-m,this.max=a+m}b.exports=d;var e=3;d.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},d.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},d.prototype._insertCell=function(a,b,c,d,e,f){this.cells[e].push(f)},d.prototype.query=function(a,b,c,d){var e=this.min,f=this.max;if(a<=e&&b<=e&&f<=c&&f<=d)return Array.prototype.slice.call(this.keys);var g=[],h={};return this._forEachCell(a,b,c,d,this._queryCell,g,h),g},d.prototype._queryCell=function(a,b,c,d,e,f,g){var h=this.cells[e];if(null!==h)for(var i=this.keys,j=this.bboxes,k=0;k<h.length;k++){var l=h[k];if(void 0===g[l]){var m=4*l;a<=j[m+2]&&b<=j[m+3]&&c>=j[m+0]&&d>=j[m+1]?(g[l]=!0,f.push(i[l])):g[l]=!1}}},d.prototype._forEachCell=function(a,b,c,d,e,f,g){for(var h=this._convertToCellCoord(a),i=this._convertToCellCoord(b),j=this._convertToCellCoord(c),k=this._convertToCellCoord(d),l=h;l<=j;l++)for(var m=i;m<=k;m++){var n=this.d*m+l;if(e.call(this,a,b,c,d,n,f,g))return}},d.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},d.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,b=e+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var f=new Int32Array(b+c+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=b,h=0;h<a.length;h++){var i=a[h];f[e+h]=g,f.set(i,g),g+=i.length}return f[e+a.length]=g,f.set(this.keys,g),g+=this.keys.length,f[e+a.length+1]=g,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer}},{}],20:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],21:[function(a,b,c){"use strict";function d(a,b,c,d,f){return new e(a,b,c,d,f)}function e(a,b,c,d,e){b=b||f,c=c||g,e=e||Array,this.nodeSize=d||64,this.points=a,this.ids=new e(a.length),this.coords=new e(2*a.length);for(var i=0;i<a.length;i++)this.ids[i]=i,this.coords[2*i]=b(a[i]),this.coords[2*i+1]=c(a[i]);h(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function f(a){return a[0]}function g(a){return a[1]}var h=a("./sort"),i=a("./range"),j=a("./within");b.exports=d,e.prototype={range:function(a,b,c,d){return i(this.ids,this.coords,a,b,c,d,this.nodeSize)},within:function(a,b,c){return j(this.ids,this.coords,a,b,c,this.nodeSize)}}},{"./range":22,"./sort":23,"./within":24}],22:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){for(var h,i,j=[0,a.length-1,0],k=[];j.length;){var l=j.pop(),m=j.pop(),n=j.pop();if(m-n<=g)for(var o=n;o<=m;o++)h=b[2*o],i=b[2*o+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[o]);else{var p=Math.floor((n+m)/2);h=b[2*p],i=b[2*p+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[p]);var q=(l+1)%2;(0===l?c<=h:d<=i)&&(j.push(n),j.push(p-1),j.push(q)),(0===l?e>=h:f>=i)&&(j.push(p+1),j.push(m),j.push(q))}}return k}b.exports=d},{}],23:[function(a,b,c){"use strict";function d(a,b,c,f,g,h){if(!(g-f<=c)){var i=Math.floor((f+g)/2);e(a,b,i,f,g,h%2),d(a,b,c,f,i-1,h+1),d(a,b,c,i+1,g,h+1)}}function e(a,b,c,d,g,h){for(;g>d;){if(g-d>600){var i=g-d+1,j=c-d+1,k=Math.log(i),l=.5*Math.exp(2*k/3),m=.5*Math.sqrt(k*l*(i-l)/i)*(j-i/2<0?-1:1);e(a,b,c,Math.max(d,Math.floor(c-j*l/i+m)),Math.min(g,Math.floor(c+(i-j)*l/i+m)),h)}var n=b[2*c+h],o=d,p=g;for(f(a,b,d,c),b[2*g+h]>n&&f(a,b,d,g);o<p;){for(f(a,b,o,p),o++,p--;b[2*o+h]<n;)o++;for(;b[2*p+h]>n;)p--}b[2*d+h]===n?f(a,b,d,p):(p++,f(a,b,p,g)),p<=c&&(d=p+1),c<=p&&(g=p-1)}}function f(a,b,c,d){g(a,c,d),g(b,2*c,2*d),g(b,2*c+1,2*d+1)}function g(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}b.exports=d},{}],24:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){for(var h=[0,a.length-1,0],i=[],j=f*f;h.length;){var k=h.pop(),l=h.pop(),m=h.pop();if(l-m<=g)for(var n=m;n<=l;n++)e(b[2*n],b[2*n+1],c,d)<=j&&i.push(a[n]);else{var o=Math.floor((m+l)/2),p=b[2*o],q=b[2*o+1];e(p,q,c,d)<=j&&i.push(a[o]);var r=(k+1)%2;(0===k?c-f<=p:d-f<=q)&&(h.push(m),h.push(o-1),h.push(r)),(0===k?c+f>=p:d+f>=q)&&(h.push(o+1),h.push(l),h.push(r))}}return i}function e(a,b,c,d){var e=a-c,f=b-d;return e*e+f*f}b.exports=d},{}],25:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}function e(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function f(a,b,c,e,h,i){return a===b||(null==a||null==b||!k(a)&&!d(b)?a!==a&&b!==b:g(a,b,f,c,e,h,i))}function g(a,b,c,d,e,f,g){var k=l(a),n=l(b),q=p,r=p;k||(q=z.call(a),q==o?q=u:q!=u&&(k=m(a))),n||(r=z.call(b),r==o?r=u:r!=u&&(n=m(b)));var s=q==u,t=r==u,v=q==r;if(v&&!k&&!s)return i(a,b,q);if(!e){var w=s&&y.call(a,"__wrapped__"),x=t&&y.call(b,"__wrapped__");if(w||x)return c(w?a.value():a,x?b.value():b,d,e,f,g)}if(!v)return!1;f||(f=[]),g||(g=[]);for(var A=f.length;A--;)if(f[A]==a)return g[A]==b;f.push(a),g.push(b);var B=(k?h:j)(a,b,c,d,e,f,g);return f.pop(),g.pop(),B}function h(a,b,c,d,f,g,h){var i=-1,j=a.length,k=b.length;if(j!=k&&!(f&&k>j))return!1;for(;++i<j;){var l=a[i],m=b[i],n=d?d(f?m:l,f?l:m,i):void 0;if(void 0!==n){if(n)continue;return!1}if(f){if(!e(b,function(a){return l===a||c(l,a,d,f,g,h)}))return!1}else if(l!==m&&!c(l,m,d,f,g,h))return!1}return!0}function i(a,b,c){switch(c){case q:case r:return+a==+b;case s:return a.name==b.name&&a.message==b.message;case t:return a!=+a?b!=+b:a==+b;case v:case w:return a==b+""}return!1}function j(a,b,c,d,e,f,g){var h=n(a),i=h.length;if(i!=n(b).length&&!e)return!1;for(var j=i;j--;){var k=h[j];if(!(e?k in b:y.call(b,k)))return!1}for(var l=e;++j<i;){k=h[j];var m=a[k],o=b[k],p=d?d(e?o:m,e?m:o,k):void 0;if(!(void 0===p?c(m,o,d,e,f,g):p))return!1;l||(l="constructor"==k)}if(!l){var q=a.constructor,r=b.constructor;if(q!=r&&"constructor"in a&&"constructor"in b&&!("function"==typeof q&&q instanceof q&&"function"==typeof r&&r instanceof r))return!1}return!0}function k(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}var l=a("lodash.isarray"),m=a("lodash.istypedarray"),n=a("lodash.keys"),o="[object Arguments]",p="[object Array]",q="[object Boolean]",r="[object Date]",s="[object Error]",t="[object Number]",u="[object Object]",v="[object RegExp]",w="[object String]",x=Object.prototype,y=x.hasOwnProperty,z=x.toString;b.exports=f},{"lodash.isarray":29,"lodash.istypedarray":31,"lodash.keys":32}],26:[function(a,b,c){function d(a,b,c){if("function"!=typeof a)return e;if(void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function e(a){return a}b.exports=d},{}],27:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}function e(a,b){var c=null==a?void 0:a[b];return h(c)?c:void 0}function f(a){return g(a)&&n.call(a)==i}function g(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function h(a){return null!=a&&(f(a)?o.test(l.call(a)):d(a)&&j.test(a))}var i="[object Function]",j=/^\[object .+?Constructor\]$/,k=Object.prototype,l=Function.prototype.toString,m=k.hasOwnProperty,n=k.toString,o=RegExp("^"+l.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=e},{}],28:[function(a,b,c){function d(a){return f(a)&&p.call(a,"callee")&&(!r.call(a,"callee")||q.call(a)==l)}function e(a){return null!=a&&h(a.length)&&!g(a)}function f(a){return j(a)&&e(a)}function g(a){var b=i(a)?q.call(a):"";return b==m||b==n}function h(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=k}function i(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function j(a){return!!a&&"object"==typeof a}var k=9007199254740991,l="[object Arguments]",m="[object Function]",n="[object GeneratorFunction]",o=Object.prototype,p=o.hasOwnProperty,q=o.toString,r=o.propertyIsEnumerable;b.exports=d},{}],29:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}function e(a,b){var c=null==a?void 0:a[b];return i(c)?c:void 0}function f(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=s}function g(a){return h(a)&&p.call(a)==k}function h(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function i(a){return null!=a&&(g(a)?q.test(n.call(a)):d(a)&&l.test(a))}var j="[object Array]",k="[object Function]",l=/^\[object .+?Constructor\]$/,m=Object.prototype,n=Function.prototype.toString,o=m.hasOwnProperty,p=m.toString,q=RegExp("^"+n.call(o).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),r=e(Array,"isArray"),s=9007199254740991,t=r||function(a){return d(a)&&f(a.length)&&p.call(a)==j};b.exports=t},{}],30:[function(a,b,c){function d(a,b,c,d){c="function"==typeof c?f(c,d,3):void 0;var g=c?c(a,b):void 0;return void 0===g?e(a,b,c):!!g}var e=a("lodash._baseisequal"),f=a("lodash._bindcallback");b.exports=d},{"lodash._baseisequal":25,"lodash._bindcallback":26}],31:[function(a,b,c){function d(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=g}function e(a){return!!a&&"object"==typeof a}function f(a){return e(a)&&d(a.length)&&!!h[j.call(a)]}var g=9007199254740991,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h["[object Arguments]"]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h["[object Map]"]=h["[object Number]"]=h["[object Object]"]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1;var i=Object.prototype,j=i.toString;b.exports=f},{}],32:[function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}function e(a){return null!=a&&g(s(a))}function f(a,b){return a="number"==typeof a||n.test(a)?+a:-1,b=null==b?r:b,a>-1&&a%1==0&&a<b}function g(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=r}function h(a){for(var b=j(a),c=b.length,d=c&&a.length,e=!!d&&g(d)&&(m(a)||l(a)),h=-1,i=[];++h<c;){var k=b[h];(e&&f(k,d)||p.call(a,k))&&i.push(k)}return i}function i(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function j(a){if(null==a)return[];i(a)||(a=Object(a));var b=a.length;b=b&&g(b)&&(m(a)||l(a))&&b||0;for(var c=a.constructor,d=-1,e="function"==typeof c&&c.prototype===a,h=Array(b),j=b>0;++d<b;)h[d]=d+"";for(var k in a)j&&f(k,b)||"constructor"==k&&(e||!p.call(a,k))||h.push(k);return h}var k=a("lodash._getnative"),l=a("lodash.isarguments"),m=a("lodash.isarray"),n=/^\d+$/,o=Object.prototype,p=o.hasOwnProperty,q=k(Object,"keys"),r=9007199254740991,s=d("length"),t=q?function(a){var b=null==a?void 0:a.constructor;return"function"==typeof b&&b.prototype===a||"function"!=typeof a&&e(a)?h(a):i(a)?q(a):[]}:h;b.exports=t},{"lodash._getnative":27,"lodash.isarguments":28,"lodash.isarray":29}],33:[function(a,b,c){"use strict";function d(a){return!!(e()&&f()&&g()&&h()&&i()&&j()&&k()&&l(a&&a.failIfMajorPerformanceCaveat))}function e(){return"undefined"!=typeof window&&"undefined"!=typeof document}function f(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function g(){return Function.prototype&&Function.prototype.bind}function h(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function i(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function j(){return"Worker"in window}function k(){return"Uint8ClampedArray"in window}function l(a){return void 0===n[a]&&(n[a]=m(a)),n[a]}function m(a){var b=document.createElement("canvas"),c=Object.create(d.webGLContextAttributes);return c.failIfMajorPerformanceCaveat=a,b.probablySupportsContext?b.probablySupportsContext("webgl",c)||b.probablySupportsContext("experimental-webgl",c):b.supportsContext?b.supportsContext("webgl",c)||b.supportsContext("experimental-webgl",c):b.getContext("webgl",c)||b.getContext("experimental-webgl",c)}void 0!==b&&b.exports?b.exports=d:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=d);var n={};d.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],34:[function(a,b,c){"use strict";function d(a){var b;a&&a.length&&(b=a,a=b.length);var c=new Uint8Array(a||0);return b&&c.set(b),c.readUInt32LE=f.readUInt32LE,c.writeUInt32LE=f.writeUInt32LE,c.readInt32LE=f.readInt32LE,c.writeInt32LE=f.writeInt32LE,c.readFloatLE=f.readFloatLE,c.writeFloatLE=f.writeFloatLE,c.readDoubleLE=f.readDoubleLE,c.writeDoubleLE=f.writeDoubleLE,c.toString=f.toString,c.write=f.write,c.slice=f.slice,c.copy=f.copy,c._isBuffer=!0,c}function e(a){for(var b,c,d=a.length,e=[],f=0;f<d;f++){if((b=a.charCodeAt(f))>55295&&b<57344){if(!c){b>56319||f+1===d?e.push(239,191,189):c=b;continue}if(b<56320){e.push(239,191,189),c=b;continue}b=c-55296<<10|b-56320|65536,c=null}else c&&(e.push(239,191,189),c=null);b<128?e.push(b):b<2048?e.push(b>>6|192,63&b|128):b<65536?e.push(b>>12|224,b>>6&63|128,63&b|128):e.push(b>>18|240,b>>12&63|128,b>>6&63|128,63&b|128)}return e}b.exports=d;var f,g,h,i=a("ieee754");f={readUInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},writeUInt32LE:function(a,b){this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24},readInt32LE:function(a){return(this[a]|this[a+1]<<8|this[a+2]<<16)+(this[a+3]<<24)},readFloatLE:function(a){return i.read(this,a,!0,23,4)},readDoubleLE:function(a){return i.read(this,a,!0,52,8)},writeFloatLE:function(a,b){return i.write(this,a,b,!0,23,4)},writeDoubleLE:function(a,b){return i.write(this,a,b,!0,52,8)},toString:function(a,b,c){var d="",e="";b=b||0,c=Math.min(this.length,c||this.length);for(var f=b;f<c;f++){var g=this[f];g<=127?(d+=decodeURIComponent(e)+String.fromCharCode(g),e=""):e+="%"+g.toString(16)}return d+=decodeURIComponent(e)},write:function(a,b){for(var c=a===g?h:e(a),d=0;d<c.length;d++)this[b+d]=c[d]},slice:function(a,b){return this.subarray(a,b)},copy:function(a,b){b=b||0;for(var c=0;c<this.length;c++)a[b+c]=this[c]}},f.writeInt32LE=f.writeUInt32LE,d.byteLength=function(a){return g=a,h=e(a),h.length},d.isBuffer=function(a){return!(!a||!a._isBuffer)}},{ieee754:20}],35:[function(a,b,c){(function(c){"use strict";function d(a){this.buf=q.isBuffer(a)?a:new q(a||0),this.pos=0,this.length=this.buf.length}function e(a,b){var c,d=b.buf;if(c=d[b.pos++],a+=268435456*(127&c),c<128)return a;if(c=d[b.pos++],a+=34359738368*(127&c),c<128)return a;if(c=d[b.pos++],a+=4398046511104*(127&c),c<128)return a;if(c=d[b.pos++],a+=562949953421312*(127&c),c<128)return a;if(c=d[b.pos++],a+=72057594037927940*(127&c),c<128)return a;if(c=d[b.pos++],a+=0x8000000000000000*(127&c),c<128)return a;throw new Error("Expected varint not more than 10 bytes")}function f(a,b){b.realloc(10);for(var c=b.pos+10;a>=1;){if(b.pos>=c)throw new Error("Given varint doesn't fit into 10 bytes");var d=255&a;b.buf[b.pos++]=d|(a>=128?128:0),a/=128}}function g(a,b,c){var d=b<=16383?1:b<=2097151?2:b<=268435455?3:Math.ceil(Math.log(b)/(7*Math.LN2));c.realloc(d);for(var e=c.pos-1;e>=a;e--)c.buf[e+d]=c.buf[e]}function h(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function i(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function j(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function k(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function l(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function m(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function n(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function o(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function p(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}b.exports=d;var q=c.Buffer||a("./buffer");d.Varint=0,d.Fixed64=1,d.Bytes=2,d.Fixed32=5;var r=4294967296,s=1/r,t=Math.pow(2,63);d.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=this.buf.readUInt32LE(this.pos);return this.pos+=4,a},readSFixed32:function(){var a=this.buf.readInt32LE(this.pos);return this.pos+=4,a},readFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readUInt32LE(this.pos+4)*r;return this.pos+=8,a},readSFixed64:function(){var a=this.buf.readUInt32LE(this.pos)+this.buf.readInt32LE(this.pos+4)*r;return this.pos+=8,a},readFloat:function(){var a=this.buf.readFloatLE(this.pos);return this.pos+=4,a},readDouble:function(){var a=this.buf.readDoubleLE(this.pos);return this.pos+=8,a},readVarint:function(){var a,b,c=this.buf;return b=c[this.pos++],a=127&b,b<128?a:(b=c[this.pos++],a|=(127&b)<<7,b<128?a:(b=c[this.pos++],a|=(127&b)<<14,b<128?a:(b=c[this.pos++],a|=(127&b)<<21,b<128?a:e(a,this))))},readVarint64:function(){var a=this.pos,b=this.readVarint();if(b<t)return b;for(var c=this.pos-2;255===this.buf[c];)c--;c<a&&(c=a),b=0;for(var d=0;d<c-a+1;d++){var e=127&~this.buf[a+d];b+=d<4?e<<7*d:e*Math.pow(2,7*d)}return-b-1},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=this.buf.toString("utf8",this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.slice(this.pos,a);return this.pos=a,b},readPackedVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readVarint());return b},readPackedSVarint:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSVarint());return b},readPackedBoolean:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readBoolean());return b},readPackedFloat:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFloat());return b},readPackedDouble:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readDouble());return b},readPackedFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed32());return b},readPackedSFixed32:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed32());return b},readPackedFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readFixed64());return b},readPackedSFixed64:function(){for(var a=this.readVarint()+this.pos,b=[];this.pos<a;)b.push(this.readSFixed64());return b},skip:function(a){var b=7&a;if(b===d.Varint)for(;this.buf[this.pos++]>127;);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else{if(b!==d.Fixed64)throw new Error("Unimplemented type: "+b);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){var c=new q(b);this.buf.copy(c),this.buf=c,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.slice(0,this.length)},writeFixed32:function(a){this.realloc(4),this.buf.writeUInt32LE(a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),this.buf.writeInt32LE(a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeUInt32LE(Math.floor(a*s),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),this.buf.writeInt32LE(-1&a,this.pos),this.buf.writeInt32LE(Math.floor(a*s),this.pos+4),this.pos+=8},writeVarint:function(a){if((a=+a)>268435455)return void f(a,this);this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127)))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a);var b=q.byteLength(a);this.writeVarint(b),this.realloc(b),this.buf.write(a,this.pos),this.pos+=b},writeFloat:function(a){this.realloc(4),this.buf.writeFloatLE(a,this.pos),this.pos+=4},writeDouble:function(a){this.realloc(8),this.buf.writeDoubleLE(a,this.pos),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);var d=this.pos-c;d>=128&&g(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,b,c){this.writeTag(a,d.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){this.writeMessage(a,h,b)},writePackedSVarint:function(a,b){this.writeMessage(a,i,b)},writePackedBoolean:function(a,b){this.writeMessage(a,l,b)},writePackedFloat:function(a,b){this.writeMessage(a,j,b)},writePackedDouble:function(a,b){this.writeMessage(a,k,b)},writePackedFixed32:function(a,b){this.writeMessage(a,m,b)},writePackedSFixed32:function(a,b){this.writeMessage(a,n,b)},writePackedFixed64:function(a,b){this.writeMessage(a,o,b)},writePackedSFixed64:function(a,b){this.writeMessage(a,p,b)},writeBytesField:function(a,b){this.writeTag(a,d.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,d.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,d.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,d.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,d.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,d.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,d.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./buffer":34}],36:[function(a,b,c){"use strict";function d(a,b){this.x=a,this.y=b}b.exports=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a}},{}],37:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){q&&o&&(q=!1,o.length?p=o.concat(p):r=-1,p.length&&i())}function i(){if(!q){var a=f(h);q=!0;for(var b=p.length;b;){for(o=p,p=[];++r<b;)o&&o[r].run();r=-1,b=p.length}o=null,q=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}();var o,p=[],q=!1,r=-1;n.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];p.push(new j(a,b)),1!==p.length||q||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=k,n.addListener=k,n.once=k,n.off=k,n.removeListener=k,n.removeAllListeners=k,n.emit=k,n.prependListener=k,n.prependOnceListener=k,n.listeners=function(a){return[]},n.binding=function(a){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(a){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],38:[function(a,b,c){"use strict";function d(a,b,c,g,h){for(c=c||0,g=g||a.length-1,h=h||f;g>c;){if(g-c>600){var i=g-c+1,j=b-c+1,k=Math.log(i),l=.5*Math.exp(2*k/3),m=.5*Math.sqrt(k*l*(i-l)/i)*(j-i/2<0?-1:1);d(a,b,Math.max(c,Math.floor(b-j*l/i+m)),Math.min(g,Math.floor(b+(i-j)*l/i+m)),h)}var n=a[b],o=c,p=g;for(e(a,c,b),h(a[g],n)>0&&e(a,c,g);o<p;){for(e(a,o,p),o++,p--;h(a[o],n)<0;)o++;for(;h(a[p],n)>0;)p--}0===h(a[c],n)?e(a,c,p):(p++,e(a,p,g)),p<=b&&(c=p+1),b<=p&&(g=p-1)}}function e(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function f(a,b){return a<b?-1:a>b?1:0}b.exports=d},{}],39:[function(a,b,c){"use strict";function d(a){return new e(a)}function e(a){this.options=n(Object.create(this.options),a),this.trees=new Array(this.options.maxZoom+1)}function f(a,b,c,d,e){return{x:a,y:b,zoom:1/0,id:d,properties:e,parentId:-1,numPoints:c}}function g(a,b){var c=a.geometry.coordinates;return{x:j(c[0]),y:k(c[1]),zoom:1/0,id:b,parentId:-1}}function h(a){return{type:"Feature",properties:i(a),geometry:{type:"Point",coordinates:[l(a.x),m(a.y)]}}}function i(a){var b=a.numPoints,c=b>=1e4?Math.round(b/1e3)+"k":b>=1e3?Math.round(b/100)/10+"k":b;return n(n({},a.properties),{cluster:!0,cluster_id:a.id,point_count:b,point_count_abbreviated:c})}function j(a){return a/360+.5}function k(a){var b=Math.sin(a*Math.PI/180),c=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return c<0?0:c>1?1:c}function l(a){return 360*(a-.5)}function m(a){var b=(180-360*a)*Math.PI/180;return 360*Math.atan(Math.exp(b))/Math.PI-90}function n(a,b){for(var c in b)a[c]=b[c];return a}function o(a){return a.x}function p(a){return a.y}var q=a("kdbush");b.exports=d,e.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(a){return a}},load:function(a){var b=this.options.log;b&&console.time("total time");var c="prepare "+a.length+" points";b&&console.time(c),this.points=a;var d=a.map(g);b&&console.timeEnd(c);for(var e=this.options.maxZoom;e>=this.options.minZoom;e--){var f=+Date.now();this.trees[e+1]=q(d,o,p,this.options.nodeSize,Float32Array),d=this._cluster(d,e),
b&&console.log("z%d: %d clusters in %dms",e,d.length,+Date.now()-f)}return this.trees[this.options.minZoom]=q(d,o,p,this.options.nodeSize,Float32Array),b&&console.timeEnd("total time"),this},getClusters:function(a,b){for(var c=this.trees[this._limitZoom(b)],d=c.range(j(a[0]),k(a[3]),j(a[2]),k(a[1])),e=[],f=0;f<d.length;f++){var g=c.points[d[f]];e.push(g.numPoints?h(g):this.points[g.id])}return e},getChildren:function(a,b){for(var c=this.trees[b+1].points[a],d=this.options.radius/(this.options.extent*Math.pow(2,b)),e=this.trees[b+1].within(c.x,c.y,d),f=[],g=0;g<e.length;g++){var i=this.trees[b+1].points[e[g]];i.parentId===a&&f.push(i.numPoints?h(i):this.points[i.id])}return f},getLeaves:function(a,b,c,d){c=c||10,d=d||0;var e=[];return this._appendLeaves(e,a,b,c,d,0),e},getTile:function(a,b,c){var d=this.trees[this._limitZoom(a)],e=Math.pow(2,a),f=this.options.extent,g=this.options.radius,h=g/f,i=(c-h)/e,j=(c+1+h)/e,k={features:[]};return this._addTileFeatures(d.range((b-h)/e,i,(b+1+h)/e,j),d.points,b,c,e,k),0===b&&this._addTileFeatures(d.range(1-h/e,i,1,j),d.points,e,c,e,k),b===e-1&&this._addTileFeatures(d.range(0,i,h/e,j),d.points,-1,c,e,k),k.features.length?k:null},getClusterExpansionZoom:function(a,b){for(;b<this.options.maxZoom;){var c=this.getChildren(a,b);if(b++,1!==c.length)break;a=c[0].properties.cluster_id}return b},_appendLeaves:function(a,b,c,d,e,f){for(var g=this.getChildren(b,c),h=0;h<g.length;h++){var i=g[h].properties;if(i.cluster?f+i.point_count<=e?f+=i.point_count:f=this._appendLeaves(a,i.cluster_id,c+1,d,e,f):f<e?f++:a.push(g[h]),a.length===d)break}return f},_addTileFeatures:function(a,b,c,d,e,f){for(var g=0;g<a.length;g++){var h=b[a[g]];f.features.push({type:1,geometry:[[Math.round(this.options.extent*(h.x*e-c)),Math.round(this.options.extent*(h.y*e-d))]],tags:h.numPoints?i(h):this.points[h.id].properties})}},_limitZoom:function(a){return Math.max(this.options.minZoom,Math.min(a,this.options.maxZoom+1))},_cluster:function(a,b){for(var c=[],d=this.options.radius/(this.options.extent*Math.pow(2,b)),e=0;e<a.length;e++){var g=a[e];if(!(g.zoom<=b)){g.zoom=b;var h=this.trees[b+1],i=h.within(g.x,g.y,d),j=g.numPoints||1,k=g.x*j,l=g.y*j,m=null;this.options.reduce&&(m=this.options.initial(),this._accumulate(m,g));for(var n=0;n<i.length;n++){var o=h.points[i[n]];if(b<o.zoom){var p=o.numPoints||1;o.zoom=b,k+=o.x*p,l+=o.y*p,j+=p,o.parentId=e,this.options.reduce&&this._accumulate(m,o)}}1===j?c.push(g):(g.parentId=e,c.push(f(k/j,l/j,j,e,m)))}}return c},_accumulate:function(a,b){var c=b.numPoints?b.properties:this.options.map(this.points[b.id].properties);this.options.reduce(a,c)}}},{kdbush:21}],40:[function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);if(this.data=a||[],this.length=this.data.length,this.compare=b||e,this.length>0)for(var c=this.length>>1;c>=0;c--)this._down(c)}function e(a,b){return a<b?-1:a>b?1:0}b.exports=d,d.prototype={push:function(a){this.data.push(a),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var a=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),a}},peek:function(){return this.data[0]},_up:function(a){for(var b=this.data,c=this.compare,d=b[a];a>0;){var e=a-1>>1,f=b[e];if(c(d,f)>=0)break;b[a]=f,a=e}b[a]=d},_down:function(a){for(var b=this.data,c=this.compare,d=this.length,e=d>>1,f=b[a];a<e;){var g=1+(a<<1),h=g+1,i=b[g];if(h<d&&c(b[h],i)<0&&(g=h,i=b[h]),c(i,f)>=0)break;b[a]=i,a=g}b[a]=f}}},{}],41:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],42:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],43:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)&&(r=" [Function"+(b.name?": "+b.name:"")+"]"),w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(d<0)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var v;return v=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(v,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0;return a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}function C(a){return Object.prototype.toString.call(a)}function D(a){return a<10?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),h=d[c];c<f;h=d[++c])q(h)||!x(h)?g+=" "+h:g+=" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(!0===b.noDeprecation)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":42,_process:37,inherits:41}],44:[function(a,b,c){b.exports.VectorTile=a("./lib/vectortile.js"),b.exports.VectorTileFeature=a("./lib/vectortilefeature.js"),b.exports.VectorTileLayer=a("./lib/vectortilelayer.js")},{"./lib/vectortile.js":45,"./lib/vectortilefeature.js":46,"./lib/vectortilelayer.js":47}],45:[function(a,b,c){"use strict";function d(a,b){this.layers=a.readFields(e,{},b)}function e(a,b,c){if(3===a){var d=new f(c,c.readVarint()+c.pos);d.length&&(b[d.name]=d)}}var f=a("./vectortilelayer");b.exports=d},{"./vectortilelayer":47}],46:[function(a,b,c){"use strict";function d(a,b,c,d,f){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=f,a.readFields(e,this,b)}function e(a,b,c){1==a?b.id=c.readVarint():2==a?f(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function f(a,b){for(var c=a.readVarint()+a.pos;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}function g(a){var b=a.length;if(b<=1)return[a];for(var c,d,e=[],f=0;f<b;f++){var g=h(a[f]);0!==g&&(void 0===d&&(d=g<0),d===g<0?(c&&e.push(c),c=[a[f]]):c.push(a[f]))}return c&&e.push(c),e}function h(a){for(var b,c,d=0,e=0,f=a.length,g=f-1;e<f;g=e++)b=a[e],c=a[g],d+=(c.x-b.x)*(b.y+c.y);return d}var i=a("point-geometry");b.exports=d,d.types=["Unknown","Point","LineString","Polygon"],d.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var b,c=a.readVarint()+a.pos,d=1,e=0,f=0,g=0,h=[];a.pos<c;){if(!e){var j=a.readVarint();d=7&j,e=j>>3}if(e--,1===d||2===d)f+=a.readSVarint(),g+=a.readSVarint(),1===d&&(b&&h.push(b),b=[]),b.push(new i(f,g));else{if(7!==d)throw new Error("unknown command "+d);b&&b.push(b[0].clone())}}return b&&h.push(b),h},d.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=1/0,h=-1/0,i=1/0,j=-1/0;a.pos<b;){if(!d){var k=a.readVarint();c=7&k,d=k>>3}if(d--,1===c||2===c)e+=a.readSVarint(),f+=a.readSVarint(),e<g&&(g=e),e>h&&(h=e),f<i&&(i=f),f>j&&(j=f);else if(7!==c)throw new Error("unknown command "+c)}return[g,i,h,j]},d.prototype.toGeoJSON=function(a,b,c){function e(a){for(var b=0;b<a.length;b++){var c=a[b],d=180-360*(c.y+k)/i;a[b]=[360*(c.x+j)/i-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}var f,h,i=this.extent*Math.pow(2,c),j=this.extent*a,k=this.extent*b,l=this.loadGeometry(),m=d.types[this.type];switch(this.type){case 1:var n=[];for(f=0;f<l.length;f++)n[f]=l[f][0];l=n,e(l);break;case 2:for(f=0;f<l.length;f++)e(l[f]);break;case 3:for(l=g(l),f=0;f<l.length;f++)for(h=0;h<l[f].length;h++)e(l[f][h])}1===l.length?l=l[0]:m="Multi"+m;var o={type:"Feature",geometry:{type:m,coordinates:l},properties:this.properties};return"id"in this&&(o.id=this.id),o}},{"point-geometry":36}],47:[function(a,b,c){"use strict";function d(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(e,this,b),this.length=this._features.length}function e(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(f(c))}function f(a){for(var b=null,c=a.readVarint()+a.pos;a.pos<c;){var d=a.readVarint()>>3;b=1===d?a.readString():2===d?a.readFloat():3===d?a.readDouble():4===d?a.readVarint64():5===d?a.readVarint():6===d?a.readSVarint():7===d?a.readBoolean():null}return b}var g=a("./vectortilefeature.js");b.exports=d,d.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new g(this._pbf,b,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":46}],48:[function(a,b,c){function d(a){var b=[];for(var c in a.layers)b.push(f(a.layers[c]));var d=new k;return l.tile.write({layers:b},d),d.finish()}function e(a){var b={};for(var c in a)b[c]=new m(a[c].features),b[c].name=c;return d({layers:b})}function f(a){for(var b={name:a.name||"",version:a.version||1,extent:a.extent||4096,keys:[],values:[],features:[]},c={},d={},e=0;e<a.length;e++){var f=a.feature(e);f.geometry=i(f.loadGeometry());var g=[];for(var h in f.properties){var k=c[h];void 0===k&&(b.keys.push(h),k=b.keys.length-1,c[h]=k);var l=j(f.properties[h]),m=d[l.key];void 0===m&&(b.values.push(l),m=b.values.length-1,d[l.key]=m),g.push(k),g.push(m)}f.tags=g,b.features.push(f)}return b}function g(a,b){return(b<<3)+(7&a)}function h(a){return a<<1^a>>31}function i(a){for(var b=[],c=0,d=0,e=a.length,f=0;f<e;f++){var i=a[f];b.push(g(1,1));for(var j=0;j<i.length;j++){1===j&&b.push(g(2,i.length-1));var k=i[j].x-c,l=i[j].y-d;b.push(h(k),h(l)),c+=k,d+=l}}return b}function j(a){var b,c=typeof a;return"string"===c?b={string_value:a}:"boolean"===c?b={bool_value:a}:"number"===c?b=a%1!=0?{double_value:a}:a<0?{sint_value:a}:{uint_value:a}:(a=JSON.stringify(a),b={string_value:a}),b.key=c+":"+a,b}var k=a("pbf"),l=a("./vector-tile-pb"),m=a("./lib/geojson_wrapper");b.exports=d,b.exports.fromVectorTileJs=d,b.exports.fromGeojsonVt=e,b.exports.GeoJSONWrapper=m},{"./lib/geojson_wrapper":49,"./vector-tile-pb":50,pbf:35}],49:[function(a,b,c){"use strict";function d(a){this.features=a,this.length=a.length}function e(a){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=4096}var f=a("point-geometry"),g=a("vector-tile").VectorTileFeature;b.exports=d,d.prototype.feature=function(a){return new e(this.features[a])},e.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=[];for(var b=0;b<a.length;b++){for(var c=a[b],d=[],e=0;e<c.length;e++)d.push(new f(c[e][0],c[e][1]));this.geometry.push(d)}return this.geometry},e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},e.prototype.toGeoJSON=g.prototype.toGeoJSON},{"point-geometry":36,"vector-tile":44}],50:[function(a,b,c){"use strict";function d(a,b){return a.readFields(e,{layers:[]},b)}function e(a,b,c){3===a&&b.layers.push(m(c,c.readVarint()+c.pos))}function f(a,b){var c;if(void 0!==a.layers)for(c=0;c<a.layers.length;c++)b.writeMessage(3,o,a.layers[c])}function g(a,b){return a.readFields(h,{},b)}function h(a,b,c){1===a?b.string_value=c.readString():2===a?b.float_value=c.readFloat():3===a?b.double_value=c.readDouble():4===a?b.int_value=c.readVarint():5===a?b.uint_value=c.readVarint():6===a?b.sint_value=c.readSVarint():7===a&&(b.bool_value=c.readBoolean())}function i(a,b){void 0!==a.string_value&&b.writeStringField(1,a.string_value),void 0!==a.float_value&&b.writeFloatField(2,a.float_value),void 0!==a.double_value&&b.writeDoubleField(3,a.double_value),void 0!==a.int_value&&b.writeVarintField(4,a.int_value),void 0!==a.uint_value&&b.writeVarintField(5,a.uint_value),void 0!==a.sint_value&&b.writeSVarintField(6,a.sint_value),void 0!==a.bool_value&&b.writeBooleanField(7,a.bool_value)}function j(a,b){var c=a.readFields(k,{},b);return void 0===c.type&&(c.type="Unknown"),c}function k(a,b,c){1===a?b.id=c.readVarint():2===a?b.tags=c.readPackedVarint():3===a?b.type=c.readVarint():4===a&&(b.geometry=c.readPackedVarint())}function l(a,b){void 0!==a.id&&b.writeVarintField(1,a.id),void 0!==a.tags&&b.writePackedVarint(2,a.tags),void 0!==a.type&&b.writeVarintField(3,a.type),void 0!==a.geometry&&b.writePackedVarint(4,a.geometry)}function m(a,b){return a.readFields(n,{features:[],keys:[],values:[]},b)}function n(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():2===a?b.features.push(j(c,c.readVarint()+c.pos)):3===a?b.keys.push(c.readString()):4===a?b.values.push(g(c,c.readVarint()+c.pos)):5===a&&(b.extent=c.readVarint())}function o(a,b){void 0!==a.version&&b.writeVarintField(15,a.version),void 0!==a.name&&b.writeStringField(1,a.name);var c;if(void 0!==a.features)for(c=0;c<a.features.length;c++)b.writeMessage(2,l,a.features[c]);if(void 0!==a.keys)for(c=0;c<a.keys.length;c++)b.writeStringField(3,a.keys[c]);if(void 0!==a.values)for(c=0;c<a.values.length;c++)b.writeMessage(4,i,a.values[c]);void 0!==a.extent&&b.writeVarintField(5,a.extent)}var p=c.tile={read:d,write:f};p.GeomType={Unknown:0,Point:1,LineString:2,Polygon:3},p.value={read:g,write:i},p.feature={read:j,write:l},p.layer={read:m,write:o}},{}],51:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a,b){function c(a){q[a]=!0;for(var b in e[a][1]){var d=e[a][1][b];q[d]||c(d)}}for(var h,i=Object.keys(f),j=0,k=i.length;j<k;j++){var l=i[j],m=f[l].exports;if(m===a||m&&m.default===a){h=l;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var n={},j=0,k=i.length;j<k;j++){var l=i[j];n[l]=l}e[h]=[Function(["require","module","exports"],"("+a+")(self)"),n]}var o=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[h]=h,e[o]=[Function(["require"],"var f = require("+g(h)+");(f.default ? f.default : f)(self);"),p];var q={};c(o);var r="("+d+")({"+Object.keys(q).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(o)+"])",s=window.URL||window.webkitURL||window.mozURL||window.msURL,t=new Blob([r],{type:"text/javascript"});if(b&&b.bare)return t;var u=s.createObjectURL(t),v=new Worker(u);return v.objectURL=u,v}},{}],52:[function(a,b,c){b.exports.RADIUS=6378137,b.exports.FLATTENING=1/298.257223563,b.exports.POLAR_RADIUS=6356752.3142},{}],53:[function(a,b,c){b.exports={version:"0.39.1"}},{}],54:[function(a,b,c){"use strict";function d(a,b){var c={};for(var d in a){var e=a[d].paintVertexArray;if(0!==e.length){var f=e.serialize(b),g=e.constructor.serialize();c[d]={array:f,type:g}}}return c}var e=a("./program_configuration"),f=a("./vertex_array_type"),g=function(a,b){this.vertexOffset=a,this.primitiveOffset=b,this.vertexLength=0,this.primitiveLength=0},h=function(a,b,c){var d=this;this.globalProperties={zoom:c};var g=f(a.layoutAttributes);if(this.layoutVertexArray=new g,a.dynamicLayoutAttributes){var h=f(a.dynamicLayoutAttributes);this.dynamicLayoutVertexArray=new h}var i=a.elementArrayType;i&&(this.elementArray=new i);var j=a.elementArrayType2;j&&(this.elementArray2=new j),this.layerData={};for(var k=0,l=b;k<l.length;k+=1){var m=l[k],n=e.createDynamic(a,m,c);d.layerData[m.id]={layer:m,programConfiguration:n,paintVertexArray:new n.PaintVertexArray,paintPropertyStatistics:n.createPaintPropertyStatistics()}}this.segments=[],this.segments2=[]};h.prototype.prepareSegment=function(a){var b=this.segments[this.segments.length-1];return(!b||b.vertexLength+a>h.MAX_VERTEX_ARRAY_LENGTH)&&(b=new g(this.layoutVertexArray.length,this.elementArray.length),this.segments.push(b)),b},h.prototype.prepareSegment2=function(a){var b=this.segments2[this.segments2.length-1];return(!b||b.vertexLength+a>h.MAX_VERTEX_ARRAY_LENGTH)&&(b=new g(this.layoutVertexArray.length,this.elementArray2.length),this.segments2.push(b)),b},h.prototype.populatePaintArrays=function(a){var b=this;for(var c in b.layerData){var d=b.layerData[c];0!==d.paintVertexArray.bytesPerElement&&d.programConfiguration.populatePaintArray(d.layer,d.paintVertexArray,d.paintPropertyStatistics,b.layoutVertexArray.length,a)}},h.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},h.prototype.serialize=function(a){return{layoutVertexArray:this.layoutVertexArray.serialize(a),dynamicLayoutVertexArray:this.dynamicLayoutVertexArray&&this.dynamicLayoutVertexArray.serialize(a),elementArray:this.elementArray&&this.elementArray.serialize(a),elementArray2:this.elementArray2&&this.elementArray2.serialize(a),paintVertexArrays:d(this.layerData,a),segments:this.segments,segments2:this.segments2}},h.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,b.exports=h},{"./program_configuration":68,"./vertex_array_type":70}],55:[function(a,b,c){"use strict";var d=a("./array_group"),e=a("./buffer_group"),f=a("../util/util"),g=function(a,b){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.index=a.index,a.arrays?this.buffers=new e(b,a.layers,a.zoom,a.arrays):this.arrays=new d(b,a.layers,a.zoom)};g.deserialize=function(a,b){var c={};if(!b)return c;for(var d=0,e=a;d<e.length;d+=1){var g=e[d],h=g.layerIds.map(function(a){return b.getLayer(a)}).filter(Boolean);if(0!==h.length)for(var i=h[0].createBucket(f.extend({layers:h},g)),j=0,k=h;j<k.length;j+=1){var l=k[j];c[l.id]=i}}return c},g.prototype.populate=function(a,b){for(var c=this,d=0,e=a;d<e.length;d+=1){var f=e[d],g=f.feature,h=f.index,i=f.sourceLayerIndex;c.layers[0].filter(g)&&(c.addFeature(g),b.featureIndex.insert(g,h,i,c.index))}},g.prototype.getPaintPropertyStatistics=function(){return f.mapObject(this.arrays.layerData,function(a){return a.paintPropertyStatistics})},g.prototype.isEmpty=function(){return this.arrays.isEmpty()},g.prototype.serialize=function(a){return{zoom:this.zoom,layerIds:this.layers.map(function(a){return a.id}),arrays:this.arrays.serialize(a)}},g.prototype.destroy=function(){this.buffers&&(this.buffers.destroy(),this.buffers=null)},b.exports=g},{"../util/util":218,"./array_group":54,"./buffer_group":62}],56:[function(a,b,c){"use strict";function d(a,b,c,d,e){a.emplaceBack(2*b+(d+1)/2,2*c+(e+1)/2)}var e=a("../bucket"),f=a("../element_array_type"),g=a("../load_geometry"),h=a("../extent"),i={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:f(),paintAttributes:[{property:"circle-color"},{property:"circle-radius"},{property:"circle-blur"},{property:"circle-opacity"},{property:"circle-stroke-color"},{property:"circle-stroke-width"},{property:"circle-stroke-opacity"}]},j=function(a){function b(b){a.call(this,b,i)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){for(var b=this.arrays,c=0,e=g(a);c<e.length;c+=1)for(var f=e[c],i=0,j=f;i<j.length;i+=1){var k=j[i],l=k.x,m=k.y;if(!(l<0||l>=h||m<0||m>=h)){var n=b.prepareSegment(4),o=n.vertexLength;d(b.layoutVertexArray,l,m,-1,-1),d(b.layoutVertexArray,l,m,1,-1),d(b.layoutVertexArray,l,m,1,1),d(b.layoutVertexArray,l,m,-1,1),b.elementArray.emplaceBack(o,o+1,o+2),b.elementArray.emplaceBack(o,o+3,o+2),n.vertexLength+=4,n.primitiveLength+=2}}b.populatePaintArrays(a.properties)},b}(e);j.programInterface=i,b.exports=j},{"../bucket":55,"../element_array_type":63,"../extent":64,"../load_geometry":66}],57:[function(a,b,c){"use strict";var d=a("../bucket"),e=a("../element_array_type"),f=a("../load_geometry"),g=a("earcut"),h=a("../../util/classify_rings"),i=500,j={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:e(3),elementArrayType2:e(2),paintAttributes:[{property:"fill-color"},{property:"fill-outline-color"},{property:"fill-opacity"}]},k=function(a){function b(b){a.call(this,b,j)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){for(var b=this.arrays,c=0,d=h(f(a),i);c<d.length;c+=1){for(var e=d[c],j=0,k=0,l=e;k<l.length;k+=1)j+=l[k].length;for(var m=b.prepareSegment(j),n=m.vertexLength,o=[],p=[],q=0,r=e;q<r.length;q+=1){var s=r[q];if(0!==s.length){s!==e[0]&&p.push(o.length/2);var t=b.prepareSegment2(s.length),u=t.vertexLength;b.layoutVertexArray.emplaceBack(s[0].x,s[0].y),b.elementArray2.emplaceBack(u+s.length-1,u),o.push(s[0].x),o.push(s[0].y);for(var v=1;v<s.length;v++)b.layoutVertexArray.emplaceBack(s[v].x,s[v].y),b.elementArray2.emplaceBack(u+v-1,u+v),o.push(s[v].x),o.push(s[v].y);t.vertexLength+=s.length,t.primitiveLength+=s.length}}for(var w=g(o,p),x=0;x<w.length;x+=3)b.elementArray.emplaceBack(n+w[x],n+w[x+1],n+w[x+2]);m.vertexLength+=j,m.primitiveLength+=w.length/3}b.populatePaintArrays(a.properties)},b}(d);k.programInterface=j,b.exports=k},{"../../util/classify_rings":200,"../bucket":55,"../element_array_type":63,"../load_geometry":66,earcut:7}],58:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,2*Math.floor(d*n)+g,e*n*2,f*n*2,Math.round(h))}function e(a,b){return a.x===b.x&&(a.x<0||a.x>i)||a.y===b.y&&(a.y<0||a.y>i)}var f=a("../bucket"),g=a("../element_array_type"),h=a("../load_geometry"),i=a("../extent"),j=a("earcut"),k=a("../../util/classify_rings"),l=500,m={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_normal",components:3,type:"Int16"},{name:"a_edgedistance",components:1,type:"Int16"}],elementArrayType:g(3),paintAttributes:[{property:"fill-extrusion-base"},{property:"fill-extrusion-height"},{property:"fill-extrusion-color"}]},n=Math.pow(2,13),o=function(a){function b(b){a.call(this,b,m)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){for(var b=this.arrays,c=0,f=k(h(a),l);c<f.length;c+=1){for(var g=f[c],i=0,m=0,n=g;m<n.length;m+=1)i+=n[m].length;for(var o=b.prepareSegment(5*i),p=[],q=[],r=[],s=0,t=g;s<t.length;s+=1){var u=t[s];if(0!==u.length){u!==g[0]&&q.push(p.length/2);for(var v=0,w=0;w<u.length;w++){var x=u[w];if(d(b.layoutVertexArray,x.x,x.y,0,0,1,1,0),r.push(o.vertexLength++),w>=1){var y=u[w-1];if(!e(x,y)){var z=x.sub(y)._perp()._unit();d(b.layoutVertexArray,x.x,x.y,z.x,z.y,0,0,v),d(b.layoutVertexArray,x.x,x.y,z.x,z.y,0,1,v),v+=y.dist(x),d(b.layoutVertexArray,y.x,y.y,z.x,z.y,0,0,v),d(b.layoutVertexArray,y.x,y.y,z.x,z.y,0,1,v);var A=o.vertexLength;b.elementArray.emplaceBack(A,A+1,A+2),b.elementArray.emplaceBack(A+1,A+2,A+3),o.vertexLength+=4,o.primitiveLength+=2}}p.push(x.x),p.push(x.y)}}}for(var B=j(p,q),C=0;C<B.length;C+=3)b.elementArray.emplaceBack(r[B[C]],r[B[C+1]],r[B[C+2]]);o.primitiveLength+=B.length/3}b.populatePaintArrays(a.properties)},b}(f);o.programInterface=m,b.exports=o},{"../../util/classify_rings":200,"../bucket":55,"../element_array_type":63,"../extent":64,"../load_geometry":66,earcut:7}],59:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){a.emplaceBack(b.x<<1|d,b.y<<1|e,Math.round(j*c.x)+128,Math.round(j*c.y)+128,1+(0===f?0:f<0?-1:1)|(g*n&63)<<2,g*n>>6)}var e=a("../bucket"),f=a("../element_array_type"),g=a("../load_geometry"),h=a("../extent"),i=a("vector-tile").VectorTileFeature.types,j=63,k=Math.cos(Math.PI/180*37.5),l=15,m=15,n=.5,o=Math.pow(2,m-1)/n,p={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],paintAttributes:[{property:"line-color"},{property:"line-blur"},{property:"line-opacity"},{property:"line-gap-width",name:"gapwidth"},{property:"line-offset"},{property:"line-width"},{property:"line-width",name:"floorwidth",useIntegerZoom:!0}],elementArrayType:f()},q=function(a){function b(b){a.call(this,b,p)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addFeature=function(a){for(var b=this,c=this.layers[0].layout,d=c["line-join"],e=c["line-cap"],f=c["line-miter-limit"],h=c["line-round-limit"],i=0,j=g(a,m);i<j.length;i+=1){var k=j[i];b.addLine(k,a,d,e,f,h)}},b.prototype.addLine=function(a,b,c,d,e,f){for(var g=this,j=b.properties,m="Polygon"===i[b.type],n=a.length;n>=2&&a[n-1].equals(a[n-2]);)n--;for(var o=0;o<n-1&&a[o].equals(a[o+1]);)o++;if(!(n<(m?3:2))){"bevel"===c&&(e=1.05);var p=l*(h/(512*this.overscaling)),q=a[o],r=this.arrays,s=r.prepareSegment(10*n);this.distance=0;var t,u,v,w=d,x=m?"butt":d,y=!0,z=void 0,A=void 0,B=void 0,C=void 0;this.e1=this.e2=this.e3=-1,m&&(t=a[n-2],C=q.sub(t)._unit()._perp());for(var D=o;D<n;D++)if(!(A=m&&D===n-1?a[o+1]:a[D+1])||!a[D].equals(A)){C&&(B=C),t&&(z=t),t=a[D],C=A?A.sub(t)._unit()._perp():B,B=B||C;var E=B.add(C);0===E.x&&0===E.y||E._unit();var F=E.x*C.x+E.y*C.y,G=0!==F?1/F:1/0,H=F<k&&z&&A;if(H&&D>o){var I=t.dist(z);if(I>2*p){var J=t.sub(t.sub(z)._mult(p/I)._round());g.distance+=J.dist(z),g.addCurrentVertex(J,g.distance,B.mult(1),0,0,!1,s),z=J}}var K=z&&A,L=K?c:A?w:x;if(K&&"round"===L&&(G<f?L="miter":G<=2&&(L="fakeround")),"miter"===L&&G>e&&(L="bevel"),"bevel"===L&&(G>2&&(L="flipbevel"),G<e&&(L="miter")),z&&(g.distance+=t.dist(z)),"miter"===L)E._mult(G),g.addCurrentVertex(t,g.distance,E,0,0,!1,s);else if("flipbevel"===L){if(G>100)E=C.clone().mult(-1);else{var M=B.x*C.y-B.y*C.x>0?-1:1,N=G*B.add(C).mag()/B.sub(C).mag();E._perp()._mult(N*M)}g.addCurrentVertex(t,g.distance,E,0,0,!1,s),g.addCurrentVertex(t,g.distance,E.mult(-1),0,0,!1,s)}else if("bevel"===L||"fakeround"===L){var O=B.x*C.y-B.y*C.x>0,P=-Math.sqrt(G*G-1);if(O?(v=0,u=P):(u=0,v=P),y||g.addCurrentVertex(t,g.distance,B,u,v,!1,s),"fakeround"===L){for(var Q=Math.floor(8*(.5-(F-.5))),R=void 0,S=0;S<Q;S++)R=C.mult((S+1)/(Q+1))._add(B)._unit(),g.addPieSliceVertex(t,g.distance,R,O,s);g.addPieSliceVertex(t,g.distance,E,O,s);for(var T=Q-1;T>=0;T--)R=B.mult((T+1)/(Q+1))._add(C)._unit(),g.addPieSliceVertex(t,g.distance,R,O,s)}A&&g.addCurrentVertex(t,g.distance,C,-u,-v,!1,s)}else"butt"===L?(y||g.addCurrentVertex(t,g.distance,B,0,0,!1,s),A&&g.addCurrentVertex(t,g.distance,C,0,0,!1,s)):"square"===L?(y||(g.addCurrentVertex(t,g.distance,B,1,1,!1,s),g.e1=g.e2=-1),A&&g.addCurrentVertex(t,g.distance,C,-1,-1,!1,s)):"round"===L&&(y||(g.addCurrentVertex(t,g.distance,B,0,0,!1,s),g.addCurrentVertex(t,g.distance,B,1,1,!0,s),g.e1=g.e2=-1),A&&(g.addCurrentVertex(t,g.distance,C,-1,-1,!0,s),g.addCurrentVertex(t,g.distance,C,0,0,!1,s)));if(H&&D<n-1){var U=t.dist(A);if(U>2*p){var V=t.add(A.sub(t)._mult(p/U)._round());g.distance+=V.dist(t),g.addCurrentVertex(V,g.distance,C.mult(1),0,0,!1,s),t=V}}y=!1}r.populatePaintArrays(j)}},b.prototype.addCurrentVertex=function(a,b,c,e,f,g,h){var i,j=g?1:0,k=this.arrays,l=k.layoutVertexArray,m=k.elementArray;i=c.clone(),e&&i._sub(c.perp()._mult(e)),d(l,a,i,j,0,e,b),this.e3=h.vertexLength++,
this.e1>=0&&this.e2>=0&&(m.emplaceBack(this.e1,this.e2,this.e3),h.primitiveLength++),this.e1=this.e2,this.e2=this.e3,i=c.mult(-1),f&&i._sub(c.perp()._mult(f)),d(l,a,i,j,1,-f,b),this.e3=h.vertexLength++,this.e1>=0&&this.e2>=0&&(m.emplaceBack(this.e1,this.e2,this.e3),h.primitiveLength++),this.e1=this.e2,this.e2=this.e3,b>o/2&&(this.distance=0,this.addCurrentVertex(a,this.distance,c,e,f,g,h))},b.prototype.addPieSliceVertex=function(a,b,c,e,f){var g=e?1:0;c=c.mult(e?-1:1);var h=this.arrays,i=h.layoutVertexArray,j=h.elementArray;d(i,a,c,0,g,0,b),this.e3=f.vertexLength++,this.e1>=0&&this.e2>=0&&(j.emplaceBack(this.e1,this.e2,this.e3),f.primitiveLength++),e?this.e2=this.e3:this.e1=this.e3},b}(e);q.programInterface=p,b.exports=q},{"../bucket":55,"../element_array_type":63,"../extent":64,"../load_geometry":66,"vector-tile":44}],60:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,Math.round(64*d),Math.round(64*e),f,g,h?h[0]:void 0,h?h[1]:void 0)}function e(a,b,c,d){var e=2*Math.PI,f=n((c+e)%e/e*255,10*d);a.emplaceBack(b.x,b.y,f),a.emplaceBack(b.x,b.y,f),a.emplaceBack(b.x,b.y,f),a.emplaceBack(b.x,b.y,f)}function f(a,b,c,d,e,f){return a.emplaceBack(b.x,b.y,c.x,c.y,Math.round(d.x),Math.round(d.y),10*e,10*f)}function g(a,b,c){var d={};if(d.isFeatureConstant=b.isLayoutValueFeatureConstant(c),d.isZoomConstant=b.isLayoutValueZoomConstant(c),d.isFeatureConstant&&(d.layoutSize=b.getLayoutValue(c,{zoom:a+1})),!d.isZoomConstant){for(var e=b.getLayoutValueStopZoomLevels(c),f=0;f<e.length&&e[f]<=a;)f++;f=Math.max(0,f-1);for(var g=f;g<e.length&&e[g]<a+1;)g++;g=Math.min(e.length-1,g),d.coveringZoomRange=[e[f],e[g]],b.isLayoutValueFeatureConstant(c)&&(d.coveringStopValues=[b.getLayoutValue(c,{zoom:e[f]}),b.getLayoutValue(c,{zoom:e[g]})]),d.functionBase=b.getLayoutProperty(c).base,void 0===d.functionBase&&(d.functionBase=1),d.functionType=b.getLayoutProperty(c).type||"exponential"}return d}function h(a,b,c,d,e){return a.isLayoutValueZoomConstant(d)&&!a.isLayoutValueFeatureConstant(d)?[10*a.getLayoutValue(d,{},e)]:a.isLayoutValueZoomConstant(d)||a.isLayoutValueFeatureConstant(d)?null:[10*a.getLayoutValue(d,{zoom:c[0]},e),10*a.getLayoutValue(d,{zoom:c[1]},e)]}var i=a("point-geometry"),j=a("../array_group"),k=a("../buffer_group"),l=a("../element_array_type"),m=a("../extent"),n=a("../../shaders/encode_attribute").packUint8ToFloat,o=a("../../symbol/anchor"),p=a("../../symbol/get_anchors"),q=a("../../util/token"),r=a("../../symbol/quads"),s=a("../../symbol/shaping"),t=a("../../symbol/transform_text"),u=a("../../symbol/mergelines"),v=a("../../symbol/clip_line"),w=a("../../util/util"),x=a("../../util/script_detection"),y=a("../load_geometry"),z=a("../../symbol/collision_feature"),A=a("../../util/find_pole_of_inaccessibility"),B=a("../../util/classify_rings"),C=a("vector-tile").VectorTileFeature.types,D=a("../../util/struct_array"),E=a("../../util/verticalize_punctuation"),F=s.shapeText,G=s.shapeIcon,H=s.WritingMode,I=r.getGlyphQuads,J=r.getIconQuads,K=D({members:[{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Float32",name:"placementZoom"},{type:"Uint8",name:"vertical"}]}),L=D({members:[{type:"Float32",name:"offsetX"}]}),M=D({members:[{type:"Int16",name:"x"},{type:"Int16",name:"y"}]}),N=l(),O=[{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}],P=[{name:"a_projected_pos",components:3,type:"Float32"}],Q={glyph:{layoutAttributes:O,dynamicLayoutAttributes:P,elementArrayType:N,paintAttributes:[{property:"text-color",name:"fill_color"},{property:"text-halo-color",name:"halo_color"},{property:"text-halo-width",name:"halo_width"},{property:"text-halo-blur",name:"halo_blur"},{property:"text-opacity",name:"opacity"}]},icon:{layoutAttributes:O,dynamicLayoutAttributes:P,elementArrayType:N,paintAttributes:[{property:"icon-color",name:"fill_color"},{property:"icon-halo-color",name:"halo_color"},{property:"icon-halo-width",name:"halo_width"},{property:"icon-halo-blur",name:"halo_blur"},{property:"icon-opacity",name:"opacity"}]},collisionBox:{layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}],elementArrayType:l(2)}},R=function(a){var b=this;this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.index=a.index,this.sdfIcons=a.sdfIcons,this.iconsNeedLinear=a.iconsNeedLinear,this.fontstack=a.fontstack;var c=this.layers[0];if(this.symbolInterfaces=Q,a.arrays){this.buffers={};for(var d in a.arrays)a.arrays[d]&&(b.buffers[d]=new k(b.symbolInterfaces[d],a.layers,a.zoom,a.arrays[d]));this.textSizeData=a.textSizeData,this.iconSizeData=a.iconSizeData,this.placedGlyphArray=new K(a.placedGlyphArray),this.placedIconArray=new K(a.placedIconArray),this.glyphOffsetArray=new L(a.glyphOffsetArray),this.lineVertexArray=new M(a.lineVertexArray)}else this.textSizeData=g(this.zoom,c,"text-size"),this.iconSizeData=g(this.zoom,c,"icon-size")};R.prototype.populate=function(a,b){var c=this,d=this.layers[0],e=d.layout,f=e["text-font"],g=(!d.isLayoutValueFeatureConstant("text-field")||e["text-field"])&&f,h=!d.isLayoutValueFeatureConstant("icon-image")||e["icon-image"];if(this.features=[],g||h){for(var i=b.iconDependencies,j=b.glyphDependencies,k=j[f]=j[f]||{},l={zoom:this.zoom},m=0,n=a;m<n.length;m+=1){var o=n[m],p=o.feature,r=o.index,s=o.sourceLayerIndex;if(d.filter(p)){var v=void 0;g&&(v=d.getLayoutValue("text-field",l,p.properties),d.isLayoutValueFeatureConstant("text-field")&&(v=q(p.properties,v)),v=t(v,d,l,p.properties));var w=void 0;if(h&&(w=d.getLayoutValue("icon-image",l,p.properties),d.isLayoutValueFeatureConstant("icon-image")&&(w=q(p.properties,w))),(v||w)&&(c.features.push({text:v,icon:w,index:r,sourceLayerIndex:s,geometry:y(p),properties:p.properties,type:C[p.type]}),w&&(i[w]=!0),v))for(var z="map"===e["text-rotation-alignment"]&&"line"===e["symbol-placement"],A=x.allowsVerticalWritingMode(v),B=0;B<v.length;B++)if(k[v.charCodeAt(B)]=!0,z&&A){var D=E.lookup[v.charAt(B)];D&&(k[D.charCodeAt(0)]=!0)}}}"line"===e["symbol-placement"]&&(this.features=u(this.features))}},R.prototype.isEmpty=function(){return this.arrays.icon.isEmpty()&&this.arrays.glyph.isEmpty()&&this.arrays.collisionBox.isEmpty()},R.prototype.getPaintPropertyStatistics=function(){for(var a=this,b={},c=0,d=a.layers;c<d.length;c+=1){var e=d[c];b[e.id]=w.extend({},a.arrays.icon.layerData[e.id].paintPropertyStatistics,a.arrays.glyph.layerData[e.id].paintPropertyStatistics)}return b},R.prototype.serialize=function(a){return{zoom:this.zoom,layerIds:this.layers.map(function(a){return a.id}),sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear,textSizeData:this.textSizeData,iconSizeData:this.iconSizeData,fontstack:this.fontstack,placedGlyphArray:this.placedGlyphArray.serialize(a),placedIconArray:this.placedIconArray.serialize(a),glyphOffsetArray:this.glyphOffsetArray.serialize(a),lineVertexArray:this.lineVertexArray.serialize(a),arrays:w.mapObject(this.arrays,function(b){return b.isEmpty()?null:b.serialize(a)})}},R.prototype.destroy=function(){this.buffers&&(this.buffers.icon&&this.buffers.icon.destroy(),this.buffers.glyph&&this.buffers.glyph.destroy(),this.buffers.collisionBox&&this.buffers.collisionBox.destroy(),this.buffers=null)},R.prototype.createArrays=function(){var a=this;this.arrays=w.mapObject(this.symbolInterfaces,function(b){return new j(b,a.layers,a.zoom)})},R.prototype.prepare=function(a,b){var c=this;this.symbolInstances=[];var d=512*this.overscaling;this.tilePixelRatio=m/d,this.compareText={},this.iconsNeedLinear=!1;for(var e=this.layers[0].layout,f=24*e["text-line-height"],g="line"!==e["symbol-placement"]?24*e["text-max-width"]:0,h=24*e["text-letter-spacing"],i=this.fontstack=e["text-font"].join(","),j="map"===e["text-rotation-alignment"]&&"line"===e["symbol-placement"],k=0,l=c.features;k<l.length;k+=1){var n=l[k],o=void 0;if(n.text){var p=x.allowsVerticalWritingMode(n.text),q=c.layers[0].getLayoutValue("text-offset",{zoom:c.zoom},n.properties).map(function(a){return 24*a}),r=x.allowsLetterSpacing(n.text)?h:0,s=c.layers[0].getLayoutValue("text-anchor",{zoom:c.zoom},n.properties),t=c.layers[0].getLayoutValue("text-justify",{zoom:c.zoom},n.properties);o={},o[H.horizontal]=F(n.text,a[i],g,f,s,t,r,q,24,H.horizontal),o[H.vertical]=p&&j&&F(n.text,a[i],g,f,s,t,r,q,24,H.vertical)}else o={};var u=void 0;if(n.icon){var v=b[n.icon];v&&(u=G(v,c.layers[0].getLayoutValue("icon-offset",{zoom:c.zoom},n.properties)),void 0===c.sdfIcons?c.sdfIcons=v.sdf:c.sdfIcons!==v.sdf&&w.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),v.isNativePixelRatio?0===e["icon-rotate"]&&c.layers[0].isLayoutValueFeatureConstant("icon-rotate")||(c.iconsNeedLinear=!0):c.iconsNeedLinear=!0)}(o[H.horizontal]||u)&&c.addFeature(n,o,u)}},R.prototype.addFeature=function(a,b,c){var d=this,e=this.layers[0].getLayoutValue("text-size",{zoom:this.zoom+1},a.properties),f=this.layers[0].getLayoutValue("icon-size",{zoom:this.zoom+1},a.properties),g=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},a.properties),h=this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},a.properties),i=this.layers[0].getLayoutValue("text-size",{zoom:18},a.properties);void 0===i&&(i=e);var j=this.layers[0].layout,k=e/24,l=this.tilePixelRatio*k,n=this.tilePixelRatio*i/24,q=this.tilePixelRatio*f,r=this.tilePixelRatio*j["symbol-spacing"],s=j["symbol-avoid-edges"],t=j["text-padding"]*this.tilePixelRatio,u=j["icon-padding"]*this.tilePixelRatio,w=j["text-max-angle"]/180*Math.PI,x="map"===j["text-rotation-alignment"]&&"line"===j["symbol-placement"],y="map"===j["icon-rotation-alignment"]&&"line"===j["symbol-placement"],z=j["text-allow-overlap"]||j["icon-allow-overlap"]||j["text-ignore-placement"]||j["icon-ignore-placement"],C=j["symbol-placement"],D=r/2,E=function(e,f){var i=!(f.x<0||f.x>m||f.y<0||f.y>m);if(!s||i){var j=i||z;d.addSymbolInstance(f,e,b,c,d.layers[0],j,d.collisionBoxArray,a.index,a.sourceLayerIndex,d.index,l,t,x,g,q,u,y,h,{zoom:d.zoom},a.properties)}};if("line"===C)for(var F=0,G=v(a.geometry,0,0,m,m);F<G.length;F+=1)for(var I=G[F],J=p(I,r,w,b[H.vertical]||b[H.horizontal],c,24,n,d.overscaling,m),K=0,L=J;K<L.length;K+=1){var M=L[K],N=b[H.horizontal];N&&d.anchorIsTooClose(N.text,D,M)||E(I,M)}else if("Polygon"===a.type)for(var O=0,P=B(a.geometry,0);O<P.length;O+=1){var Q=P[O],R=A(Q,16);E(Q[0],new o(R.x,R.y,0))}else if("LineString"===a.type)for(var S=0,T=a.geometry;S<T.length;S+=1){var U=T[S];E(U,new o(U[0].x,U[0].y,0))}else if("Point"===a.type)for(var V=0,W=a.geometry;V<W.length;V+=1)for(var X=W[V],Y=0,Z=X;Y<Z.length;Y+=1){var $=Z[Y];E([$],new o($.x,$.y,0))}},R.prototype.anchorIsTooClose=function(a,b,c){var d=this.compareText;if(a in d){for(var e=d[a],f=e.length-1;f>=0;f--)if(c.dist(e[f])<b)return!0}else d[a]=[];return d[a].push(c),!1},R.prototype.place=function(a,b){var c=this;this.createArrays(),this.placedGlyphArray=new K,this.placedIconArray=new K,this.glyphOffsetArray=new L,this.lineVertexArray=new M;var d=this.layers[0],e=d.layout,f=a.maxScale,g="map"===e["text-rotation-alignment"]&&"line"===e["symbol-placement"],i="map"===e["icon-rotation-alignment"]&&"line"===e["symbol-placement"];if(e["text-allow-overlap"]||e["icon-allow-overlap"]||e["text-ignore-placement"]||e["icon-ignore-placement"]){var j=a.angle,k=Math.sin(j),l=Math.cos(j);this.symbolInstances.sort(function(a,b){return(k*a.anchor.x+l*a.anchor.y|0)-(k*b.anchor.x+l*b.anchor.y|0)||b.featureIndex-a.featureIndex})}for(var m=0,n=c.symbolInstances;m<n.length;m+=1){var o=n[m],p={boxStartIndex:o.textBoxStartIndex,boxEndIndex:o.textBoxEndIndex},q={boxStartIndex:o.iconBoxStartIndex,boxEndIndex:o.iconBoxEndIndex},r=!(o.textBoxStartIndex===o.textBoxEndIndex),s=!(o.iconBoxStartIndex===o.iconBoxEndIndex),t=e["text-optional"]||!r,u=e["icon-optional"]||!s,v=r?a.placeCollisionFeature(p,e["text-allow-overlap"],e["symbol-avoid-edges"]):a.minScale,w=s?a.placeCollisionFeature(q,e["icon-allow-overlap"],e["symbol-avoid-edges"]):a.minScale;if(t||u?!u&&v?v=Math.max(w,v):!t&&w&&(w=Math.max(w,v)):w=v=Math.max(w,v),r||s){for(var x=o.line,y=c.lineVertexArray.length,z=0;z<x.length;z++)c.lineVertexArray.emplaceBack(x[z].x,x[z].y);var A=c.lineVertexArray.length-y;if(r&&(a.insertCollisionFeature(p,v,e["text-ignore-placement"]),v<=f)){var B=h(d,c.zoom,c.textSizeData.coveringZoomRange,"text-size",o.featureProperties);c.addSymbols(c.arrays.glyph,o.glyphQuads,v,B,e["text-keep-upright"],o.textOffset,g,a.angle,o.featureProperties,o.writingModes,o.anchor,y,A,c.placedGlyphArray)}if(s&&(a.insertCollisionFeature(q,w,e["icon-ignore-placement"]),w<=f)){var C=h(d,c.zoom,c.iconSizeData.coveringZoomRange,"icon-size",o.featureProperties);c.addSymbols(c.arrays.icon,o.iconQuads,w,C,e["icon-keep-upright"],o.iconOffset,i,a.angle,o.featureProperties,null,o.anchor,y,A,c.placedIconArray)}}}b&&this.addToDebugBuffers(a)},R.prototype.addSymbols=function(a,b,c,f,g,h,i,j,k,l,m,n,o,p){for(var q=this,r=a.elementArray,s=a.layoutVertexArray,t=a.dynamicLayoutVertexArray,u=this.zoom,v=Math.max(Math.log(c)/Math.LN2+u,0),w=this.glyphOffsetArray.length,x=(m.angle+j+2*Math.PI)%(2*Math.PI),y=x>1*Math.PI/4&&x<=3*Math.PI/4||x>5*Math.PI/4&&x<=7*Math.PI/4,z=Boolean(l&H.vertical)&&y,A=0,B=b;A<B.length;A+=1){var C=B[A];if(!i||!g||C.writingMode===H.vertical===z){var D=C.tl,E=C.tr,F=C.bl,G=C.br,I=C.tex,J=a.prepareSegment(4),K=J.vertexLength,L=C.glyphOffset[1];d(s,m.x,m.y,D.x,L+D.y,I.x,I.y,f),d(s,m.x,m.y,E.x,L+E.y,I.x+I.w,I.y,f),d(s,m.x,m.y,F.x,L+F.y,I.x,I.y+I.h,f),d(s,m.x,m.y,G.x,L+G.y,I.x+I.w,I.y+I.h,f),e(t,m,0,v),r.emplaceBack(K,K+1,K+2),r.emplaceBack(K+1,K+2,K+3),J.vertexLength+=4,J.primitiveLength+=2,q.glyphOffsetArray.emplaceBack(C.glyphOffset[0])}}p.emplaceBack(m.x,m.y,w,this.glyphOffsetArray.length-w,n,o,m.segment,f?f[0]:0,f?f[1]:0,h[0],h[1],v,z),a.populatePaintArrays(k)},R.prototype.addToDebugBuffers=function(a){for(var b=this,c=this.arrays.collisionBox,d=c.layoutVertexArray,e=c.elementArray,g=-a.angle,h=a.yStretch,j=0,k=b.symbolInstances;j<k.length;j+=1){var l=k[j];l.textCollisionFeature={boxStartIndex:l.textBoxStartIndex,boxEndIndex:l.textBoxEndIndex},l.iconCollisionFeature={boxStartIndex:l.iconBoxStartIndex,boxEndIndex:l.iconBoxEndIndex};for(var m=0;m<2;m++){var n=l[0===m?"textCollisionFeature":"iconCollisionFeature"];if(n)for(var o=n.boxStartIndex;o<n.boxEndIndex;o++){var p=b.collisionBoxArray.get(o);if(!(1===a.perspectiveRatio&&p.maxScale<1)){var q=p.anchorPoint,r=new i(p.x1,p.y1*h)._rotate(g),s=new i(p.x2,p.y1*h)._rotate(g),t=new i(p.x1,p.y2*h)._rotate(g),u=new i(p.x2,p.y2*h)._rotate(g),v=Math.max(0,Math.min(25,b.zoom+Math.log(p.maxScale)/Math.LN2)),w=Math.max(0,Math.min(25,b.zoom+Math.log(p.placementScale)/Math.LN2)),x=c.prepareSegment(4),y=x.vertexLength;f(d,q,l.anchor,r,v,w),f(d,q,l.anchor,s,v,w),f(d,q,l.anchor,u,v,w),f(d,q,l.anchor,t,v,w),e.emplaceBack(y,y+1),e.emplaceBack(y+1,y+2),e.emplaceBack(y+2,y+3),e.emplaceBack(y+3,y),x.vertexLength+=4,x.primitiveLength+=4}}}}},R.prototype.addSymbolInstance=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u,v,x=[],y=[];for(var A in c){var B=parseInt(A,10);c[B]&&(y=y.concat(f?I(a,c[B],e,m,s,t):[]),u=new z(g,b,a,h,i,j,c[B],k,l,m,!1))}var C=u?u.boxStartIndex:this.collisionBoxArray.length,D=u?u.boxEndIndex:this.collisionBoxArray.length;d&&(x=f?J(a,d,e,q,c[H.horizontal],s,t):[],v=new z(g,b,a,h,i,j,d,o,p,q,!0));var E=v?v.boxStartIndex:this.collisionBoxArray.length,F=v?v.boxEndIndex:this.collisionBoxArray.length;D>R.MAX_INSTANCES&&w.warnOnce("Too many symbols being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),F>R.MAX_INSTANCES&&w.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var G=(c[H.vertical]?H.vertical:0)|(c[H.horizontal]?H.horizontal:0);this.symbolInstances.push({textBoxStartIndex:C,textBoxEndIndex:D,iconBoxStartIndex:E,iconBoxEndIndex:F,glyphQuads:y,iconQuads:x,textOffset:n,iconOffset:r,anchor:a,line:b,featureIndex:h,featureProperties:t,writingModes:G})},R.programInterfaces=Q,R.MAX_INSTANCES=65535,R.addDynamicAttributes=e,b.exports=R},{"../../shaders/encode_attribute":90,"../../symbol/anchor":160,"../../symbol/clip_line":162,"../../symbol/collision_feature":164,"../../symbol/get_anchors":166,"../../symbol/mergelines":169,"../../symbol/quads":171,"../../symbol/shaping":172,"../../symbol/transform_text":175,"../../util/classify_rings":200,"../../util/find_pole_of_inaccessibility":206,"../../util/script_detection":213,"../../util/struct_array":215,"../../util/token":217,"../../util/util":218,"../../util/verticalize_punctuation":220,"../array_group":54,"../buffer_group":62,"../element_array_type":63,"../extent":64,"../load_geometry":66,"point-geometry":36,"vector-tile":44}],61:[function(a,b,c){"use strict";var d={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},e=function(a,b,c,d){this.arrayBuffer=a.arrayBuffer,this.length=a.length,this.attributes=b.members,this.itemSize=b.bytesPerElement,this.type=c,this.arrayType=b,this.dynamicDraw=d};e.fromStructArray=function(a,b){return new e(a.serialize(),a.constructor.serialize(),b)},e.prototype.bind=function(a){var b=a[this.type];this.buffer?(a.bindBuffer(b,this.buffer),this.dynamicDraw&&this.arrayBuffer&&(a.bufferSubData(b,0,this.arrayBuffer),this.arrayBuffer=null)):(this.gl=a,this.buffer=a.createBuffer(),a.bindBuffer(b,this.buffer),a.bufferData(b,this.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.arrayBuffer=null)},e.prototype.updateData=function(a){this.arrayBuffer=a.arrayBuffer},e.prototype.enableAttributes=function(a,b){for(var c=this,d=0;d<this.attributes.length;d++){var e=c.attributes[d],f=b[e.name];void 0!==f&&a.enableVertexAttribArray(f)}},e.prototype.setVertexAttribPointers=function(a,b,c){for(var e=this,f=0;f<this.attributes.length;f++){var g=e.attributes[f],h=b[g.name];void 0!==h&&a.vertexAttribPointer(h,g.components,a[d[g.type]],!1,e.arrayType.bytesPerElement,g.offset+(e.arrayType.bytesPerElement*c||0))}},e.prototype.destroy=function(){this.buffer&&this.gl.deleteBuffer(this.buffer)},e.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"},b.exports=e},{}],62:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("./buffer"),f=a("./program_configuration"),g=a("./vertex_array_type"),h=a("../render/vertex_array_object"),i=function(a,b,c,i){var j=this,k=g(a.layoutAttributes);if(this.layoutVertexBuffer=new e(i.layoutVertexArray,k.serialize(),e.BufferType.VERTEX),i.dynamicLayoutVertexArray&&a.dynamicLayoutAttributes){var l=g(a.dynamicLayoutAttributes);this.dynamicLayoutVertexArray=new l(i.dynamicLayoutVertexArray),this.dynamicLayoutVertexBuffer=new e(i.dynamicLayoutVertexArray,l.serialize(),e.BufferType.VERTEX,!0)}i.elementArray&&a.elementArrayType&&(this.elementBuffer=new e(i.elementArray,a.elementArrayType.serialize(),e.BufferType.ELEMENT)),i.elementArray2&&a.elementArrayType2&&(this.elementBuffer2=new e(i.elementArray2,a.elementArrayType2.serialize(),e.BufferType.ELEMENT)),this.layerData={};for(var m=0,n=b;m<n.length;m+=1){var o=n[m],p=i.paintVertexArrays&&i.paintVertexArrays[o.id],q=f.createDynamic(a,o,c),r=p?new e(p.array,p.type,e.BufferType.VERTEX):null;j.layerData[o.id]={programConfiguration:q,paintVertexBuffer:r}}this.segments=i.segments,this.segments2=i.segments2;for(var s=0,t=[j.segments,j.segments2];s<t.length;s+=1)for(var u=t[s],v=0,w=u||[];v<w.length;v+=1){var x=w[v];x.vaos=d.mapObject(j.layerData,function(){return new h})}};i.prototype.destroy=function(){var a=this;this.layoutVertexBuffer.destroy(),this.dynamicLayoutVertexBuffer&&this.dynamicLayoutVertexBuffer.destroy(),this.elementBuffer&&this.elementBuffer.destroy(),this.elementBuffer2&&this.elementBuffer2.destroy();for(var b in a.layerData){var c=a.layerData[b].paintVertexBuffer;c&&c.destroy()}for(var d=0,e=[a.segments,a.segments2];d<e.length;d+=1)for(var f=e[d],g=0,h=f||[];g<h.length;g+=1){var i=h[g];for(var j in i.vaos)i.vaos[j].destroy()}},b.exports=i},{"../render/vertex_array_object":89,"../util/util":218,"./buffer":61,"./program_configuration":68,"./vertex_array_type":70}],63:[function(a,b,c){"use strict";function d(a){return e({members:[{type:"Uint16",name:"vertices",components:a||3}]})}var e=a("../util/struct_array");b.exports=d},{"../util/struct_array":215}],64:[function(a,b,c){"use strict";b.exports=8192},{}],65:[function(a,b,c){"use strict";function d(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function e(a,b){return b-a}function f(a,b){return b>0?b+2*a:a}function g(a,b,c,d,e){if(!b[0]&&!b[1])return a;b=i.convert(b),"viewport"===c&&b._rotate(-d);for(var f=[],g=0;g<a.length;g++){for(var h=a[g],j=[],k=0;k<h.length;k++)j.push(h[k].sub(b._mult(e)));f.push(j)}return f}function h(a,b){for(var c=[],d=new i(0,0),e=0;e<a.length;e++){for(var f=a[e],g=[],h=0;h<f.length;h++){var j=f[h-1],k=f[h],l=f[h+1],m=0===h?d:k.sub(j)._unit()._perp(),n=h===f.length-1?d:l.sub(k)._unit()._perp(),o=m._add(n)._unit(),p=o.x*n.x+o.y*n.y;o._mult(1/p),g.push(o._mult(b)._add(k))}c.push(g)}return c}var i=a("point-geometry"),j=a("./load_geometry"),k=a("./extent"),l=a("../style-spec/feature_filter"),m=a("../util/struct_array"),n=a("grid-index"),o=a("../util/dictionary_coder"),p=a("vector-tile"),q=a("pbf"),r=a("../util/vectortile_to_geojson"),s=a("../util/util").arraysIntersect,t=a("../util/intersection_tests"),u=t.multiPolygonIntersectsBufferedMultiPoint,v=t.multiPolygonIntersectsMultiPolygon,w=t.multiPolygonIntersectsBufferedMultiLine,x=m({members:[{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]}),y=function(a,b,c,d){this.coord=a,this.overscaling=b,this.x=a.x,this.y=a.y,this.z=a.z-Math.log(b)/Math.LN2,this.grid=c||new n(k,16,0),this.featureIndexArray=d||new x};y.deserialize=function(a,b,c){var d=new y(a.coord,a.overscaling,new n(a.grid),new x(a.featureIndexArray));return d.rawTileData=b,d.bucketLayerIDs=a.bucketLayerIDs,d.paintPropertyStatistics=a.paintPropertyStatistics,d.setCollisionTile(c),d},y.prototype.insert=function(a,b,c,d){var e=this,f=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(b,c,d);for(var g=j(a),h=0;h<g.length;h++){for(var i=g[h],k=[1/0,1/0,-1/0,-1/0],l=0;l<i.length;l++){var m=i[l];k[0]=Math.min(k[0],m.x),k[1]=Math.min(k[1],m.y),k[2]=Math.max(k[2],m.x),k[3]=Math.max(k[3],m.y)}e.grid.insert(f,k[0],k[1],k[2],k[3])}},y.prototype.setCollisionTile=function(a){this.collisionTile=a},y.prototype.serialize=function(a){var b=this.grid.toArrayBuffer();return a&&a.push(b),{coord:this.coord,overscaling:this.overscaling,grid:b,featureIndexArray:this.featureIndexArray.serialize(a),bucketLayerIDs:this.bucketLayerIDs,paintPropertyStatistics:this.paintPropertyStatistics}},y.prototype.query=function(a,b){var c=this;this.vtLayers||(this.vtLayers=new p.VectorTile(new q(this.rawTileData)).layers,this.sourceLayerCoder=new o(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));var g={},h=a.params||{},j=k/a.tileSize/a.scale,m=l(h.filter),n=0;for(var r in b)if(c.hasLayer(r)){var s=b[r],t=0;if("line"===s.type){var u=f(c.getPaintValue("line-width",s),c.getPaintValue("line-gap-width",s)),v=c.getPaintValue("line-offset",s),w=c.getPaintValue("line-translate",s);t=u/2+Math.abs(v)+d(w)}else"fill"===s.type?t=d(c.getPaintValue("fill-translate",s)):"fill-extrusion"===s.type?t=d(c.getPaintValue("fill-extrusion-translate",s)):"circle"===s.type&&(t=c.getPaintValue("circle-radius",s)+d(c.getPaintValue("circle-translate",s)));n=Math.max(n,t*j)}for(var x=a.queryGeometry.map(function(a){return a.map(function(a){return new i(a.x,a.y)})}),y=1/0,z=1/0,A=-1/0,B=-1/0,C=0;C<x.length;C++)for(var D=x[C],E=0;E<D.length;E++){var F=D[E];y=Math.min(y,F.x),z=Math.min(z,F.y),A=Math.max(A,F.x),B=Math.max(B,F.y)}var G=this.grid.query(y-n,z-n,A+n,B+n);G.sort(e),this.filterMatching(g,G,this.featureIndexArray,x,m,h.layers,b,a.bearing,j);var H=this.collisionTile.queryRenderedSymbols(x,a.scale);return H.sort(),this.filterMatching(g,H,this.collisionTile.collisionBoxArray,x,m,h.layers,b,a.bearing,j),g},y.prototype.filterMatching=function(a,b,c,d,e,i,k,l,m){for(var n,o=this,p=0;p<b.length;p++){var q=b[p];if(q!==n){n=q;var t=c.get(q),x=o.bucketLayerIDs[t.bucketIndex];if(!i||s(i,x)){var y=o.sourceLayerCoder.decode(t.sourceLayerIndex),z=o.vtLayers[y],A=z.feature(t.featureIndex);if(e(A))for(var B=null,C=0;C<x.length;C++){var D=x[C];if(!(i&&i.indexOf(D)<0)){var E=k[D];if(E){var F=void 0;if("symbol"!==E.type)if(B||(B=j(A)),"line"===E.type){F=g(d,o.getPaintValue("line-translate",E,A),o.getPaintValue("line-translate-anchor",E,A),l,m);var G=m/2*f(o.getPaintValue("line-width",E,A),o.getPaintValue("line-gap-width",E,A)),H=o.getPaintValue("line-offset",E,A);if(H&&(B=h(B,H*m)),!w(F,B,G))continue}else if("fill"===E.type||"fill-extrusion"===E.type){var I=E.type;if(F=g(d,o.getPaintValue(I+"-translate",E,A),o.getPaintValue(I+"-translate-anchor",E,A),l,m),!v(F,B))continue}else if("circle"===E.type){F=g(d,o.getPaintValue("circle-translate",E,A),o.getPaintValue("circle-translate-anchor",E,A),l,m);var J=o.getPaintValue("circle-radius",E,A)*m;if(!u(F,B,J))continue}var K=new r(A,o.z,o.x,o.y);K.layer=E.serialize();var L=a[D];void 0===L&&(L=a[D]=[]),L.push({featureIndex:q,feature:K})}}}}}}},y.prototype.hasLayer=function(a){for(var b=this,c=0,d=b.bucketLayerIDs;c<d.length;c+=1)for(var e=d[c],f=0,g=e;f<g.length;f+=1){var h=g[f];if(a===h)return!0}return!1},y.prototype.getPaintValue=function(a,b,c){if(b.isPaintValueFeatureConstant(a)||c){var d=c?c.properties:{};return b.getPaintValue(a,{zoom:this.z},d)}return this.paintPropertyStatistics[b.id][a].max},b.exports=y},{"../style-spec/feature_filter":115,"../util/dictionary_coder":202,"../util/intersection_tests":209,"../util/struct_array":215,"../util/util":218,"../util/vectortile_to_geojson":219,"./extent":64,"./load_geometry":66,"grid-index":19,pbf:35,"point-geometry":36,"vector-tile":44}],66:[function(a,b,c){"use strict";function d(a){return{min:-1*Math.pow(2,a-1),max:Math.pow(2,a-1)-1}}var e=a("../util/util"),f=a("./extent"),g={15:d(15),16:d(16)};b.exports=function(a,b){for(var c=g[b||16],d=f/a.extent,h=a.loadGeometry(),i=0;i<h.length;i++)for(var j=h[i],k=0;k<j.length;k++){var l=j[k];l.x=Math.round(l.x*d),l.y=Math.round(l.y*d),(l.x<c.min||l.x>c.max||l.y<c.min||l.y>c.max)&&e.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return h}},{"../util/util":218,"./extent":64}],67:[function(a,b,c){"use strict";var d=a("../util/struct_array"),e=d({members:[{name:"a_pos",type:"Int16",components:2}]});b.exports=e},{"../util/struct_array":215}],68:[function(a,b,c){"use strict";function d(a){return[g(255*a[0],255*a[1]),g(255*a[2],255*a[3])]}var e=a("./vertex_array_type"),f=a("../style-spec/function").interpolationFactor,g=a("../shaders/encode_attribute").packUint8ToFloat,h=function(a,b,c,d){this.name=a,this.type=b,this.property=c,this.useIntegerZoom=d};h.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},h.prototype.populatePaintArray=function(){},h.prototype.setUniforms=function(a,b,c,d){var e=d.zoom,f=c.getPaintValue(this.property,{zoom:this.useIntegerZoom?Math.floor(e):e});"color"===this.type?a.uniform4fv(b["u_"+this.name],f):a.uniform1f(b["u_"+this.name],f)};var i=function(a,b,c){this.name=a,this.type=b,this.property=c};i.prototype.defines=function(){return[]},i.prototype.populatePaintArray=function(a,b,c,e,f,g){var h=this,i=a.getPaintValue(this.property,void 0,g);if("color"===this.type)for(var j=d(i),k=e;k<f;k++){var l=b.get(k);l["a_"+h.name+"0"]=j[0],l["a_"+h.name+"1"]=j[1]}else{for(var m=e;m<f;m++)b.get(m)["a_"+h.name]=i;var n=c[this.property];n.max=Math.max(n.max,i)}},i.prototype.setUniforms=function(a,b){a.uniform1f(b["a_"+this.name+"_t"],0)};var j=function(a,b,c,d,e){this.name=a,this.type=b,this.property=c,this.useIntegerZoom=d,this.zoom=e};j.prototype.defines=function(){return[]},j.prototype.populatePaintArray=function(a,b,c,e,f,g){var h=this,i=a.getPaintValue(this.property,{zoom:this.zoom},g),j=a.getPaintValue(this.property,{zoom:this.zoom+1},g);if("color"===this.type)for(var k=d(i),l=d(j),m=e;m<f;m++){var n=b.get(m);n["a_"+h.name+"0"]=k[0],n["a_"+h.name+"1"]=k[1],n["a_"+h.name+"2"]=l[0],n["a_"+h.name+"3"]=l[1]}else{for(var o=e;o<f;o++){var p=b.get(o);p["a_"+h.name+"0"]=i,p["a_"+h.name+"1"]=j}var q=c[this.property];q.max=Math.max(q.max,i,j)}},j.prototype.setUniforms=function(a,b,c,d){var e=d.zoom,g=f(this.useIntegerZoom?Math.floor(e):e,1,this.zoom,this.zoom+1);a.uniform1f(b["a_"+this.name+"_t"],g)};var k=function(){this.binders={},this.cacheKey=""};k.createDynamic=function(a,b,c){for(var d=new k,f=[],g=0,l=a.paintAttributes||[];g<l.length;g+=1){var m=l[g],n=m.property,o=m.useIntegerZoom||!1,p=m.name||n.replace(b.type+"-","").replace(/-/g,"_"),q=b._paintSpecifications[n].type;b.isPaintValueFeatureConstant(n)?(d.binders[p]=new h(p,q,n,o),d.cacheKey+="/u_"+p):b.isPaintValueZoomConstant(n)?(d.binders[p]=new i(p,q,n),d.cacheKey+="/a_"+p,f.push({name:"a_"+p,type:"Float32",components:"color"===q?2:1})):(d.binders[p]=new j(p,q,n,o,c),d.cacheKey+="/z_"+p,f.push({name:"a_"+p,type:"Float32",components:"color"===q?4:2}))}return d.PaintVertexArray=e(f),d.interface=a,d},k.createBasicFill=function(){var a=new k;return a.binders.color=new h("color","color","fill-color",!1),a.cacheKey+="/u_color",a.binders.opacity=new h("opacity","number","fill-opacity",!1),a.cacheKey+="/u_opacity",a},k.prototype.createPaintPropertyStatistics=function(){var a=this,b={};for(var c in a.binders)b[a.binders[c].property]={max:-1/0};return b},k.prototype.populatePaintArray=function(a,b,c,d,e){var f=this,g=b.length;b.resize(d);for(var h in f.binders)f.binders[h].populatePaintArray(a,b,c,g,d,e)},k.prototype.defines=function(){var a=this,b=[];for(var c in a.binders)b.push.apply(b,a.binders[c].defines());return b},k.prototype.setUniforms=function(a,b,c,d){var e=this;for(var f in e.binders)e.binders[f].setUniforms(a,b,c,d)},b.exports=k},{"../shaders/encode_attribute":90,"../style-spec/function":117,"./vertex_array_type":70}],69:[function(a,b,c){"use strict";var d=a("../util/struct_array"),e=d({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]});b.exports=e},{"../util/struct_array":215}],70:[function(a,b,c){"use strict";function d(a){return e({members:a,alignment:4})}var e=a("../util/struct_array");b.exports=d},{"../util/struct_array":215}],71:[function(a,b,c){"use strict";var d=function(a,b,c){this.column=a,this.row=b,this.zoom=c};d.prototype.clone=function(){return new d(this.column,this.row,this.zoom)},d.prototype.zoomTo=function(a){return this.clone()._zoomTo(a)},d.prototype.sub=function(a){return this.clone()._sub(a)},d.prototype._zoomTo=function(a){var b=Math.pow(2,a-this.zoom);return this.column*=b,this.row*=b,this.zoom=a,this},d.prototype._sub=function(a){return a=a.zoomTo(this.zoom),this.column-=a.column,this.row-=a.row,this},b.exports=d},{}],72:[function(a,b,c){"use strict";var d=a("../util/util").wrap,e=function(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};e.prototype.wrap=function(){return new e(d(this.lng,-180,180),this.lat)},e.prototype.toArray=function(){return[this.lng,this.lat]},e.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},e.prototype.toBounds=function(b){var c=360*b/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new(a("./lng_lat_bounds"))(new e(this.lng-d,this.lat-c),new e(this.lng+d,this.lat+c))},e.convert=function(a){
if(a instanceof e)return a;if(Array.isArray(a)&&2===a.length)return new e(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new e(Number(a.lng),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")},b.exports=e},{"../util/util":218,"./lng_lat_bounds":73}],73:[function(a,b,c){"use strict";var d=a("./lng_lat"),e=function(a,b){a&&(b?this.setSouthWest(a).setNorthEast(b):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};e.prototype.setNorthEast=function(a){return this._ne=a instanceof d?new d(a.lng,a.lat):d.convert(a),this},e.prototype.setSouthWest=function(a){return this._sw=a instanceof d?new d(a.lng,a.lat):d.convert(a),this},e.prototype.extend=function(a){var b,c,f=this._sw,g=this._ne;if(a instanceof d)b=a,c=a;else{if(!(a instanceof e))return Array.isArray(a)?a.every(Array.isArray)?this.extend(e.convert(a)):this.extend(d.convert(a)):this;if(b=a._sw,c=a._ne,!b||!c)return this}return f||g?(f.lng=Math.min(b.lng,f.lng),f.lat=Math.min(b.lat,f.lat),g.lng=Math.max(c.lng,g.lng),g.lat=Math.max(c.lat,g.lat)):(this._sw=new d(b.lng,b.lat),this._ne=new d(c.lng,c.lat)),this},e.prototype.getCenter=function(){return new d((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},e.prototype.getSouthWest=function(){return this._sw},e.prototype.getNorthEast=function(){return this._ne},e.prototype.getNorthWest=function(){return new d(this.getWest(),this.getNorth())},e.prototype.getSouthEast=function(){return new d(this.getEast(),this.getSouth())},e.prototype.getWest=function(){return this._sw.lng},e.prototype.getSouth=function(){return this._sw.lat},e.prototype.getEast=function(){return this._ne.lng},e.prototype.getNorth=function(){return this._ne.lat},e.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},e.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},e.convert=function(a){return!a||a instanceof e?a:new e(a)},b.exports=e},{"./lng_lat":72}],74:[function(a,b,c){"use strict";var d=a("./lng_lat"),e=a("point-geometry"),f=a("./coordinate"),g=a("../util/util"),h=a("../style-spec/util/interpolate"),i=a("../source/tile_coord"),j=a("../data/extent"),k=a("@mapbox/gl-matrix"),l=k.vec4,m=k.mat4,n=k.mat2,o=function(a,b,c){this.tileSize=512,this._renderWorldCopies=void 0===c||c,this._minZoom=a||0,this._maxZoom=b||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new d(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0},p={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};p.minZoom.get=function(){return this._minZoom},p.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},p.maxZoom.get=function(){return this._maxZoom},p.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},p.renderWorldCopies.get=function(){return this._renderWorldCopies},p.worldSize.get=function(){return this.tileSize*this.scale},p.centerPoint.get=function(){return this.size._div(2)},p.size.get=function(){return new e(this.width,this.height)},p.bearing.get=function(){return-this.angle/Math.PI*180},p.bearing.set=function(a){var b=-g.wrap(a,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=n.create(),n.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},p.pitch.get=function(){return this._pitch/Math.PI*180},p.pitch.set=function(a){var b=g.clamp(a,0,60)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())},p.fov.get=function(){return this._fov/Math.PI*180},p.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},p.zoom.get=function(){return this._zoom},p.zoom.set=function(a){var b=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())},p.center.get=function(){return this._center},p.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},o.prototype.coveringZoomLevel=function(a){return(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize))},o.prototype.getVisibleWrappedCoordinates=function(a){for(var b=this.pointCoordinate(new e(0,0),0),c=this.pointCoordinate(new e(this.width,0),0),d=Math.floor(b.column),f=Math.floor(c.column),g=[a],h=d;h<=f;h++)0!==h&&g.push(new i(a.z,a.x,a.y,h));return g},o.prototype.coveringTiles=function(a){var b=this.coveringZoomLevel(a),c=b;if(b<a.minzoom)return[];b>a.maxzoom&&(b=a.maxzoom);var d=this.pointCoordinate(this.centerPoint,b),f=new e(d.column-.5,d.row-.5),g=[this.pointCoordinate(new e(0,0),b),this.pointCoordinate(new e(this.width,0),b),this.pointCoordinate(new e(this.width,this.height),b),this.pointCoordinate(new e(0,this.height),b)];return i.cover(b,g,a.reparseOverscaled?c:b,this._renderWorldCopies).sort(function(a,b){return f.dist(a)-f.dist(b)})},o.prototype.resize=function(a,b){this.width=a,this.height=b,this.pixelsToGLUnits=[2/a,-2/b],this._constrain(),this._calcMatrices()},p.unmodified.get=function(){return this._unmodified},o.prototype.zoomScale=function(a){return Math.pow(2,a)},o.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},o.prototype.project=function(a){return new e(this.lngX(a.lng),this.latY(a.lat))},o.prototype.unproject=function(a){return new d(this.xLng(a.x),this.yLat(a.y))},p.x.get=function(){return this.lngX(this.center.lng)},p.y.get=function(){return this.latY(this.center.lat)},p.point.get=function(){return new e(this.x,this.y)},o.prototype.lngX=function(a){return(180+a)*this.worldSize/360},o.prototype.latY=function(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))*this.worldSize/360},o.prototype.xLng=function(a){return 360*a/this.worldSize-180},o.prototype.yLat=function(a){var b=180-360*a/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(b*Math.PI/180))-90},o.prototype.setLocationAtPoint=function(a,b){var c=this.pointCoordinate(b)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(a)._sub(c)),this._renderWorldCopies&&(this.center=this.center.wrap())},o.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},o.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},o.prototype.locationCoordinate=function(a){return new f(this.lngX(a.lng)/this.tileSize,this.latY(a.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},o.prototype.coordinateLocation=function(a){var b=a.zoomTo(this.zoom);return new d(this.xLng(b.column*this.tileSize),this.yLat(b.row*this.tileSize))},o.prototype.pointCoordinate=function(a,b){void 0===b&&(b=this.tileZoom);var c=[a.x,a.y,0,1],d=[a.x,a.y,1,1];l.transformMat4(c,c,this.pixelMatrixInverse),l.transformMat4(d,d,this.pixelMatrixInverse);var e=c[3],g=d[3],i=c[0]/e,j=d[0]/g,k=c[1]/e,m=d[1]/g,n=c[2]/e,o=d[2]/g,p=n===o?0:(0-n)/(o-n);return new f(h(i,j,p)/this.tileSize,h(k,m,p)/this.tileSize,this.zoom)._zoomTo(b)},o.prototype.coordinatePoint=function(a){var b=a.zoomTo(this.zoom),c=[b.column*this.tileSize,b.row*this.tileSize,0,1];return l.transformMat4(c,c,this.pixelMatrix),new e(c[0]/c[3],c[1]/c[3])},o.prototype.calculatePosMatrix=function(a,b){var c=a.toCoordinate(b),d=this.worldSize/this.zoomScale(c.zoom),e=m.identity(new Float64Array(16));return m.translate(e,e,[c.column*d,c.row*d,0]),m.scale(e,e,[d/j,d/j,1]),m.multiply(e,this.projMatrix,e),new Float32Array(e)},o.prototype.cameraToTileDistance=function(a){var b=this.calculatePosMatrix(a.coord,a.sourceMaxZoom),c=[a.tileSize/2,a.tileSize/2,0,1];return l.transformMat4(c,c,b),c[3]},o.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var a,b,c,d,f=-90,g=90,h=-180,i=180,j=this.size,k=this._unmodified;if(this.latRange){var l=this.latRange;f=this.latY(l[1]),g=this.latY(l[0]),a=g-f<j.y?j.y/(g-f):0}if(this.lngRange){var m=this.lngRange;h=this.lngX(m[0]),i=this.lngX(m[1]),b=i-h<j.x?j.x/(i-h):0}var n=Math.max(b||0,a||0);if(n)return this.center=this.unproject(new e(b?(i+h)/2:this.x,a?(g+f)/2:this.y)),this.zoom+=this.scaleZoom(n),this._unmodified=k,void(this._constraining=!1);if(this.latRange){var o=this.y,p=j.y/2;o-p<f&&(d=f+p),o+p>g&&(d=g-p)}if(this.lngRange){var q=this.x,r=j.x/2;q-r<h&&(c=h+r),q+r>i&&(c=i-r)}void 0===c&&void 0===d||(this.center=this.unproject(new e(void 0!==c?c:this.x,void 0!==d?d:this.y))),this._unmodified=k,this._constraining=!1}},o.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=this._fov/2,b=Math.PI/2+this._pitch,c=Math.sin(a)*this.cameraToCenterDistance/Math.sin(Math.PI-b-a),d=Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance,e=1.01*d,f=new Float64Array(16);m.perspective(f,this._fov,this.width/this.height,1,e),m.scale(f,f,[1,-1,1]),m.translate(f,f,[0,0,-this.cameraToCenterDistance]),m.rotateX(f,f,this._pitch),m.rotateZ(f,f,this.angle),m.translate(f,f,[-this.x,-this.y,0]);var g=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));if(m.scale(f,f,[1,1,g,1]),this.projMatrix=f,f=m.create(),m.scale(f,f,[this.width/2,-this.height/2,1]),m.translate(f,f,[1,-1,0]),this.pixelMatrix=m.multiply(new Float64Array(16),f,this.projMatrix),!(f=m.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=f}},Object.defineProperties(o.prototype,p),b.exports=o},{"../data/extent":64,"../source/tile_coord":106,"../style-spec/util/interpolate":123,"../util/util":218,"./coordinate":71,"./lng_lat":72,"@mapbox/gl-matrix":1,"point-geometry":36}],75:[function(a,b,c){"use strict";var d=a("mapbox-gl-supported"),e=a("./util/browser"),f=a("../package.json").version,g=a("./ui/map"),h=a("./ui/control/navigation_control"),i=a("./ui/control/geolocate_control"),j=a("./ui/control/attribution_control"),k=a("./ui/control/scale_control"),l=a("./ui/control/fullscreen_control"),m=a("./ui/popup"),n=a("./ui/marker"),o=a("./style/style"),p=a("./geo/lng_lat"),q=a("./geo/lng_lat_bounds"),r=a("point-geometry"),s=a("./util/evented"),t=a("./util/config"),u=a("./source/rtl_text_plugin");b.exports={version:f,supported:d,workerCount:Math.max(Math.floor(e.hardwareConcurrency/2),1),setRTLTextPlugin:u.setRTLTextPlugin,Map:g,NavigationControl:h,GeolocateControl:i,AttributionControl:j,ScaleControl:k,FullscreenControl:l,Popup:m,Marker:n,Style:o,LngLat:p,LngLatBounds:q,Point:r,Evented:s,config:t,get accessToken(){return t.ACCESS_TOKEN},set accessToken(a){t.ACCESS_TOKEN=a}}},{"../package.json":53,"./geo/lng_lat":72,"./geo/lng_lat_bounds":73,"./source/rtl_text_plugin":101,"./style/style":149,"./ui/control/attribution_control":178,"./ui/control/fullscreen_control":179,"./ui/control/geolocate_control":180,"./ui/control/navigation_control":182,"./ui/control/scale_control":183,"./ui/map":192,"./ui/marker":193,"./ui/popup":194,"./util/browser":197,"./util/config":201,"./util/evented":205,"mapbox-gl-supported":33,"point-geometry":36}],76:[function(a,b,c){"use strict";function d(a,b,c){var d=a.gl,f=a.transform,g=f.tileSize,h=c.paint["background-color"],i=c.paint["background-pattern"],j=c.paint["background-opacity"],k=!i&&1===h[3]&&1===j;if(a.isOpaquePass===k){d.disable(d.STENCIL_TEST),a.setDepthSublayer(0);var l;if(i){if(e.isPatternMissing(i,a))return;l=a.useProgram("fillPattern",a.basicFillProgramConfiguration),e.prepare(i,a,l),a.tileExtentPatternVAO.bind(d,l,a.tileExtentBuffer)}else l=a.useProgram("fill",a.basicFillProgramConfiguration),d.uniform4fv(l.u_color,h),a.tileExtentVAO.bind(d,l,a.tileExtentBuffer);d.uniform1f(l.u_opacity,j);for(var m=f.coveringTiles({tileSize:g}),n=0,o=m;n<o.length;n+=1){var p=o[n];i&&e.setTile({coord:p,tileSize:g},a,l),d.uniformMatrix4fv(l.u_matrix,!1,a.transform.calculatePosMatrix(p)),d.drawArrays(d.TRIANGLE_STRIP,0,a.tileExtentBuffer.length)}}}var e=a("./pattern");b.exports=d},{"./pattern":88}],77:[function(a,b,c){"use strict";function d(a,b,c,d){if(!a.isOpaquePass){var g=a.gl;a.setDepthSublayer(0),a.depthMask(!1),g.disable(g.STENCIL_TEST);for(var h=0;h<d.length;h++){var i=d[h],j=b.getTile(i),k=j.getBucket(c);if(k){var l=k.buffers,m=l.layerData[c.id],n=m.programConfiguration,o=a.useProgram("circle",n);if(n.setUniforms(g,o,c,{zoom:a.transform.zoom}),g.uniform1f(o.u_camera_to_center_distance,a.transform.cameraToCenterDistance),g.uniform1i(o.u_scale_with_map,"map"===c.paint["circle-pitch-scale"]),"map"===c.paint["circle-pitch-alignment"]){g.uniform1i(o.u_pitch_with_map,!0);var p=f(j,1,a.transform.zoom);g.uniform2f(o.u_extrude_scale,p,p)}else g.uniform1i(o.u_pitch_with_map,!1),g.uniform2fv(o.u_extrude_scale,a.transform.pixelsToGLUnits);g.uniform1f(o.u_devicepixelratio,e.devicePixelRatio),g.uniformMatrix4fv(o.u_matrix,!1,a.translatePosMatrix(i.posMatrix,j,c.paint["circle-translate"],c.paint["circle-translate-anchor"]));for(var q=0,r=l.segments;q<r.length;q+=1){var s=r[q];s.vaos[c.id].bind(g,o,l.layoutVertexBuffer,l.elementBuffer,m.paintVertexBuffer,s.vertexOffset),g.drawElements(g.TRIANGLES,3*s.primitiveLength,g.UNSIGNED_SHORT,3*s.primitiveOffset*2)}}}}}var e=a("../util/browser"),f=a("../source/pixels_to_tile_units");b.exports=d},{"../source/pixels_to_tile_units":98,"../util/browser":197}],78:[function(a,b,c){"use strict";function d(a,b,c,d){var e=a.gl;e.enable(e.STENCIL_TEST);var f=a.useProgram("collisionBox");e.activeTexture(e.TEXTURE1),a.frameHistory.bind(e),e.uniform1i(f.u_fadetexture,1);for(var g=0;g<d.length;g++){var h=d[g],i=b.getTile(h),j=i.getBucket(c);if(j){var k=j.buffers.collisionBox;if(k){e.uniformMatrix4fv(f.u_matrix,!1,h.posMatrix),a.enableTileClippingMask(h),a.lineWidth(1),e.uniform1f(f.u_scale,Math.pow(2,a.transform.zoom-i.coord.z)),e.uniform1f(f.u_zoom,10*a.transform.zoom);var l=Math.max(0,Math.min(25,i.coord.z+Math.log(i.collisionTile.maxScale)/Math.LN2));e.uniform1f(f.u_maxzoom,10*l),e.uniform1f(f.u_collision_y_stretch,i.collisionTile.yStretch),e.uniform1f(f.u_pitch,a.transform.pitch/360*2*Math.PI),e.uniform1f(f.u_camera_to_center_distance,a.transform.cameraToCenterDistance);for(var m=0,n=k.segments;m<n.length;m+=1){var o=n[m];o.vaos[c.id].bind(e,f,k.layoutVertexBuffer,k.elementBuffer,null,o.vertexOffset),e.drawElements(e.LINES,2*o.primitiveLength,e.UNSIGNED_SHORT,2*o.primitiveOffset*2)}}}}}b.exports=d},{}],79:[function(a,b,c){"use strict";function d(a,b,c){for(var d=0;d<c.length;d++)e(a,b,c[d])}function e(a,b,c){var d=a.gl;d.disable(d.STENCIL_TEST),a.lineWidth(1*g.devicePixelRatio);var e=c.posMatrix,m=a.useProgram("debug");d.uniformMatrix4fv(m.u_matrix,!1,e),d.uniform4f(m.u_color,1,0,0,1),a.debugVAO.bind(d,m,a.debugBuffer),d.drawArrays(d.LINE_STRIP,0,a.debugBuffer.length);for(var n=f(c.toString(),50,200,5),o=new l,p=0;p<n.length;p+=2)o.emplaceBack(n[p],n[p+1]);var q=j.fromStructArray(o,j.BufferType.VERTEX);(new k).bind(d,m,q),d.uniform4f(m.u_color,1,1,1,1);for(var r=b.getTile(c).tileSize,s=i/(Math.pow(2,a.transform.zoom-c.z)*r),t=[[-1,-1],[-1,1],[1,-1],[1,1]],u=0;u<t.length;u++){var v=t[u];d.uniformMatrix4fv(m.u_matrix,!1,h.translate([],e,[s*v[0],s*v[1],0])),d.drawArrays(d.LINES,0,q.length)}d.uniform4f(m.u_color,0,0,0,1),d.uniformMatrix4fv(m.u_matrix,!1,e),d.drawArrays(d.LINES,0,q.length)}function f(a,b,c,d){d=d||1;var e,f,g,h,i,j,k,l,n=[];for(e=0,f=a.length;e<f;e++)if(i=m[a[e]]){for(l=null,g=0,h=i[1].length;g<h;g+=2)-1===i[1][g]&&-1===i[1][g+1]?l=null:(j=b+i[1][g]*d,k=c-i[1][g+1]*d,l&&n.push(l.x,l.y,j,k),l={x:j,y:k});b+=i[0]*d}return n}var g=a("../util/browser"),h=a("@mapbox/gl-matrix").mat4,i=a("../data/extent"),j=a("../data/buffer"),k=a("./vertex_array_object"),l=a("../data/pos_array");b.exports=d;var m={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]}},{"../data/buffer":61,"../data/extent":64,"../data/pos_array":67,"../util/browser":197,"./vertex_array_object":89,"@mapbox/gl-matrix":1}],80:[function(a,b,c){"use strict";function d(a,b,c,d){var h=a.gl;h.enable(h.STENCIL_TEST);var i=!c.paint["fill-pattern"]&&c.isPaintValueFeatureConstant("fill-color")&&c.isPaintValueFeatureConstant("fill-opacity")&&1===c.paint["fill-color"][3]&&1===c.paint["fill-opacity"];a.isOpaquePass===i&&(a.setDepthSublayer(1),e(a,b,c,d,f)),!a.isOpaquePass&&c.paint["fill-antialias"]&&(a.lineWidth(2),a.depthMask(!1),a.setDepthSublayer(c.getPaintProperty("fill-outline-color")?2:0),e(a,b,c,d,g))}function e(a,b,c,d,e){if(!i.isPatternMissing(c.paint["fill-pattern"],a))for(var f=!0,g=0,h=d;g<h.length;g+=1){var j=h[g],k=b.getTile(j),l=k.getBucket(c);l&&(a.enableTileClippingMask(j),e(a,b,c,k,j,l.buffers,f),f=!1)}}function f(a,b,c,d,e,f,g){for(var i=a.gl,j=f.layerData[c.id],k=h("fill",c.paint["fill-pattern"],a,j,c,d,e,g),l=0,m=f.segments;l<m.length;l+=1){var n=m[l];n.vaos[c.id].bind(i,k,f.layoutVertexBuffer,f.elementBuffer,j.paintVertexBuffer,n.vertexOffset),i.drawElements(i.TRIANGLES,3*n.primitiveLength,i.UNSIGNED_SHORT,3*n.primitiveOffset*2)}}function g(a,b,c,d,e,f,g){var i=a.gl,j=f.layerData[c.id],k=c.paint["fill-pattern"]&&!c.getPaintProperty("fill-outline-color"),l=h("fillOutline",k,a,j,c,d,e,g);i.uniform2f(l.u_world,i.drawingBufferWidth,i.drawingBufferHeight);for(var m=0,n=f.segments2;m<n.length;m+=1){var o=n[m];o.vaos[c.id].bind(i,l,f.layoutVertexBuffer,f.elementBuffer2,j.paintVertexBuffer,o.vertexOffset),i.drawElements(i.LINES,2*o.primitiveLength,i.UNSIGNED_SHORT,2*o.primitiveOffset*2)}}function h(a,b,c,d,e,f,g,h){var j,k=c.currentProgram;return b?(j=c.useProgram(a+"Pattern",d.programConfiguration),(h||j!==k)&&(d.programConfiguration.setUniforms(c.gl,j,e,{zoom:c.transform.zoom}),i.prepare(e.paint["fill-pattern"],c,j)),i.setTile(f,c,j)):(j=c.useProgram(a,d.programConfiguration),(h||j!==k)&&d.programConfiguration.setUniforms(c.gl,j,e,{zoom:c.transform.zoom})),c.gl.uniformMatrix4fv(j.u_matrix,!1,c.translatePosMatrix(g.posMatrix,f,e.paint["fill-translate"],e.paint["fill-translate-anchor"])),j}var i=a("./pattern");b.exports=d},{"./pattern":88}],81:[function(a,b,c){"use strict";function d(a,b,c,d){if(!a.isOpaquePass&&0!==c.paint["fill-extrusion-opacity"]){var h=a.gl;h.disable(h.STENCIL_TEST),h.enable(h.DEPTH_TEST),a.depthMask(!0);var i=e(h,a);h.clearColor(0,0,0,0),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);for(var j=0;j<d.length;j++)g(a,b,c,d[j]);h.bindFramebuffer(h.FRAMEBUFFER,null),f(h,a,c,i)}}function e(a,b){a.activeTexture(a.TEXTURE1);var c=b.viewportTexture;c?a.bindTexture(a.TEXTURE_2D,c):(c=a.createTexture(),a.bindTexture(a.TEXTURE_2D,c),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,b.width,b.height,0,a.RGBA,a.UNSIGNED_BYTE,null),b.viewportTexture=c);var d=b.viewportFbo;if(d)a.bindFramebuffer(a.FRAMEBUFFER,d);else{d=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,d);var e=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,e),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),b.viewportFbo=d}return a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0),c}function f(a,b,c,d){var e=b.useProgram("extrusionTexture");a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,d),a.uniform1f(e.u_opacity,c.paint["fill-extrusion-opacity"]),a.uniform1i(e.u_image,1);var f=o.create();o.ortho(f,0,b.width,b.height,0,0,1),a.uniformMatrix4fv(e.u_matrix,!1,f),a.disable(a.DEPTH_TEST),a.uniform2f(e.u_world,a.drawingBufferWidth,a.drawingBufferHeight);var g=new l;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1);var h=j.fromStructArray(g,j.BufferType.VERTEX);(new k).bind(a,e,h),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.enable(a.DEPTH_TEST)}function g(a,b,c,d){var e=b.getTile(d),f=e.getBucket(c);if(f){var g=f.buffers,i=a.gl,j=c.paint["fill-extrusion-pattern"],k=g.layerData[c.id],l=k.programConfiguration,n=a.useProgram(j?"fillExtrusionPattern":"fillExtrusion",l);if(l.setUniforms(i,n,c,{zoom:a.transform.zoom}),j){if(m.isPatternMissing(j,a))return;m.prepare(j,a,n),m.setTile(e,a,n),i.uniform1f(n.u_height_factor,-Math.pow(2,d.z)/e.tileSize/8)}a.gl.uniformMatrix4fv(n.u_matrix,!1,a.translatePosMatrix(d.posMatrix,e,c.paint["fill-extrusion-translate"],c.paint["fill-extrusion-translate-anchor"])),h(n,a);for(var o=0,p=g.segments;o<p.length;o+=1){var q=p[o];q.vaos[c.id].bind(i,n,g.layoutVertexBuffer,g.elementBuffer,k.paintVertexBuffer,q.vertexOffset),i.drawElements(i.TRIANGLES,3*q.primitiveLength,i.UNSIGNED_SHORT,3*q.primitiveOffset*2)}}}function h(a,b){var c=b.gl,d=b.style.light,e=d.calculated.position,f=[e.x,e.y,e.z],g=n.create();"viewport"===d.calculated.anchor&&n.fromRotation(g,-b.transform.angle),p.transformMat3(f,f,g),c.uniform3fv(a.u_lightpos,f),c.uniform1f(a.u_lightintensity,d.calculated.intensity),c.uniform3fv(a.u_lightcolor,d.calculated.color.slice(0,3))}var i=a("@mapbox/gl-matrix"),j=a("../data/buffer"),k=a("./vertex_array_object"),l=a("../data/pos_array"),m=a("./pattern"),n=i.mat3,o=i.mat4,p=i.vec3;b.exports=d},{"../data/buffer":61,"../data/pos_array":67,"./pattern":88,"./vertex_array_object":89,"@mapbox/gl-matrix":1}],82:[function(a,b,c){"use strict";function d(a,b,c,d,g,h,i,j,k){var l,m,n,o,p=b.gl,q=g.paint["line-dasharray"],r=g.paint["line-pattern"];if(j||k){var s=1/f(c,1,b.transform.tileZoom);if(q){l=b.lineAtlas.getDash(q.from,"round"===g.layout["line-cap"]),m=b.lineAtlas.getDash(q.to,"round"===g.layout["line-cap"]);var t=l.width*q.fromScale,u=m.width*q.toScale;p.uniform2f(a.u_patternscale_a,s/t,-l.height/2),p.uniform2f(a.u_patternscale_b,s/u,-m.height/2),p.uniform1f(a.u_sdfgamma,b.lineAtlas.width/(256*Math.min(t,u)*e.devicePixelRatio)/2)}else if(r){if(n=b.spriteAtlas.getPattern(r.from),o=b.spriteAtlas.getPattern(r.to),!n||!o)return;p.uniform2f(a.u_pattern_size_a,n.displaySize[0]*r.fromScale/s,o.displaySize[1]),p.uniform2f(a.u_pattern_size_b,o.displaySize[0]*r.toScale/s,o.displaySize[1]),p.uniform2fv(a.u_texsize,b.spriteAtlas.getPixelSize())}p.uniform2f(a.u_gl_units_to_pixels,1/b.transform.pixelsToGLUnits[0],1/b.transform.pixelsToGLUnits[1])}j&&(q?(p.uniform1i(a.u_image,0),p.activeTexture(p.TEXTURE0),b.lineAtlas.bind(p),p.uniform1f(a.u_tex_y_a,l.y),p.uniform1f(a.u_tex_y_b,m.y),p.uniform1f(a.u_mix,q.t)):r&&(p.uniform1i(a.u_image,0),p.activeTexture(p.TEXTURE0),b.spriteAtlas.bind(p,!0),p.uniform2fv(a.u_pattern_tl_a,n.tl),p.uniform2fv(a.u_pattern_br_a,n.br),p.uniform2fv(a.u_pattern_tl_b,o.tl),p.uniform2fv(a.u_pattern_br_b,o.br),p.uniform1f(a.u_fade,r.t))),b.enableTileClippingMask(h);var v=b.translatePosMatrix(h.posMatrix,c,g.paint["line-translate"],g.paint["line-translate-anchor"]);p.uniformMatrix4fv(a.u_matrix,!1,v),p.uniform1f(a.u_ratio,1/f(c,1,b.transform.zoom));for(var w=0,x=d.segments;w<x.length;w+=1){var y=x[w];y.vaos[g.id].bind(p,a,d.layoutVertexBuffer,d.elementBuffer,i.paintVertexBuffer,y.vertexOffset),p.drawElements(p.TRIANGLES,3*y.primitiveLength,p.UNSIGNED_SHORT,3*y.primitiveOffset*2)}}var e=a("../util/browser"),f=a("../source/pixels_to_tile_units");b.exports=function(a,b,c,e){if(!a.isOpaquePass){a.setDepthSublayer(0),a.depthMask(!1);var f=a.gl;if(f.enable(f.STENCIL_TEST),!(c.paint["line-width"]<=0))for(var g,h=c.paint["line-dasharray"]?"lineSDF":c.paint["line-pattern"]?"linePattern":"line",i=!0,j=0,k=e;j<k.length;j+=1){var l=k[j],m=b.getTile(l),n=m.getBucket(c);if(n){var o=n.buffers.layerData[c.id],p=a.currentProgram,q=a.useProgram(h,o.programConfiguration),r=i||q!==p,s=g!==m.coord.z;r&&o.programConfiguration.setUniforms(a.gl,q,c,{zoom:a.transform.zoom}),d(q,a,m,n.buffers,c,l,o,r,s),g=m.coord.z,i=!1}}}}},{"../source/pixels_to_tile_units":98,"../util/browser":197}],83:[function(a,b,c){"use strict";function d(a,b,c,d){if(!a.isOpaquePass){var f=a.gl;f.enable(f.DEPTH_TEST),a.depthMask(!0),f.depthFunc(f.LESS);for(var g=d.length&&d[0].z,h=0;h<d.length;h++){var i=d[h];a.setDepthSublayer(i.z-g),e(a,b,c,i)}f.depthFunc(f.LEQUAL)}}function e(a,b,c,d){var e=a.gl;e.disable(e.STENCIL_TEST);var j=b.getTile(d),k=a.transform.calculatePosMatrix(d,b.getSource().maxzoom);j.registerFadeDuration(a.style.animationLoop,c.paint["raster-fade-duration"]);var l=a.useProgram("raster");e.uniformMatrix4fv(l.u_matrix,!1,k),e.uniform1f(l.u_brightness_low,c.paint["raster-brightness-min"]),e.uniform1f(l.u_brightness_high,c.paint["raster-brightness-max"]),e.uniform1f(l.u_saturation_factor,h(c.paint["raster-saturation"])),e.uniform1f(l.u_contrast_factor,g(c.paint["raster-contrast"])),
e.uniform3fv(l.u_spin_weights,f(c.paint["raster-hue-rotate"]));var m,n,o=j.sourceCache&&j.sourceCache.findLoadedParent(d,0,{}),p=i(j,o,c,a.transform);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,j.texture),e.activeTexture(e.TEXTURE1),o?(e.bindTexture(e.TEXTURE_2D,o.texture),m=Math.pow(2,o.coord.z-j.coord.z),n=[j.coord.x*m%1,j.coord.y*m%1]):e.bindTexture(e.TEXTURE_2D,j.texture),e.uniform2fv(l.u_tl_parent,n||[0,0]),e.uniform1f(l.u_scale_parent,m||1),e.uniform1f(l.u_buffer_scale,1),e.uniform1f(l.u_fade_t,p.mix),e.uniform1f(l.u_opacity,p.opacity*c.paint["raster-opacity"]),e.uniform1i(l.u_image0,0),e.uniform1i(l.u_image1,1);var q=j.boundsBuffer||a.rasterBoundsBuffer;(j.boundsVAO||a.rasterBoundsVAO).bind(e,l,q),e.drawArrays(e.TRIANGLE_STRIP,0,q.length)}function f(a){a*=Math.PI/180;var b=Math.sin(a),c=Math.cos(a);return[(2*c+1)/3,(-Math.sqrt(3)*b-c+1)/3,(Math.sqrt(3)*b-c+1)/3]}function g(a){return a>0?1/(1-a):1+a}function h(a){return a>0?1-1/(1.001-a):-a}function i(a,b,c,d){var e=c.paint["raster-fade-duration"];if(a.sourceCache&&e>0){var f=Date.now(),g=(f-a.timeAdded)/e,h=b?(f-b.timeAdded)/e:-1,i=a.sourceCache.getSource(),k=d.coveringZoomLevel({tileSize:i.tileSize,roundZoom:i.roundZoom}),l=!b||Math.abs(b.coord.z-k)>Math.abs(a.coord.z-k),m=l&&a.refreshedUponExpiration?1:j.clamp(l?g:1-h,0,1);return a.refreshedUponExpiration&&g>=1&&(a.refreshedUponExpiration=!1),b?{opacity:1,mix:1-m}:{opacity:m,mix:0}}return{opacity:1,mix:0}}var j=a("../util/util");b.exports=d},{"../util/util":218}],84:[function(a,b,c){"use strict";function d(a,b,c,d){if(!a.isOpaquePass){var f=!(c.layout["text-allow-overlap"]||c.layout["icon-allow-overlap"]||c.layout["text-ignore-placement"]||c.layout["icon-ignore-placement"]),g=a.gl;f?g.disable(g.STENCIL_TEST):g.enable(g.STENCIL_TEST),a.setDepthSublayer(0),a.depthMask(!1),e(a,b,c,d,!1,c.paint["icon-translate"],c.paint["icon-translate-anchor"],c.layout["icon-rotation-alignment"],c.layout["icon-pitch-alignment"],c.layout["icon-keep-upright"]),e(a,b,c,d,!0,c.paint["text-translate"],c.paint["text-translate-anchor"],c.layout["text-rotation-alignment"],c.layout["text-pitch-alignment"],c.layout["text-keep-upright"]),b.map.showCollisionBoxes&&i(a,b,c,d)}}function e(a,b,c,d,e,h,i,l,m,o){if(e||!a.style.sprite||a.style.sprite.loaded()){var p=a.gl,q="map"===l,r="map"===m,s=q&&"line"===c.layout["symbol-placement"],t=q&&!r&&!s,u=r;u?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST);for(var v,w,x=0,y=d;x<y.length;x+=1){var z=y[x],A=b.getTile(z),B=A.getBucket(c);if(B){var C=e?B.buffers.glyph:B.buffers.icon;if(C&&C.segments.length){var D=C.layerData[c.id],E=D.programConfiguration,F=e||B.sdfIcons,G=e?B.textSizeData:B.iconSizeData;v&&B.fontstack===w||(v=a.useProgram(F?"symbolSDF":"symbolIcon",E),E.setUniforms(p,v,c,{zoom:a.transform.zoom}),f(v,a,c,z.z,e,F,t,r,B.fontstack,B.iconsNeedLinear,G)),a.enableTileClippingMask(z),p.uniformMatrix4fv(v.u_matrix,!1,a.translatePosMatrix(z.posMatrix,A,h,i));var H=j(A,1,a.transform.zoom),I=k.getLabelPlaneMatrix(z.posMatrix,r,q,a.transform,H),J=k.getGlCoordMatrix(z.posMatrix,r,q,a.transform,H);p.uniformMatrix4fv(v.u_gl_coord_matrix,!1,a.translatePosMatrix(J,A,h,i,!0)),s?(p.uniformMatrix4fv(v.u_label_plane_matrix,!1,n),k.updateLineLabels(B,z.posMatrix,a,e,I,J,r,o,H,c)):p.uniformMatrix4fv(v.u_label_plane_matrix,!1,I),p.uniform1f(v.u_collision_y_stretch,A.collisionTile.yStretch),g(v,E,a,c,A,C,e,F,r),w=B.fontstack}}}u||p.enable(p.DEPTH_TEST)}}function f(a,b,c,d,e,f,g,h,i,j,k){var m=b.gl,n=b.transform;if(m.uniform1i(a.u_pitch_with_map,h),m.activeTexture(m.TEXTURE0),m.uniform1i(a.u_texture,0),m.uniform1f(a.u_is_text,e?1:0),e){var o=i&&b.glyphSource.getGlyphAtlas(i);if(!o)return;o.updateTexture(m),m.uniform2f(a.u_texsize,o.width,o.height)}else{var p=b.options.rotating||b.options.zooming,q=!c.isLayoutValueFeatureConstant("icon-size")||!c.isLayoutValueZoomConstant("icon-size")||1!==c.getLayoutValue("icon-size",{zoom:n.zoom}),r=q||j,s=h||n.pitch;b.spriteAtlas.bind(m,f||p||r||s),m.uniform2fv(a.u_texsize,b.spriteAtlas.getPixelSize())}m.activeTexture(m.TEXTURE1),b.frameHistory.bind(m),m.uniform1i(a.u_fadetexture,1),m.uniform1f(a.u_pitch,n.pitch/360*2*Math.PI),m.uniform1i(a.u_is_size_zoom_constant,k.isZoomConstant?1:0),m.uniform1i(a.u_is_size_feature_constant,k.isFeatureConstant?1:0),m.uniform1f(a.u_camera_to_center_distance,n.cameraToCenterDistance);var t=l.evaluateSizeForZoom(k,n,c,e);void 0!==t.uSizeT&&m.uniform1f(a.u_size_t,t.uSizeT),void 0!==t.uSize&&m.uniform1f(a.u_size,t.uSize),m.uniform1f(a.u_aspect_ratio,n.width/n.height),m.uniform1i(a.u_rotate_symbol,g)}function g(a,b,c,d,e,f,g,i,j){var k=c.gl,l=c.transform;if(i){var m=(g?"text":"icon")+"-halo-width",n=!d.isPaintValueFeatureConstant(m)||d.paint[m],o=j?Math.cos(l._pitch)*l.cameraToCenterDistance:1;k.uniform1f(a.u_gamma_scale,o),n&&(k.uniform1f(a.u_is_halo,1),h(f,d,k,a)),k.uniform1f(a.u_is_halo,0)}h(f,d,k,a)}function h(a,b,c,d){for(var e=a.layerData[b.id],f=e&&e.paintVertexBuffer,g=0,h=a.segments;g<h.length;g+=1){var i=h[g];i.vaos[b.id].bind(c,d,a.layoutVertexBuffer,a.elementBuffer,f,i.vertexOffset,a.dynamicLayoutVertexBuffer),c.drawElements(c.TRIANGLES,3*i.primitiveLength,c.UNSIGNED_SHORT,3*i.primitiveOffset*2)}}var i=a("./draw_collision_debug"),j=a("../source/pixels_to_tile_units"),k=a("../symbol/projection"),l=a("../symbol/symbol_size"),m=a("@mapbox/gl-matrix").mat4,n=m.identity(new Float32Array(16));b.exports=d},{"../source/pixels_to_tile_units":98,"../symbol/projection":170,"../symbol/symbol_size":174,"./draw_collision_debug":78,"@mapbox/gl-matrix":1}],85:[function(a,b,c){"use strict";var d=function(){this.changeTimes=new Float64Array(256),this.changeOpacities=new Uint8Array(256),this.opacities=new Uint8ClampedArray(256),this.array=new Uint8Array(this.opacities.buffer),this.previousZoom=0,this.firstFrame=!0};d.prototype.record=function(a,b,c){var d=this;this.firstFrame&&(a=0,this.firstFrame=!1),b=Math.floor(10*b);var e;if(b<this.previousZoom)for(e=b+1;e<=this.previousZoom;e++)d.changeTimes[e]=a,d.changeOpacities[e]=d.opacities[e];else for(e=b;e>this.previousZoom;e--)d.changeTimes[e]=a,d.changeOpacities[e]=d.opacities[e];for(e=0;e<256;e++){var f=a-d.changeTimes[e],g=255*(c?f/c:1);d.opacities[e]=e<=b?d.changeOpacities[e]+g:d.changeOpacities[e]-g}this.changed=!0,this.previousZoom=b},d.prototype.isVisible=function(a){return 0!==this.opacities[Math.floor(10*a)]},d.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.changed&&(a.texSubImage2D(a.TEXTURE_2D,0,0,0,256,1,a.ALPHA,a.UNSIGNED_BYTE,this.array),this.changed=!1)):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,256,1,0,a.ALPHA,a.UNSIGNED_BYTE,this.array))},b.exports=d},{}],86:[function(a,b,c){"use strict";var d=a("../util/util"),e=function(a,b){this.width=a,this.height=b,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};e.prototype.setSprite=function(a){this.sprite=a},e.prototype.getDash=function(a,b){var c=a.join(",")+b;return this.positions[c]||(this.positions[c]=this.addDash(a,b)),this.positions[c]},e.prototype.addDash=function(a,b){var c=this,e=b?7:0,f=2*e+1;if(this.nextRow+f>this.height)return d.warnOnce("LineAtlas out of space"),null;for(var g=0,h=0;h<a.length;h++)g+=a[h];for(var i=this.width/g,j=i/2,k=a.length%2==1,l=-e;l<=e;l++)for(var m=c.nextRow+e+l,n=c.width*m,o=k?-a[a.length-1]:0,p=a[0],q=1,r=0;r<this.width;r++){for(;p<r/i;)o=p,p+=a[q],k&&q===a.length-1&&(p+=a[0]),q++;var s=Math.abs(r-o*i),t=Math.abs(r-p*i),u=Math.min(s,t),v=q%2==1,w=void 0;if(b){var x=e?l/e*(j+1):0;if(v){var y=j-Math.abs(x);w=Math.sqrt(u*u+y*y)}else w=j-Math.sqrt(u*u+x*x)}else w=(v?1:-1)*u;c.data[3+4*(n+r)]=Math.max(0,Math.min(255,w+128))}var z={y:(this.nextRow+e+.5)/this.height,height:2*e/this.height,width:g};return this.nextRow+=f,this.dirty=!0,z},e.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data))},b.exports=e},{"../util/util":218}],87:[function(a,b,c){"use strict";var d=a("../util/browser"),e=a("@mapbox/gl-matrix").mat4,f=a("./frame_history"),g=a("../source/source_cache"),h=a("../data/extent"),i=a("../source/pixels_to_tile_units"),j=a("../util/util"),k=a("../data/buffer"),l=a("./vertex_array_object"),m=a("../data/raster_bounds_array"),n=a("../data/pos_array"),o=a("../data/program_configuration"),p=a("../shaders"),q={symbol:a("./draw_symbol"),circle:a("./draw_circle"),line:a("./draw_line"),fill:a("./draw_fill"),"fill-extrusion":a("./draw_fill_extrusion"),raster:a("./draw_raster"),background:a("./draw_background"),debug:a("./draw_debug")},r=function(a,b){this.gl=a,this.transform=b,this._tileTextures={},this.frameHistory=new f,this.setup(),this.numSublayers=g.maxUnderzooming+g.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.lineWidthRange=a.getParameter(a.ALIASED_LINE_WIDTH_RANGE),this.basicFillProgramConfiguration=o.createBasicFill(),this.emptyProgramConfiguration=new o};r.prototype.resize=function(a,b){var c=this.gl;this.width=a*d.devicePixelRatio,this.height=b*d.devicePixelRatio,c.viewport(0,0,this.width,this.height),this.viewportTexture&&(this.gl.deleteTexture(this.viewportTexture),this.viewportTexture=null),this.viewportFbo&&(this.gl.deleteFramebuffer(this.viewportFbo),this.viewportFbo=null)},r.prototype.setup=function(){var a=this.gl;a.enable(a.BLEND),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),a.enable(a.STENCIL_TEST),a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),this._depthMask=!1,a.depthMask(!1);var b=new n;b.emplaceBack(0,0),b.emplaceBack(h,0),b.emplaceBack(0,h),b.emplaceBack(h,h),this.tileExtentBuffer=k.fromStructArray(b,k.BufferType.VERTEX),this.tileExtentVAO=new l,this.tileExtentPatternVAO=new l;var c=new n;c.emplaceBack(0,0),c.emplaceBack(h,0),c.emplaceBack(h,h),c.emplaceBack(0,h),c.emplaceBack(0,0),this.debugBuffer=k.fromStructArray(c,k.BufferType.VERTEX),this.debugVAO=new l;var d=new m;d.emplaceBack(0,0,0,0),d.emplaceBack(h,0,32767,0),d.emplaceBack(0,h,0,32767),d.emplaceBack(h,h,32767,32767),this.rasterBoundsBuffer=k.fromStructArray(d,k.BufferType.VERTEX),this.rasterBoundsVAO=new l,this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))},r.prototype.clearColor=function(){var a=this.gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},r.prototype.clearStencil=function(){var a=this.gl;a.clearStencil(0),a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},r.prototype.clearDepth=function(){var a=this.gl;a.clearDepth(1),this.depthMask(!0),a.clear(a.DEPTH_BUFFER_BIT)},r.prototype._renderTileClippingMasks=function(a){var b=this,c=this.gl;c.colorMask(!1,!1,!1,!1),this.depthMask(!1),c.disable(c.DEPTH_TEST),c.enable(c.STENCIL_TEST),c.stencilMask(255),c.stencilOp(c.KEEP,c.KEEP,c.REPLACE);var d=1;this._tileClippingMaskIDs={};for(var e=0,f=a;e<f.length;e+=1){var g=f[e],h=b._tileClippingMaskIDs[g.id]=d++;c.stencilFunc(c.ALWAYS,h,255);var i=b.useProgram("fill",b.basicFillProgramConfiguration);c.uniformMatrix4fv(i.u_matrix,!1,g.posMatrix),b.tileExtentVAO.bind(c,i,b.tileExtentBuffer),c.drawArrays(c.TRIANGLE_STRIP,0,b.tileExtentBuffer.length)}c.stencilMask(0),c.colorMask(!0,!0,!0,!0),this.depthMask(!0),c.enable(c.DEPTH_TEST)},r.prototype.enableTileClippingMask=function(a){var b=this.gl;b.stencilFunc(b.EQUAL,this._tileClippingMaskIDs[a.id],255)},r.prototype.prepareBuffers=function(){},r.prototype.render=function(a,b){if(this.style=a,this.options=b,this.lineAtlas=a.lineAtlas,this.spriteAtlas=a.spriteAtlas,this.spriteAtlas.setSprite(a.sprite),this.glyphSource=a.glyphSource,this.frameHistory.record(Date.now(),this.transform.zoom,a.getTransition().duration),this.prepareBuffers(),this.clearColor(),this.clearDepth(),this.showOverdrawInspector(b.showOverdrawInspector),this.depthRange=(a._order.length+2)*this.numSublayers*this.depthEpsilon,this.isOpaquePass=!0,this.renderPass(),this.isOpaquePass=!1,this.renderPass(),this.options.showTileBoundaries){var c=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];c&&q.debug(this,c,c.getVisibleCoordinates())}},r.prototype.renderPass=function(){var a,b=this,c=this.style._order,d=[];this.currentLayer=this.isOpaquePass?c.length-1:0,this.isOpaquePass?this._showOverdrawInspector||this.gl.disable(this.gl.BLEND):this.gl.enable(this.gl.BLEND);for(var e=0;e<c.length;e++){var f=b.style._layers[c[b.currentLayer]];f.source!==(a&&a.id)&&(a=b.style.sourceCaches[f.source],d=[],a&&(a.prepare&&a.prepare(),b.clearStencil(),d=a.getVisibleCoordinates(),a.getSource().isTileClipped&&b._renderTileClippingMasks(d)),b.isOpaquePass||d.reverse()),b.renderLayer(b,a,f,d),b.currentLayer+=b.isOpaquePass?-1:1}},r.prototype.depthMask=function(a){a!==this._depthMask&&(this._depthMask=a,this.gl.depthMask(a))},r.prototype.renderLayer=function(a,b,c,d){c.isHidden(this.transform.zoom)||("background"===c.type||d.length)&&(this.id=c.id,q[c.type](a,b,c,d))},r.prototype.setDepthSublayer=function(a){var b=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon,c=b-1+this.depthRange;this.gl.depthRange(c,b)},r.prototype.translatePosMatrix=function(a,b,c,d,f){if(!c[0]&&!c[1])return a;var g=f?"map"===d?this.transform.angle:0:"viewport"===d?-this.transform.angle:0;if(g){var h=Math.sin(g),j=Math.cos(g);c=[c[0]*j-c[1]*h,c[0]*h+c[1]*j]}var k=[f?c[0]:i(b,c[0],this.transform.zoom),f?c[1]:i(b,c[1],this.transform.zoom),0],l=new Float32Array(16);return e.translate(l,a,k),l},r.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size];b?b.push(a):this._tileTextures[a.size]=[a]},r.prototype.getTileTexture=function(a){var b=this._tileTextures[a];return b&&b.length>0?b.pop():null},r.prototype.lineWidth=function(a){this.gl.lineWidth(j.clamp(a,this.lineWidthRange[0],this.lineWidthRange[1]))},r.prototype.showOverdrawInspector=function(a){if(a||this._showOverdrawInspector){this._showOverdrawInspector=a;var b=this.gl;a?(b.blendFunc(b.CONSTANT_COLOR,b.ONE),b.blendColor(1/8,1/8,1/8,0),b.clearColor(0,0,0,1),b.clear(b.COLOR_BUFFER_BIT)):b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA)}},r.prototype.createProgram=function(a,b){var c=this.gl,e=c.createProgram(),f=b.defines().concat("#define DEVICE_PIXEL_RATIO "+d.devicePixelRatio.toFixed(1));this._showOverdrawInspector&&f.push("#define OVERDRAW_INSPECTOR;");var g=f.concat(p.prelude.fragmentSource,p[a].fragmentSource).join("\n"),h=f.concat(p.prelude.vertexSource,p[a].vertexSource).join("\n"),i=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(i,g),c.compileShader(i),c.attachShader(e,i);var j=c.createShader(c.VERTEX_SHADER);c.shaderSource(j,h),c.compileShader(j),c.attachShader(e,j);for(var k=b.interface?b.interface.layoutAttributes:[],l=0;l<k.length;l++)c.bindAttribLocation(e,l,k[l].name);c.linkProgram(e);for(var m=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES),n={program:e,numAttributes:m},o=0;o<m;o++){var q=c.getActiveAttrib(e,o);q&&(n[q.name]=c.getAttribLocation(e,q.name))}for(var r=c.getProgramParameter(e,c.ACTIVE_UNIFORMS),s=0;s<r;s++){var t=c.getActiveUniform(e,s);t&&(n[t.name]=c.getUniformLocation(e,t.name))}return n},r.prototype._createProgramCached=function(a,b){this.cache=this.cache||{};var c=""+a+(b.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=this.createProgram(a,b)),this.cache[c]},r.prototype.useProgram=function(a,b){var c=this.gl,d=this._createProgramCached(a,b||this.emptyProgramConfiguration);return this.currentProgram!==d&&(c.useProgram(d.program),this.currentProgram=d),d},b.exports=r},{"../data/buffer":61,"../data/extent":64,"../data/pos_array":67,"../data/program_configuration":68,"../data/raster_bounds_array":69,"../shaders":91,"../source/pixels_to_tile_units":98,"../source/source_cache":103,"../util/browser":197,"../util/util":218,"./draw_background":76,"./draw_circle":77,"./draw_debug":79,"./draw_fill":80,"./draw_fill_extrusion":81,"./draw_line":82,"./draw_raster":83,"./draw_symbol":84,"./frame_history":85,"./vertex_array_object":89,"@mapbox/gl-matrix":1}],88:[function(a,b,c){"use strict";var d=a("../source/pixels_to_tile_units");c.isPatternMissing=function(a,b){if(!a)return!1;var c=b.spriteAtlas.getPattern(a.from),d=b.spriteAtlas.getPattern(a.to);return!c||!d},c.prepare=function(a,b,c){var d=b.gl,e=b.spriteAtlas.getPattern(a.from),f=b.spriteAtlas.getPattern(a.to);d.uniform1i(c.u_image,0),d.uniform2fv(c.u_pattern_tl_a,e.tl),d.uniform2fv(c.u_pattern_br_a,e.br),d.uniform2fv(c.u_pattern_tl_b,f.tl),d.uniform2fv(c.u_pattern_br_b,f.br),d.uniform2fv(c.u_texsize,b.spriteAtlas.getPixelSize()),d.uniform1f(c.u_mix,a.t),d.uniform2fv(c.u_pattern_size_a,e.displaySize),d.uniform2fv(c.u_pattern_size_b,f.displaySize),d.uniform1f(c.u_scale_a,a.fromScale),d.uniform1f(c.u_scale_b,a.toScale),d.activeTexture(d.TEXTURE0),b.spriteAtlas.bind(d,!0)},c.setTile=function(a,b,c){var e=b.gl;e.uniform1f(c.u_tile_units_to_pixels,1/d(a,1,b.transform.tileZoom));var f=Math.pow(2,a.coord.z),g=a.tileSize*Math.pow(2,b.transform.tileZoom)/f,h=g*(a.coord.x+a.coord.w*f),i=g*a.coord.y;e.uniform2f(c.u_pixel_coord_upper,h>>16,i>>16),e.uniform2f(c.u_pixel_coord_lower,65535&h,65535&i)}},{"../source/pixels_to_tile_units":98}],89:[function(a,b,c){"use strict";var d=function(){this.boundProgram=null,this.boundVertexBuffer=null,this.boundVertexBuffer2=null,this.boundElementBuffer=null,this.boundVertexOffset=null,this.vao=null};d.prototype.bind=function(a,b,c,d,e,f,g){void 0===a.extVertexArrayObject&&(a.extVertexArrayObject=a.getExtension("OES_vertex_array_object"));var h=!this.vao||this.boundProgram!==b||this.boundVertexBuffer!==c||this.boundVertexBuffer2!==e||this.boundElementBuffer!==d||this.boundVertexOffset!==f||this.boundDynamicVertexBuffer!==g;!a.extVertexArrayObject||h?(this.freshBind(a,b,c,d,e,f,g),this.gl=a):(a.extVertexArrayObject.bindVertexArrayOES(this.vao),g&&g.bind(a))},d.prototype.freshBind=function(a,b,c,d,e,f,g){var h,i=b.numAttributes;if(a.extVertexArrayObject)this.vao&&this.destroy(),this.vao=a.extVertexArrayObject.createVertexArrayOES(),a.extVertexArrayObject.bindVertexArrayOES(this.vao),h=0,this.boundProgram=b,this.boundVertexBuffer=c,this.boundVertexBuffer2=e,this.boundElementBuffer=d,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=g;else{h=a.currentNumAttributes||0;for(var j=i;j<h;j++)a.disableVertexAttribArray(j)}c.enableAttributes(a,b),e&&e.enableAttributes(a,b),g&&g.enableAttributes(a,b),c.bind(a),c.setVertexAttribPointers(a,b,f),e&&(e.bind(a),e.setVertexAttribPointers(a,b,f)),g&&(g.bind(a),g.setVertexAttribPointers(a,b,f)),d&&d.bind(a),a.currentNumAttributes=i},d.prototype.destroy=function(){this.vao&&(this.gl.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)},b.exports=d},{}],90:[function(a,b,c){"use strict";var d=a("../util/util");c.packUint8ToFloat=function(a,b){return a=d.clamp(Math.floor(a),0,255),b=d.clamp(Math.floor(b),0,255),256*a+b}},{"../util/util":218}],91:[function(a,b,c){"use strict";b.exports={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},collisionBox:{fragmentSource:"uniform float u_zoom;\n// u_maxzoom is derived from the maximum scale considered by the CollisionTile\n// Labels with placement zoom greater than this value will not be placed,\n// regardless of perspective effects.\nuniform float u_maxzoom;\nuniform sampler2D u_fadetexture;\n\n// v_max_zoom is a collision-box-specific value that controls when line-following\n// collision boxes are used.\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Green = no collisions, label is showing\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\n\n    // Red = collision, label hidden\n    if (texture2D(u_fadetexture, v_fade_tex).a < 1.0) {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n    }\n\n    // Faded black = this collision box is not used at this zoom (for curved labels)\n    if (u_zoom >= v_max_zoom + v_perspective_zoom_adjust) {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\n    }\n\n    // Faded blue = the placement scale for this label is beyond the CollisionTile\n    // max scale, so it's impossible for this label to show without collision detection\n    // being run again (the label's glyphs haven't even been added to the symbol bucket)\n    if (v_placement_zoom >= u_maxzoom) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\n    }\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_data;\n\nuniform mat4 u_matrix;\nuniform float u_scale;\nuniform float u_pitch;\nuniform float u_collision_y_stretch;\nuniform float u_camera_to_center_distance;\n\nvarying float v_max_zoom;\nvarying float v_placement_zoom;\nvarying float v_perspective_zoom_adjust;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = 1.0 + 0.5 * ((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    gl_Position = u_matrix * vec4(a_pos + a_extrude * collision_perspective_ratio * collision_adjustment / u_scale, 0.0, 1.0);\n\n    v_max_zoom = a_data.x;\n    v_placement_zoom = a_data.y;\n\n    v_perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((v_placement_zoom + v_perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{
fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float ed = a_edgedistance; // use each attrib in order to not trip a VAO assert\n    float t = mod(a_normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(a_normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec3 a_normal;\nattribute float a_edgedistance;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(a_normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = a_normal.x == 1.0 && a_normal.y == 0.0 && a_normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(a_edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(a_normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (a_normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset; \n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset; \n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec2 a_pos;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    // We store the texture normals in the most insignificant bit\n    // transform y so that 0 => -1 and 1 => 1\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = mod(a_pos, 2.0);\n    normal.y = sign(normal.y - 0.5);\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases. \n    // moved them into the shader for clarity and simplicity. \n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n \n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    // Remove the texture normal bit to get the position\n    vec2 pos = floor(a_pos * 0.5);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_collision_y_stretch;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying vec2 v_fade_tex;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    // See comments in symbol_sdf.vertex\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n}\n"},symbolSDF:{
fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform sampler2D u_fadetexture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    vec2 fade_tex = v_data0.zw;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    lowp float fade_alpha = texture2D(u_fadetexture, fade_tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist) * fade_alpha;\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_collision_y_stretch;\n\nuniform vec2 u_texsize;\n\nvarying vec4 v_data0;\nvarying vec2 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\n    mediump float a_labelminzoom = angle_labelminzoom[1];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    // incidence_stretch is the ratio of how much y space a label takes up on a tile while drawn perpendicular to the viewport vs\n    //  how much space it would take up if it were drawn flat on the tile\n    // Using law of sines, camera_to_anchor/sin(ground_angle) = camera_to_center/sin(incidence_angle)\n    // sin(incidence_angle) = 1/incidence_stretch\n    // Incidence angle 90 -> head on, sin(incidence_angle) = 1, no incidence stretch\n    // Incidence angle 1 -> very oblique, sin(incidence_angle) =~ 0, lots of incidence stretch\n    // ground_angle = u_pitch + PI/2 -> sin(ground_angle) = cos(u_pitch)\n    // This 2D calculation is only exactly correct when gl_Position.x is in the center of the viewport,\n    //  but it's a close enough approximation for our purposes\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\n    // incidence_stretch only applies to the y-axis, but without re-calculating the collision tile, we can't\n    // adjust the size of only one axis. So, we do a crude approximation at placement time to get the aspect ratio\n    // about right, and then do the rest of the adjustment here: there will be some extra padding on the x-axis,\n    // but hopefully not too much.\n    // Never make the adjustment less than 1.0: instead of allowing collisions on the x-axis, be conservative on\n    // the y-axis.\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\n\n    // Floor to 1/10th zoom to dodge precision issues that can cause partially hidden labels\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\n    vec2 fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\n\n    v_data0 = vec4(tex.x, tex.y, fade_tex.x, fade_tex.y);\n    v_data1 = vec2(gamma_scale, size);\n}\n"}};var d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,e=function(a){var c=b.exports[a],e={};c.fragmentSource=c.fragmentSource.replace(d,function(a,b,c,d,f){return e[f]=!0,"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nvarying "+c+" "+d+" "+f+";\n#else\nuniform "+c+" "+d+" u_"+f+";\n#endif\n":"initialize"===b?"\n#ifdef HAS_UNIFORM_u_"+f+"\n    "+c+" "+d+" "+f+" = u_"+f+";\n#endif\n":void 0}),c.vertexSource=c.vertexSource.replace(d,function(a,b,c,d,f){var g="float"===d?"vec2":"vec4";if(e[f]){if("define"===b)return"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float a_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\nvarying "+c+" "+d+" "+f+";\n#else\nuniform "+c+" "+d+" u_"+f+";\n#endif\n";if("initialize"===b)return"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = unpack_mix_"+g+"(a_"+f+", a_"+f+"_t);\n#else\n    "+c+" "+d+" "+f+" = u_"+f+";\n#endif\n"}else{if("define"===b)return"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float a_"+f+"_t;\nattribute "+c+" "+g+" a_"+f+";\n#else\nuniform "+c+" "+d+" u_"+f+";\n#endif\n";if("initialize"===b)return"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+d+" "+f+" = unpack_mix_"+g+"(a_"+f+", a_"+f+"_t);\n#else\n    "+c+" "+d+" "+f+" = u_"+f+";\n#endif\n"}})};for(var f in b.exports)e(f)},{}],92:[function(a,b,c){"use strict";var d=a("./image_source"),e=a("../util/window"),f=function(a){function b(b,c,d,e){a.call(this,b,c,d,e),this.options=c,this.animate=void 0===c.animate||c.animate}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){if(this.canvas=this.canvas||e.document.getElementById(this.options.canvas),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions())return this.fire("error",new Error("Canvas dimensions cannot be less than or equal to zero."));var a;this.play=function(){a=this.map.style.animationLoop.set(1/0),this.map._rerender()},this.pause=function(){this.map.style.animationLoop.cancel(a)},this._finishLoading()},b.prototype.getCanvas=function(){return this.canvas},b.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.canvas&&this.animate&&this.play())},b.prototype.prepare=function(){var a=!1;this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),this._hasInvalidDimensions()||0!==Object.keys(this.tiles).length&&this._prepareImage(this.map.painter.gl,this.canvas,a)},b.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}},b.prototype._hasInvalidDimensions=function(){for(var a=this,b=0,c=[a.canvas.width,a.canvas.height];b<c.length;b+=1){var d=c[b];if(isNaN(d)||d<=0)return!0}return!1},b}(d);b.exports=f},{"../util/window":199,"./image_source":96}],93:[function(a,b,c){"use strict";function d(a){var b=g.document.createElement("a");return b.href=a,b.href}var e=a("../util/evented"),f=a("../util/util"),g=a("../util/window"),h=a("../data/extent"),i=function(a){function b(b,c,d,e){a.call(this),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this.dispatcher=d,this.setEventedParent(e),this._data=c.data,this._options=f.extend({},c),void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type);var g=h/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*g,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*g,extent:h,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?Math.min(c.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:h,radius:(c.clusterRadius||50)*g,log:!1}},c.workerOptions)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(b){if(b)return void a.fire("error",{error:b});a.fire("data",{dataType:"source",sourceDataType:"metadata"})})},b.prototype.onAdd=function(a){this.load(),this.map=a},b.prototype.setData=function(a){var b=this;return this._data=a,this.fire("dataloading",{dataType:"source"}),this._updateWorkerData(function(a){if(a)return b.fire("error",{error:a});b.fire("data",{dataType:"source",sourceDataType:"content"})}),this},b.prototype._updateWorkerData=function(a){var b=this,c=f.extend({},this.workerOptions),e=this._data;"string"==typeof e?c.url=d(e):c.data=JSON.stringify(e),this.workerID=this.dispatcher.send(this.type+".loadData",c,function(c){b._loaded=!0,a(c)},this.workerID)},b.prototype.loadTile=function(a,b){var c=this,d=a.workerID&&"expired"!==a.state?"reloadTile":"loadTile",e={type:this.type,uid:a.uid,coord:a.coord,zoom:a.coord.z,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};a.workerID=this.dispatcher.send(d,e,function(d,e){if(a.unloadVectorData(),!a.aborted)return d?b(d):(a.loadVectorData(e,c.map.painter),a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(c)),b(null))},this.workerID)},b.prototype.abortTile=function(a){a.aborted=!0},b.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},function(){},a.workerID)},b.prototype.onRemove=function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id},function(){})},b.prototype.serialize=function(){return f.extend({},this._options,{type:this.type,data:this._data})},b}(e);b.exports=i},{"../data/extent":64,"../util/evented":205,"../util/util":218,"../util/window":199}],94:[function(a,b,c){"use strict";function d(a,b){var c=a.source,d=a.coord;if(!this._geoJSONIndexes[c])return b(null,null);var e=this._geoJSONIndexes[c].getTile(Math.min(d.z,a.maxZoom),d.x,d.y);if(!e)return b(null,null);var f=new g(e.features),i=h(f);0===i.byteOffset&&i.byteLength===i.buffer.byteLength||(i=new Uint8Array(i)),b(null,{vectorTile:f,rawData:i.buffer})}var e=a("../util/ajax"),f=a("geojson-rewind"),g=a("./geojson_wrapper"),h=a("vt-pbf"),i=a("supercluster"),j=a("geojson-vt"),k=a("./vector_tile_worker_source"),l=function(a){function b(b,c,e){a.call(this,b,c,d),e&&(this.loadGeoJSON=e),this._geoJSONIndexes={}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.loadData=function(a,b){var c=this;this.loadGeoJSON(a,function(d,e){if(d||!e)return b(d);if("object"!=typeof e)return b(new Error("Input data is not a valid GeoJSON object."));f(e,!0);try{c._geoJSONIndexes[a.source]=a.cluster?i(a.superclusterOptions).load(e.features):j(e,a.geojsonVtOptions)}catch(d){return b(d)}c.loaded[a.source]={},b(null)})},b.prototype.reloadTile=function(b,c){var d=this.loaded[b.source],e=b.uid;return d&&d[e]?a.prototype.reloadTile.call(this,b,c):this.loadTile(b,c)},b.prototype.loadGeoJSON=function(a,b){if(a.url)e.getJSON(a.url,b);else{if("string"!=typeof a.data)return b(new Error("Input data is not a valid GeoJSON object."));try{return b(null,JSON.parse(a.data))}catch(a){return b(new Error("Input data is not a valid GeoJSON object."))}}},b.prototype.removeSource=function(a){this._geoJSONIndexes[a.source]&&delete this._geoJSONIndexes[a.source]},b}(k);b.exports=l},{"../util/ajax":196,"./geojson_wrapper":95,"./vector_tile_worker_source":108,"geojson-rewind":10,"geojson-vt":14,supercluster:39,"vt-pbf":48}],95:[function(a,b,c){"use strict";var d=a("point-geometry"),e=a("vector-tile").VectorTileFeature.prototype.toGeoJSON,f=a("../data/extent"),g=function(a){var b=this;if(this.type=a.type,1===a.type){this.rawGeometry=[];for(var c=0;c<a.geometry.length;c++)b.rawGeometry.push([a.geometry[c]])}else this.rawGeometry=a.geometry;this.properties=a.tags,"id"in a&&!isNaN(a.id)&&(this.id=parseInt(a.id,10)),this.extent=f};g.prototype.loadGeometry=function(){var a=this,b=this.rawGeometry;this.geometry=[];for(var c=0;c<b.length;c++){for(var e=b[c],f=[],g=0;g<e.length;g++)f.push(new d(e[g][0],e[g][1]));a.geometry.push(f)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},g.prototype.toGeoJSON=function(){return e.apply(this,arguments)};var h=function(a){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f,this.length=a.length,this._features=a};h.prototype.feature=function(a){return new g(this._features[a])},b.exports=h},{"../data/extent":64,"point-geometry":36,"vector-tile":44}],96:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../util/window"),f=a("./tile_coord"),g=a("../geo/lng_lat"),h=a("point-geometry"),i=a("../util/evented"),j=a("../util/ajax"),k=a("../data/extent"),l=a("../data/raster_bounds_array"),m=a("../data/buffer"),n=a("../render/vertex_array_object"),o=function(a){function b(b,c,d,e){a.call(this),this.id=b,this.dispatcher=d,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(e),this.options=c,this.textureLoaded=!1}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"}),this.url=this.options.url,j.getImage(this.options.url,function(b,c){b?a.fire("error",{error:b}):c&&(a.image=c,a._finishLoading())})},b.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",sourceDataType:"metadata"}))},b.prototype.onAdd=function(a){this.load(),this.map=a,this.image&&this.setCoordinates(this.coordinates)},b.prototype.setCoordinates=function(a){this.coordinates=a;var b=this.map,c=a.map(function(a){return b.transform.locationCoordinate(g.convert(a)).zoomTo(0)}),e=this.centerCoord=d.getCoordinatesCenter(c);return e.column=Math.floor(e.column),e.row=Math.floor(e.row),this.coord=new f(e.zoom,e.column,e.row),this.minzoom=this.maxzoom=e.zoom,this._tileCoords=c.map(function(a){var b=a.zoomTo(e.zoom);return new h(Math.round((b.column-e.column)*k),Math.round((b.row-e.row)*k))}),this.fire("data",{dataType:"source",sourceDataType:"content"}),this},b.prototype._setTile=function(a){this.tiles[String(a.coord.w)]=a;var b=new l;b.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0),b.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,32767,0),b.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,32767),b.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,32767,32767),a.buckets={},a.boundsBuffer=m.fromStructArray(b,m.BufferType.VERTEX),a.boundsVAO=new n},b.prototype.prepare=function(){0===Object.keys(this.tiles).length!==0&&this.image&&this._prepareImage(this.map.painter.gl,this.image)},b.prototype._prepareImage=function(a,b,c){var d=this;this.textureLoaded?c?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b):(b instanceof e.HTMLVideoElement||b instanceof e.ImageData||b instanceof e.HTMLCanvasElement)&&(a.bindTexture(a.TEXTURE_2D,this.texture),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,b)):(this.textureLoaded=!0,this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b));for(var f in d.tiles){var g=d.tiles[f];"loaded"!==g.state&&(g.state="loaded",g.texture=d.texture)}},b.prototype.loadTile=function(a,b){this.coord&&this.coord.toString()===a.coord.toString()?(this._setTile(a),b(null)):(a.state="errored",b(null))},b.prototype.serialize=function(){return{type:"image",urls:this.url,coordinates:this.coordinates}},b}(i);b.exports=o},{"../data/buffer":61,"../data/extent":64,"../data/raster_bounds_array":69,"../geo/lng_lat":72,"../render/vertex_array_object":89,"../util/ajax":196,"../util/evented":205,"../util/util":218,"../util/window":199,"./tile_coord":106,"point-geometry":36}],97:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../util/ajax"),f=a("../util/browser"),g=a("../util/mapbox").normalizeSourceURL;b.exports=function(a,b){var c=function(a,c){if(a)return b(a);var e=d.pick(c,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);c.vector_layers&&(e.vectorLayers=c.vector_layers,e.vectorLayerIds=e.vectorLayers.map(function(a){return a.id})),b(null,e)};a.url?e.getJSON(g(a.url),c):f.frame(c.bind(null,null,a))}},{"../util/ajax":196,"../util/browser":197,"../util/mapbox":212,"../util/util":218}],98:[function(a,b,c){"use strict";var d=a("../data/extent");b.exports=function(a,b,c){return b*(d/(a.tileSize*Math.pow(2,c-a.coord.z)))}},{"../data/extent":64}],99:[function(a,b,c){"use strict";function d(a,b){var c=a.coord,d=b.coord;return c.z-d.z||c.y-d.y||c.w-d.w||c.x-d.x}function e(a){for(var b={},c={},d=0,e=a;d<e.length;d+=1){var f=e[d],g=f.queryResults,h=f.wrappedTileID,i=c[h]=c[h]||{};for(var j in g)for(var k=g[j],l=i[j]=i[j]||{},m=b[j]=b[j]||[],n=0,o=k;n<o.length;n+=1){var p=o[n];l[p.featureIndex]||(l[p.featureIndex]=!0,m.push(p.feature))}}return b}var f=a("./tile_coord");c.rendered=function(a,b,c,f,g,h){var i=a.tilesIn(c);i.sort(d);for(var j=[],k=0;k<i.length;k++){var l=i[k];l.tile.featureIndex&&j.push({wrappedTileID:l.coord.wrapped().id,queryResults:l.tile.featureIndex.query({queryGeometry:l.queryGeometry,scale:l.scale,tileSize:l.tile.tileSize,bearing:h,params:f},b)})}return e(j)},c.source=function(a,b){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),d=[],e={},g=0;g<c.length;g++){var h=c[g],i=new f(Math.min(h.sourceMaxZoom,h.coord.z),h.coord.x,h.coord.y,0).id;e[i]||(e[i]=!0,h.querySourceFeatures(d,b))}return d}},{"./tile_coord":106}],100:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../util/ajax"),f=a("../util/evented"),g=a("./load_tilejson"),h=a("../util/mapbox").normalizeTileURL,i=a("./tile_bounds"),j=function(a){function b(b,c,e,f){a.call(this),this.id=b,this.dispatcher=e,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.extend({},c),d.extend(this,d.pick(c,["url","scheme","tileSize"]))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"}),g(this._options,function(b,c){b?a.fire("error",b):c&&(d.extend(a,c),a.setBounds(c.bounds),a.fire("data",{dataType:"source",sourceDataType:"metadata"}),a.fire("data",{dataType:"source",sourceDataType:"content"}))})},b.prototype.onAdd=function(a){this.load(),this.map=a},b.prototype.setBounds=function(a){this.bounds=a,a&&(this.tileBounds=new i(a,this.minzoom,this.maxzoom))},b.prototype.serialize=function(){return d.extend({},this._options)},b.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a,this.maxzoom)},b.prototype.loadTile=function(a,b){var c=this,d=h(a.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);a.request=e.getImage(d,function(d,e){if(delete a.request,a.aborted)c.state="unloaded",b(null);else if(d)c.state="errored",b(d);else if(e){c.map._refreshExpiredTiles&&a.setExpiryData(e),delete e.cacheControl,delete e.expires;var f=c.map.painter.gl;a.texture=c.map.painter.getTileTexture(e.width),a.texture?(f.bindTexture(f.TEXTURE_2D,a.texture),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,e)):(a.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,a.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c.map.painter.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,c.map.painter.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.map.painter.extTextureFilterAnisotropicMax),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,e),a.texture.size=e.width),f.generateMipmap(f.TEXTURE_2D),a.state="loaded",b(null)}})},b.prototype.abortTile=function(a){a.request&&(a.request.abort(),delete a.request)},b.prototype.unloadTile=function(a){a.texture&&this.map.painter.saveTileTexture(a.texture)},b}(f);b.exports=j},{"../util/ajax":196,"../util/evented":205,"../util/mapbox":212,"../util/util":218,"./load_tilejson":97,"./tile_bounds":105}],101:[function(a,b,c){"use strict";var d=a("../util/ajax"),e=a("../util/evented"),f=a("../util/window"),g=!1,h=null;b.exports.evented=new e,b.exports.registerForPluginAvailability=function(a){return h?a({pluginBlobURL:h,errorCallback:b.exports.errorCallback}):b.exports.evented.once("pluginAvailable",a),a},b.exports.createBlobURL=function(a){return f.URL.createObjectURL(new f.Blob([a.data]),{type:"text/javascript"})},b.exports.clearRTLTextPlugin=function(){g=!1,h=null},b.exports.setRTLTextPlugin=function(a,c){if(g)throw new Error("setRTLTextPlugin cannot be called multiple times.");g=!0,b.exports.errorCallback=c,d.getArrayBuffer(a,function(a,d){a?c(a):d&&(h=b.exports.createBlobURL(d),b.exports.evented.fire("pluginAvailable",{pluginBlobURL:h,errorCallback:c}))})},b.exports.applyArabicShaping=null,b.exports.processBidirectionalText=null},{"../util/ajax":196,"../util/evented":205,"../util/window":199}],102:[function(a,b,c){"use strict";var d=a("../util/util"),e={vector:a("../source/vector_tile_source"),raster:a("../source/raster_tile_source"),geojson:a("../source/geojson_source"),video:a("../source/video_source"),image:a("../source/image_source"),canvas:a("../source/canvas_source")};c.create=function(a,b,c,f){var g=new e[b.type](a,b,c,f);if(g.id!==a)throw new Error("Expected Source id to be "+a+" instead of "+g.id);return d.bindAll(["load","abort","unload","serialize","prepare"],g),g},c.getType=function(a){return e[a]},c.setType=function(a,b){e[a]=b}},{"../source/canvas_source":92,"../source/geojson_source":93,"../source/image_source":96,"../source/raster_tile_source":100,"../source/vector_tile_source":107,"../source/video_source":109,"../util/util":218}],103:[function(a,b,c){"use strict";function d(a,b,c){var d=c.zoomTo(Math.min(a.z,b));return{x:(d.column-(a.x+a.w*Math.pow(2,a.z)))*n,y:(d.row-a.y)*n}}function e(a,b){return a%32-b%32}function f(a){return"raster"===a||"image"===a||"video"===a}var g=a("./source"),h=a("./tile"),i=a("../util/evented"),j=a("./tile_coord"),k=a("../util/lru_cache"),l=a("../geo/coordinate"),m=a("../util/util"),n=a("../data/extent"),o=function(a){function b(b,c,d){a.call(this),this.id=b,this.dispatcher=d,this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("error",function(){this._sourceErrored=!0}),this._source=g.create(b,c,d,this),this._tiles={},this._cache=new k(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},b.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},b.prototype.loaded=function(){var a=this;if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var b in a._tiles){var c=a._tiles[b];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0},b.prototype.getSource=function(){return this._source},b.prototype.pause=function(){this._paused=!0},b.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},b.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)},b.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a)},b.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a)},b.prototype.serialize=function(){return this._source.serialize()},b.prototype.prepare=function(){if(this._sourceLoaded&&this._source.prepare)return this._source.prepare()},b.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(e)},b.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},b.prototype._isIdRenderable=function(a){return this._tiles[a].hasData()&&!this._coveredTiles[a]},b.prototype.reload=function(){var a=this;if(this._paused)return void(this._shouldReloadOnResume=!0);this._cache.reset();for(var b in a._tiles)a._reloadTile(b,"reloading")},b.prototype._reloadTile=function(a,b){var c=this._tiles[a];c&&("loading"!==c.state&&(c.state=b),this._loadTile(c,this._tileLoaded.bind(this,c,a,b)))},b.prototype._tileLoaded=function(a,b,c,d){if(d)return a.state="errored",void(404!==d.status&&this._source.fire("error",{tile:a,error:d}));a.sourceCache=this,a.timeAdded=(new Date).getTime(),"expired"===c&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(b,a),this._source.fire("data",{dataType:"source",tile:a,coord:a.coord}),this.map&&(this.map.painter.tileExtentVAO.vao=null)},b.prototype.getTile=function(a){return this.getTileByID(a.id)},b.prototype.getTileByID=function(a){return this._tiles[a]},b.prototype.getZoom=function(a){return a.zoom+a.scaleZoom(a.tileSize/this._source.tileSize)},b.prototype._findLoadedChildren=function(a,b,c){var d=this,e=!1;for(var f in d._tiles){var g=d._tiles[f];if(!(c[f]||!g.hasData()||g.coord.z<=a.z||g.coord.z>b)){var h=Math.pow(2,Math.min(g.coord.z,d._source.maxzoom)-Math.min(a.z,d._source.maxzoom));if(Math.floor(g.coord.x/h)===a.x&&Math.floor(g.coord.y/h)===a.y)for(c[f]=!0,e=!0;g&&g.coord.z-1>a.z;){var i=g.coord.parent(d._source.maxzoom).id;(g=d._tiles[i])&&g.hasData()&&(delete c[f],c[i]=!0)}}}return e},b.prototype.findLoadedParent=function(a,b,c){for(var d=this,e=a.z-1;e>=b;e--){a=a.parent(d._source.maxzoom);var f=d._tiles[a.id];if(f&&f.hasData())return c[a.id]=!0,f;if(d._cache.has(a.id))return c[a.id]=!0,d._cache.getWithoutRemoving(a.id)}},b.prototype.updateCacheSize=function(a){var b=Math.ceil(a.width/a.tileSize)+1,c=Math.ceil(a.height/a.tileSize)+1,d=b*c,e=Math.floor(5*d),f="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,e):e;this._cache.setMaxSize(f)},b.prototype.update=function(a){var c=this;if(this.transform=a,this._sourceLoaded&&!this._paused){var d,e,g,h;this.updateCacheSize(a);var i=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(a)),k=Math.max(i-b.maxOverzooming,this._source.minzoom),l=Math.max(i+b.maxUnderzooming,this._source.minzoom),n={};this._coveredTiles={};var o;for(this.used?this._source.coord?o=a.getVisibleWrappedCoordinates(this._source.coord):(o=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),
this._source.hasTile&&(o=o.filter(function(a){return c._source.hasTile(a)}))):o=[],d=0;d<o.length;d++)e=o[d],g=c._addTile(e),n[e.id]=!0,g.hasData()||c._findLoadedChildren(e,l,n)||(h=c.findLoadedParent(e,k,n))&&c._addTile(h.coord);var p={};if(f(this._source.type))for(var q=Object.keys(n),r=0;r<q.length;r++){var s=q[r];e=j.fromID(s),(g=c._tiles[s])&&(void 0===g.fadeEndTime||g.fadeEndTime>=Date.now())&&(c._findLoadedChildren(e,l,n)&&(n[s]=!0),(h=c.findLoadedParent(e,k,p))&&c._addTile(h.coord))}var t;for(t in p)n[t]||(c._coveredTiles[t]=!0);for(t in p)n[t]=!0;var u=m.keysDifference(this._tiles,n);for(d=0;d<u.length;d++)c._removeTile(+u[d])}},b.prototype._addTile=function(a){var b=this._tiles[a.id];if(b)return b;(b=this._cache.get(a.id))&&(b.redoPlacement(this._source),this._cacheTimers[a.id]&&(clearTimeout(this._cacheTimers[a.id]),this._cacheTimers[a.id]=void 0,this._setTileReloadTimer(a.id,b)));var c=Boolean(b);if(!c){var d=a.z,e=d>this._source.maxzoom?Math.pow(2,d-this._source.maxzoom):1;b=new h(a,this._source.tileSize*e,this._source.maxzoom),this._loadTile(b,this._tileLoaded.bind(this,b,a.id,b.state))}return b.uses++,this._tiles[a.id]=b,c||this._source.fire("dataloading",{tile:b,coord:b.coord,dataType:"source"}),b},b.prototype._setTileReloadTimer=function(a,b){var c=this,d=b.getExpiryTimeout();d&&(this._timers[a]=setTimeout(function(){c._reloadTile(a,"expired"),c._timers[a]=void 0},d))},b.prototype._setCacheInvalidationTimer=function(a,b){var c=this,d=b.getExpiryTimeout();d&&(this._cacheTimers[a]=setTimeout(function(){c._cache.remove(a),c._cacheTimers[a]=void 0},d))},b.prototype._removeTile=function(a){var b=this._tiles[a];if(b&&(b.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),this._timers[a]=void 0),!(b.uses>0)))if(b.stopPlacementThrottler(),b.hasData()){var c=b.coord.wrapped().id;this._cache.add(c,b),this._setCacheInvalidationTimer(c,b)}else b.aborted=!0,this._abortTile(b),this._unloadTile(b)},b.prototype.clearTiles=function(){var a=this;this._shouldReloadOnResume=!1,this._paused=!1;for(var b in a._tiles)a._removeTile(b);this._cache.reset()},b.prototype.tilesIn=function(a){for(var b=this,c=[],e=this.getIds(),f=1/0,g=1/0,h=-1/0,i=-1/0,k=a[0].zoom,m=0;m<a.length;m++){var o=a[m];f=Math.min(f,o.column),g=Math.min(g,o.row),h=Math.max(h,o.column),i=Math.max(i,o.row)}for(var p=0;p<e.length;p++){var q=b._tiles[e[p]],r=j.fromID(e[p]),s=[d(r,q.sourceMaxZoom,new l(f,g,k)),d(r,q.sourceMaxZoom,new l(h,i,k))];if(s[0].x<n&&s[0].y<n&&s[1].x>=0&&s[1].y>=0){for(var t=[],u=0;u<a.length;u++)t.push(d(r,q.sourceMaxZoom,a[u]));c.push({tile:q,coord:r,queryGeometry:[t],scale:Math.pow(2,b.transform.zoom-q.coord.z)})}}return c},b.prototype.redoPlacement=function(){for(var a=this,b=this.getIds(),c=0;c<b.length;c++)a.getTileByID(b[c]).redoPlacement(a._source)},b.prototype.getVisibleCoordinates=function(){for(var a=this,b=this.getRenderableIds().map(j.fromID),c=0,d=b;c<d.length;c+=1){var e=d[c];e.posMatrix=a.transform.calculatePosMatrix(e,a._source.maxzoom)}return b},b}(i);o.maxOverzooming=10,o.maxUnderzooming=3,b.exports=o},{"../data/extent":64,"../geo/coordinate":71,"../util/evented":205,"../util/lru_cache":211,"../util/util":218,"./source":102,"./tile":104,"./tile_coord":106}],104:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../data/bucket"),f=a("../data/feature_index"),g=a("vector-tile"),h=a("pbf"),i=a("../util/vectortile_to_geojson"),j=a("../style-spec/feature_filter"),k=a("../symbol/collision_tile"),l=a("../symbol/collision_box"),m=a("../util/throttler"),n=function(a,b,c){this.coord=a,this.uid=d.uniqueId(),this.uses=0,this.tileSize=b,this.sourceMaxZoom=c,this.buckets={},this.expirationTime=null,this.expiredRequestCount=0,this.state="loading",this.placementThrottler=new m(300,this._immediateRedoPlacement.bind(this))};n.prototype.registerFadeDuration=function(a,b){var c=b+this.timeAdded;c<Date.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c,a.set(this.fadeEndTime-Date.now()))},n.prototype.loadVectorData=function(a,b){this.hasData()&&this.unloadVectorData(),this.state="loaded",a&&(a.rawTileData&&(this.rawTileData=a.rawTileData),this.collisionBoxArray=new l(a.collisionBoxArray),this.collisionTile=k.deserialize(a.collisionTile,this.collisionBoxArray),this.featureIndex=f.deserialize(a.featureIndex,this.rawTileData,this.collisionTile),this.buckets=e.deserialize(a.buckets,b.style))},n.prototype.reloadSymbolData=function(a,b){var c=this;if("unloaded"!==this.state){this.collisionTile=k.deserialize(a.collisionTile,this.collisionBoxArray),this.featureIndex&&this.featureIndex.setCollisionTile(this.collisionTile);for(var f in c.buckets){var g=c.buckets[f];"symbol"===g.layers[0].type&&(g.destroy(),delete c.buckets[f])}d.extend(this.buckets,e.deserialize(a.buckets,b))}},n.prototype.unloadVectorData=function(){var a=this;for(var b in a.buckets)a.buckets[b].destroy();this.buckets={},this.collisionBoxArray=null,this.collisionTile=null,this.featureIndex=null,this.state="unloaded"},n.prototype.redoPlacement=function(a){if("vector"===a.type||"geojson"===a.type){if("loaded"!==this.state)return void(this.redoWhenDone=!0);if(this.collisionTile){var b=a.map.transform.cameraToTileDistance(this);if(this.angle===a.map.transform.angle&&this.pitch===a.map.transform.pitch&&this.cameraToCenterDistance===a.map.transform.cameraToCenterDistance&&this.showCollisionBoxes===a.map.showCollisionBoxes){if(this.cameraToTileDistance===b)return;if(this.pitch<25)return void(this.cameraToTileDistance=b)}this.angle=a.map.transform.angle,this.pitch=a.map.transform.pitch,this.cameraToCenterDistance=a.map.transform.cameraToCenterDistance,this.cameraToTileDistance=b,this.showCollisionBoxes=a.map.showCollisionBoxes,this.placementSource=a,this.state="reloading",this.placementThrottler.invoke()}}},n.prototype._immediateRedoPlacement=function(){var a=this;this.placementSource.dispatcher.send("redoPlacement",{type:this.placementSource.type,uid:this.uid,source:this.placementSource.id,angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,showCollisionBoxes:this.showCollisionBoxes},function(b,c){a.state="loaded",a.reloadSymbolData(c,a.placementSource.map.style),a.placementSource.fire("data",{tile:a,coord:a.coord,dataType:"source"}),a.placementSource.map&&(a.placementSource.map.painter.tileExtentVAO.vao=null),a.redoWhenDone&&(a.redoWhenDone=!1,a._immediateRedoPlacement())},this.workerID)},n.prototype.getBucket=function(a){return this.buckets[a.id]},n.prototype.querySourceFeatures=function(a,b){var c=this;if(this.rawTileData){this.vtLayers||(this.vtLayers=new g.VectorTile(new h(this.rawTileData)).layers);var d=b?b.sourceLayer:"",e=this.vtLayers._geojsonTileLayer||this.vtLayers[d];if(e)for(var f=j(b&&b.filter),k={z:this.coord.z,x:this.coord.x,y:this.coord.y},l=0;l<e.length;l++){var m=e.feature(l);if(f(m)){var n=new i(m,c.coord.z,c.coord.x,c.coord.y);n.tile=k,a.push(n)}}}},n.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},n.prototype.setExpiryData=function(a){var b=this.expirationTime;if(a.cacheControl){var c=d.parseCacheControl(a.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){var e=Date.now(),f=!1;if(this.expirationTime>e)f=!1;else if(b)if(this.expirationTime<b)f=!0;else{var g=this.expirationTime-b;g?this.expirationTime=e+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},n.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},n.prototype.stopPlacementThrottler=function(){this.placementThrottler.stop(),"reloading"===this.state&&(this.state="loaded")},b.exports=n},{"../data/bucket":55,"../data/feature_index":65,"../style-spec/feature_filter":115,"../symbol/collision_box":163,"../symbol/collision_tile":165,"../util/throttler":216,"../util/util":218,"../util/vectortile_to_geojson":219,pbf:35,"vector-tile":44}],105:[function(a,b,c){"use strict";var d=a("../geo/lng_lat_bounds"),e=a("../util/util").clamp,f=function(a,b,c){this.bounds=d.convert(this.validateBounds(a)),this.minzoom=b||0,this.maxzoom=c||24};f.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},f.prototype.contains=function(a,b){var c=b?Math.min(a.z,b):a.z,d={minX:Math.floor(this.lngX(this.bounds.getWest(),c)),minY:Math.floor(this.latY(this.bounds.getNorth(),c)),maxX:Math.ceil(this.lngX(this.bounds.getEast(),c)),maxY:Math.ceil(this.latY(this.bounds.getSouth(),c))};return a.x>=d.minX&&a.x<d.maxX&&a.y>=d.minY&&a.y<d.maxY},f.prototype.lngX=function(a,b){return(a+180)*(Math.pow(2,b)/360)},f.prototype.latY=function(a,b){var c=e(Math.sin(Math.PI/180*a),-.9999,.9999),d=Math.pow(2,b)/(2*Math.PI);return Math.pow(2,b-1)+.5*Math.log((1+c)/(1-c))*-d},b.exports=f},{"../geo/lng_lat_bounds":73,"../util/util":218}],106:[function(a,b,c){"use strict";function d(a,b){if(a.row>b.row){var c=a;a=b,b=c}return{x0:a.column,y0:a.row,x1:b.column,y1:b.row,dx:b.column-a.column,dy:b.row-a.row}}function e(a,b,c,d,e){var f=Math.max(c,Math.floor(b.y0)),g=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var h=a;a=b,b=h}for(var i=a.dx/a.dy,j=b.dx/b.dy,k=a.dx>0,l=b.dx<0,m=f;m<g;m++){var n=i*Math.max(0,Math.min(a.dy,m+k-a.y0))+a.x0,o=j*Math.max(0,Math.min(b.dy,m+l-b.y0))+b.x0;e(Math.floor(o),Math.ceil(n),m)}}function f(a,b,c,f,g,h){var i,j=d(a,b),k=d(b,c),l=d(c,a);j.dy>k.dy&&(i=j,j=k,k=i),j.dy>l.dy&&(i=j,j=l,l=i),k.dy>l.dy&&(i=k,k=l,l=i),j.dy&&e(l,j,f,g,h),k.dy&&e(l,k,f,g,h)}function g(a,b,c){for(var d,e="",f=a;f>0;f--)d=1<<f-1,e+=(b&d?1:0)+(c&d?2:0);return e}var h=a("@mapbox/whoots-js"),i=a("../geo/coordinate"),j=function(a,b,c,d){(void 0===d||isNaN(d))&&(d=0),this.z=+a,this.x=+b,this.y=+c,this.w=+d,(d*=2)<0&&(d=-1*d-1);var e=1<<this.z;this.id=32*(e*e*d+e*this.y+this.x)+this.z,this.posMatrix=null};j.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y},j.prototype.toCoordinate=function(a){var b=Math.min(this.z,void 0===a?this.z:a),c=Math.pow(2,b),d=this.y,e=this.x+c*this.w;return new i(e,d,b)},j.prototype.url=function(a,b,c){var d=h.getTileBBox(this.x,this.y,this.z),e=g(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(Math.min(this.z,b||this.z))).replace("{x}",String(this.x)).replace("{y}",String("tms"===c?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",e).replace("{bbox-epsg-3857}",d)},j.prototype.parent=function(a){return 0===this.z?null:this.z>a?new j(this.z-1,this.x,this.y,this.w):new j(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)},j.prototype.wrapped=function(){return new j(this.z,this.x,this.y,0)},j.prototype.children=function(a){if(this.z>=a)return[new j(this.z+1,this.x,this.y,this.w)];var b=this.z+1,c=2*this.x,d=2*this.y;return[new j(b,c,d,this.w),new j(b,c+1,d,this.w),new j(b,c,d+1,this.w),new j(b,c+1,d+1,this.w)]},j.cover=function(a,b,c,d){function e(a,b,e){var f,i,k,l;if(e>=0&&e<=g)for(f=a;f<b;f++)i=Math.floor(f/g),k=(f%g+g)%g,0!==i&&!0!==d||(l=new j(c,k,e,i),h[l.id]=l)}void 0===d&&(d=!0);var g=1<<a,h={};return f(b[0],b[1],b[2],0,g,e),f(b[2],b[3],b[0],0,g,e),Object.keys(h).map(function(a){return h[a]})},j.fromID=function(a){var b=a%32,c=1<<b,d=(a-b)/32,e=d%c,f=(d-e)/c%c,g=Math.floor(d/(c*c));return g%2!=0&&(g=-1*g-1),g/=2,new j(b,e,f,g)},b.exports=j},{"../geo/coordinate":71,"@mapbox/whoots-js":5}],107:[function(a,b,c){"use strict";var d=a("../util/evented"),e=a("../util/util"),f=a("./load_tilejson"),g=a("../util/mapbox").normalizeTileURL,h=a("./tile_bounds"),i=function(a){function b(b,c,d,f){if(a.call(this),this.id=b,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,e.extend(this,e.pick(c,["url","scheme","tileSize"])),this._options=e.extend({type:"vector"},c),512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"}),f(this._options,function(b,c){b?a.fire("error",b):c&&(e.extend(a,c),a.setBounds(c.bounds),a.fire("data",{dataType:"source",sourceDataType:"metadata"}),a.fire("data",{dataType:"source",sourceDataType:"content"}))})},b.prototype.setBounds=function(a){this.bounds=a,a&&(this.tileBounds=new h(a,this.minzoom,this.maxzoom))},b.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a,this.maxzoom)},b.prototype.onAdd=function(a){this.load(),this.map=a},b.prototype.serialize=function(){return e.extend({},this._options)},b.prototype.loadTile=function(a,b){function c(c,d){if(!a.aborted){if(c)return b(c);this.map._refreshExpiredTiles&&a.setExpiryData(d),a.loadVectorData(d,this.map.painter),a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(this)),b(null),a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)}}var d=a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,e={url:g(a.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),uid:a.uid,coord:a.coord,zoom:a.coord.z,tileSize:this.tileSize*d,type:this.type,source:this.id,overscaling:d,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};a.workerID&&"expired"!==a.state?"loading"===a.state?a.reloadCallback=b:this.dispatcher.send("reloadTile",e,c.bind(this),a.workerID):a.workerID=this.dispatcher.send("loadTile",e,c.bind(this))},b.prototype.abortTile=function(a){this.dispatcher.send("abortTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)},b.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)},b}(d);b.exports=i},{"../util/evented":205,"../util/mapbox":212,"../util/util":218,"./load_tilejson":97,"./tile_bounds":105}],108:[function(a,b,c){"use strict";function d(a,b){var c=e.getArrayBuffer(a.url,function(a,c){a?b(a):c&&b(null,{vectorTile:new f.VectorTile(new g(c.data)),rawData:c.data,cacheControl:c.cacheControl,expires:c.expires})});return function(){c.abort()}}var e=a("../util/ajax"),f=a("vector-tile"),g=a("pbf"),h=a("./worker_tile"),i=a("../util/util"),j=function(a,b,c){this.actor=a,this.layerIndex=b,this.loadVectorData=c||d,this.loading={},this.loaded={}};j.prototype.loadTile=function(a,b){var c=this,d=a.source,e=a.uid;this.loading[d]||(this.loading[d]={});var f=this.loading[d][e]=new h(a);f.abort=this.loadVectorData(a,function(a,g){if(delete c.loading[d][e],a||!g)return b(a);var h=g.rawData,j={};g.expires&&(j.expires=g.expires),g.cacheControl&&(j.cacheControl=g.cacheControl),f.vectorTile=g.vectorTile,f.parse(g.vectorTile,c.layerIndex,c.actor,function(a,c,d){if(a||!c)return b(a);b(null,i.extend({rawTileData:h},c,j),d)}),c.loaded[d]=c.loaded[d]||{},c.loaded[d][e]=f})},j.prototype.reloadTile=function(a,b){function c(a,c){if(this.reloadCallback){var d=this.reloadCallback;delete this.reloadCallback,this.parse(this.vectorTile,f.layerIndex,f.actor,d)}b(a,c)}var d=this.loaded[a.source],e=a.uid,f=this;if(d&&d[e]){var g=d[e];"parsing"===g.status?g.reloadCallback=b:"done"===g.status&&g.parse(g.vectorTile,this.layerIndex,this.actor,c.bind(g))}},j.prototype.abortTile=function(a){var b=this.loading[a.source],c=a.uid;b&&b[c]&&b[c].abort&&(b[c].abort(),delete b[c])},j.prototype.removeTile=function(a){var b=this.loaded[a.source],c=a.uid;b&&b[c]&&delete b[c]},j.prototype.redoPlacement=function(a,b){var c=this.loaded[a.source],d=this.loading[a.source],e=a.uid;if(c&&c[e]){var f=c[e],g=f.redoPlacement(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,a.showCollisionBoxes);g.result&&b(null,g.result,g.transferables)}else d&&d[e]&&(d[e].angle=a.angle)},b.exports=j},{"../util/ajax":196,"../util/util":218,"./worker_tile":111,pbf:35,"vector-tile":44}],109:[function(a,b,c){"use strict";var d=a("../util/ajax"),e=a("./image_source"),f=function(a){function b(b,c,d,e){a.call(this,b,c,d,e),this.roundZoom=!0,this.type="video",this.options=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.load=function(){var a=this,b=this.options;this.urls=b.urls,d.getVideo(b.urls,function(b,c){if(b)a.fire("error",{error:b});else if(c){a.video=c,a.video.loop=!0;var d;a.video.addEventListener("playing",function(){d=a.map.style.animationLoop.set(1/0),a.map._rerender()}),a.video.addEventListener("pause",function(){a.map.style.animationLoop.cancel(d)}),a.map&&a.video.play(),a._finishLoading()}})},b.prototype.getVideo=function(){return this.video},b.prototype.onAdd=function(a){this.map||(this.load(),this.map=a,this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},b.prototype.prepare=function(){0===Object.keys(this.tiles).length||this.video.readyState<2||this._prepareImage(this.map.painter.gl,this.video)},b.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},b}(e);b.exports=f},{"../util/ajax":196,"./image_source":96}],110:[function(a,b,c){"use strict";var d=a("../util/actor"),e=a("../style/style_layer_index"),f=a("./vector_tile_worker_source"),g=a("./geojson_worker_source"),h=a("./rtl_text_plugin"),i=function(a){var b=this;this.self=a,this.actor=new d(a,this),this.layerIndexes={},this.workerSourceTypes={vector:f,geojson:g},this.workerSources={},this.self.registerWorkerSource=function(a,c){if(b.workerSourceTypes[a])throw new Error('Worker source with name "'+a+'" already registered.');b.workerSourceTypes[a]=c},this.self.registerRTLTextPlugin=function(a){if(h.applyArabicShaping||h.processBidirectionalText)throw new Error("RTL text plugin already registered.");h.applyArabicShaping=a.applyArabicShaping,h.processBidirectionalText=a.processBidirectionalText}};i.prototype.setLayers=function(a,b){this.getLayerIndex(a).replace(b)},i.prototype.updateLayers=function(a,b){this.getLayerIndex(a).update(b.layers,b.removedIds,b.symbolOrder)},i.prototype.loadTile=function(a,b,c){this.getWorkerSource(a,b.type).loadTile(b,c)},i.prototype.reloadTile=function(a,b,c){this.getWorkerSource(a,b.type).reloadTile(b,c)},i.prototype.abortTile=function(a,b){this.getWorkerSource(a,b.type).abortTile(b)},i.prototype.removeTile=function(a,b){this.getWorkerSource(a,b.type).removeTile(b)},i.prototype.removeSource=function(a,b){var c=this.getWorkerSource(a,b.type);void 0!==c.removeSource&&c.removeSource(b)},i.prototype.redoPlacement=function(a,b,c){this.getWorkerSource(a,b.type).redoPlacement(b,c)},i.prototype.loadWorkerSource=function(a,b,c){try{this.self.importScripts(b.url),c()}catch(a){c(a)}},i.prototype.loadRTLTextPlugin=function(a,b,c){try{h.applyArabicShaping||h.processBidirectionalText||(this.self.importScripts(b),h.applyArabicShaping&&h.processBidirectionalText||c(new Error("RTL Text Plugin failed to import scripts from "+b)))}catch(a){c(a)}},i.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];return b||(b=this.layerIndexes[a]=new e),b},i.prototype.getWorkerSource=function(a,b){var c=this;if(this.workerSources[a]||(this.workerSources[a]={}),!this.workerSources[a][b]){var d={send:function(b,d,e,f){c.actor.send(b,d,e,f,a)}};this.workerSources[a][b]=new this.workerSourceTypes[b](d,this.getLayerIndex(a))}return this.workerSources[a][b]},b.exports=function(a){return new i(a)}},{"../style/style_layer_index":157,"../util/actor":195,"./geojson_worker_source":94,"./rtl_text_plugin":101,"./vector_tile_worker_source":108}],111:[function(a,b,c){"use strict";function d(a,b){for(var c=0,d=a.layers;c<d.length;c+=1)d[c].recalculate(b)}function e(a,b){return a.filter(function(a){return!a.isEmpty()}).map(function(a){return a.serialize(b)})}var f=a("../data/feature_index"),g=a("../symbol/collision_tile"),h=a("../symbol/collision_box"),i=a("../util/dictionary_coder"),j=a("../util/util"),k=function(a){this.coord=a.coord,this.uid=a.uid,this.zoom=a.zoom,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=a.overscaling,this.angle=a.angle,this.pitch=a.pitch,this.cameraToCenterDistance=a.cameraToCenterDistance,this.cameraToTileDistance=a.cameraToTileDistance,this.showCollisionBoxes=a.showCollisionBoxes};k.prototype.parse=function(a,b,c,k){var l=this;this.status="parsing",this.data=a,this.collisionBoxArray=new h;var m=new i(Object.keys(a.layers).sort()),n=new f(this.coord,this.overscaling);n.bucketLayerIDs=[];var o={},p={featureIndex:n,iconDependencies:{},glyphDependencies:{}},q=b.familiesBySource[this.source];for(var r in q){var s=a.layers[r];if(s){1===s.version&&j.warnOnce('Vector tile source "'+l.source+'" layer "'+r+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var t=m.encode(r),u=[],v=0;v<s.length;v++){var w=s.feature(v);u.push({feature:w,index:v,sourceLayerIndex:t})}for(var x=0,y=q[r];x<y.length;x+=1){var z=y[x],A=z[0];if(!(A.minzoom&&l.zoom<A.minzoom||A.maxzoom&&l.zoom>=A.maxzoom||A.layout&&"none"===A.layout.visibility)){for(var B=0,C=z;B<C.length;B+=1)C[B].recalculate(l.zoom);(o[A.id]=A.createBucket({index:n.bucketLayerIDs.length,layers:z,zoom:l.zoom,overscaling:l.overscaling,collisionBoxArray:l.collisionBoxArray})).populate(u,p),n.bucketLayerIDs.push(z.map(function(a){return a.id}))}}}}var D=function(a){l.status="done",n.paintPropertyStatistics={};for(var b in o)j.extend(n.paintPropertyStatistics,o[b].getPaintPropertyStatistics());var c=[];k(null,{buckets:e(j.values(o),c),featureIndex:n.serialize(c),collisionTile:a.serialize(c),collisionBoxArray:l.collisionBoxArray.serialize()},c)};this.symbolBuckets=[];for(var E=b.symbolOrder.length-1;E>=0;E--){var F=o[b.symbolOrder[E]];F&&l.symbolBuckets.push(F)}if(0===this.symbolBuckets.length)return D(new g(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray));var G=0,H=Object.keys(p.iconDependencies),I=j.mapObject(p.glyphDependencies,function(a){return Object.keys(a).map(Number)}),J=function(a){if(a)return k(a);if(2==++G){for(var b=new g(l.angle,l.pitch,l.cameraToCenterDistance,l.cameraToTileDistance,l.collisionBoxArray),c=0,e=l.symbolBuckets;c<e.length;c+=1){var f=e[c];d(f,l.zoom),f.prepare(I,H),f.place(b,l.showCollisionBoxes)}D(b)}};Object.keys(I).length?c.send("getGlyphs",{uid:this.uid,stacks:I},function(a,b){I=b,J(a)}):J(),H.length?c.send("getIcons",{icons:H},function(a,b){H=b,J(a)}):J()},k.prototype.redoPlacement=function(a,b,c,f,h){var i=this;if(this.angle=a,this.pitch=b,this.cameraToCenterDistance=c,this.cameraToTileDistance=f,"done"!==this.status)return{};for(var j=new g(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray),k=0,l=i.symbolBuckets;k<l.length;k+=1){var m=l[k];d(m,i.zoom),m.place(j,h)}var n=[];return{result:{buckets:e(this.symbolBuckets,n),collisionTile:j.serialize(n)},transferables:n}},b.exports=k},{"../data/feature_index":65,"../symbol/collision_box":163,"../symbol/collision_tile":165,"../util/dictionary_coder":202,"../util/util":218}],112:[function(a,b,c){"use strict";function d(a,b){var c={};for(var d in a)"ref"!==d&&(c[d]=a[d]);return f.forEach(function(a){a in b&&(c[a]=b[a])}),c}function e(a){a=a.slice();for(var b=Object.create(null),c=0;c<a.length;c++)b[a[c].id]=a[c];for(var e=0;e<a.length;e++)"ref"in a[e]&&(a[e]=d(a[e],b[a[e].ref]));return a}var f=a("./util/ref_properties");b.exports=e},{"./util/ref_properties":125}],113:[function(a,b,c){"use strict";function d(a,b,c,d){a=a||{},b=b||{};var e;for(e in a)a.hasOwnProperty(e)&&(b.hasOwnProperty(e)||(c.push({command:k.removeSource,args:[e]}),d[e]=!0));for(e in b)b.hasOwnProperty(e)&&(a.hasOwnProperty(e)?j(a[e],b[e])||(c.push({command:k.removeSource,args:[e]}),c.push({command:k.addSource,args:[e,b[e]]}),d[e]=!0):c.push({command:k.addSource,args:[e,b[e]]}))}function e(a,b,c,d,e,f){a=a||{},b=b||{};var g;for(g in a)a.hasOwnProperty(g)&&(j(a[g],b[g])||c.push({command:f,args:[d,g,b[g],e]}));for(g in b)b.hasOwnProperty(g)&&!a.hasOwnProperty(g)&&(j(a[g],b[g])||c.push({command:f,args:[d,g,b[g],e]}))}function f(a){return a.id}function g(a,b){return a[b.id]=b,a}function h(a,b,c){a=a||[],b=b||[];var d,h,i,l,m,n,o,p=a.map(f),q=b.map(f),r=a.reduce(g,{}),s=b.reduce(g,{}),t=p.slice(),u=Object.create(null);for(d=0,h=0;d<p.length;d++)i=p[d],s.hasOwnProperty(i)?h++:(c.push({command:k.removeLayer,args:[i]}),t.splice(t.indexOf(i,h),1));for(d=0,h=0;d<q.length;d++)i=q[q.length-1-d],t[t.length-1-d]!==i&&(r.hasOwnProperty(i)?(c.push({command:k.removeLayer,args:[i]}),t.splice(t.lastIndexOf(i,t.length-h),1)):h++,n=t[t.length-d],c.push({command:k.addLayer,args:[s[i],n]}),t.splice(t.length-d,0,i),u[i]=!0);for(d=0;d<q.length;d++)if(i=q[d],l=r[i],m=s[i],!u[i]&&!j(l,m))if(j(l.source,m.source)&&j(l["source-layer"],m["source-layer"])&&j(l.type,m.type)){e(l.layout,m.layout,c,i,null,k.setLayoutProperty),e(l.paint,m.paint,c,i,null,k.setPaintProperty),j(l.filter,m.filter)||c.push({command:k.setFilter,args:[i,m.filter]}),j(l.minzoom,m.minzoom)&&j(l.maxzoom,m.maxzoom)||c.push({command:k.setLayerZoomRange,args:[i,m.minzoom,m.maxzoom]});for(o in l)l.hasOwnProperty(o)&&"layout"!==o&&"paint"!==o&&"filter"!==o&&"metadata"!==o&&"minzoom"!==o&&"maxzoom"!==o&&(0===o.indexOf("paint.")?e(l[o],m[o],c,i,o.slice(6),k.setPaintProperty):j(l[o],m[o])||c.push({command:k.setLayerProperty,args:[i,o,m[o]]}));for(o in m)m.hasOwnProperty(o)&&!l.hasOwnProperty(o)&&"layout"!==o&&"paint"!==o&&"filter"!==o&&"metadata"!==o&&"minzoom"!==o&&"maxzoom"!==o&&(0===o.indexOf("paint.")?e(l[o],m[o],c,i,o.slice(6),k.setPaintProperty):j(l[o],m[o])||c.push({command:k.setLayerProperty,args:[i,o,m[o]]}))}else c.push({command:k.removeLayer,args:[i]}),n=t[t.lastIndexOf(i)+1],c.push({command:k.addLayer,args:[m,n]})}function i(a,b){if(!a)return[{command:k.setStyle,args:[b]}];var c=[];try{if(!j(a.version,b.version))return[{command:k.setStyle,args:[b]}];j(a.center,b.center)||c.push({command:k.setCenter,args:[b.center]}),j(a.zoom,b.zoom)||c.push({command:k.setZoom,args:[b.zoom]}),j(a.bearing,b.bearing)||c.push({command:k.setBearing,args:[b.bearing]}),j(a.pitch,b.pitch)||c.push({command:k.setPitch,args:[b.pitch]}),j(a.sprite,b.sprite)||c.push({command:k.setSprite,args:[b.sprite]}),j(a.glyphs,b.glyphs)||c.push({command:k.setGlyphs,args:[b.glyphs]}),j(a.transition,b.transition)||c.push({command:k.setTransition,args:[b.transition]}),j(a.light,b.light)||c.push({command:k.setLight,args:[b.light]});var e={},f=[];d(a.sources,b.sources,f,e);var g=[];a.layers&&a.layers.forEach(function(a){e[a.source]?c.push({command:k.removeLayer,args:[a.id]}):g.push(a)}),c=c.concat(f),h(g,b.layers,c)}catch(a){console.warn("Unable to compute style diff:",a),c=[{command:k.setStyle,args:[b]}]}return c}var j=a("lodash.isequal"),k={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};b.exports=i,b.exports.operations=k},{"lodash.isequal":30}],114:[function(a,b,c){"use strict";function d(a,b){for(var c=[],d=arguments.length-2;d-- >0;)c[d]=arguments[d+2];this.message=(a?a+": ":"")+e.apply(e,c),null!==b&&void 0!==b&&b.__line__&&(this.line=b.__line__)}var e=a("util").format;b.exports=d},{util:43}],115:[function(a,b,c){"use strict";function d(a){return new Function("f","var p = (f && f.properties || {}); return "+e(a))}function e(a){if(!a)return"true";var b=a[0];return a.length<=1?"any"===b?"false":"true":"("+("=="===b?g(a[1],a[2],"===",!1):"!="===b?g(a[1],a[2],"!==",!1):"<"===b||">"===b||"<="===b||">="===b?g(a[1],a[2],b,!0):"any"===b?h(a.slice(1),"||"):"all"===b?h(a.slice(1),"&&"):"none"===b?k(h(a.slice(1),"||")):"in"===b?i(a[1],a.slice(2)):"!in"===b?k(i(a[1],a.slice(2))):"has"===b?j(a[1]):"!has"===b?k(j(a[1])):"true")+")"}function f(a){return"$type"===a?"f.type":"$id"===a?"f.id":"p["+JSON.stringify(a)+"]"}function g(a,b,c,d){var e=f(a),g="$type"===a?m.indexOf(b):JSON.stringify(b);return(d?"typeof "+e+"=== typeof "+g+"&&":"")+e+c+g}function h(a,b){return a.map(e).join(b)}function i(a,b){"$type"===a&&(b=b.map(function(a){return m.indexOf(a)}));var c=JSON.stringify(b.sort(l)),d=f(a);return b.length<=200?c+".indexOf("+d+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+d+", "+c+",0,"+(b.length-1)+")"}function j(a){return"$id"===a?'"id" in f':JSON.stringify(a)+" in p"}function k(a){return"!("+a+")"}function l(a,b){return a<b?-1:a>b?1:0}b.exports=d;var m=["Unknown","Point","LineString","Polygon"]},{}],116:[function(a,b,c){"use strict";function d(a){return a>r?Math.pow(a,1/3):a/q+o}function e(a){return a>p?a*a*a:q*(a-o)}function f(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function g(a){return a/=255,a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function h(a){var b=g(a[0]),c=g(a[1]),e=g(a[2]),f=d((.4124564*b+.3575761*c+.1804375*e)/l),h=d((.2126729*b+.7151522*c+.072175*e)/m);return[116*h-16,500*(f-h),200*(h-d((.0193339*b+.119192*c+.9503041*e)/n)),a[3]]}function i(a){var b=(a[0]+16)/116,c=isNaN(a[1])?b:b+a[1]/500,d=isNaN(a[2])?b:b-a[2]/200;return b=m*e(b),c=l*e(c),d=n*e(d),[f(3.2404542*c-1.5371385*b-.4985314*d),f(-.969266*c+1.8760108*b+.041556*d),f(.0556434*c-.2040259*b+1.0572252*d),a[3]]}function j(a){var b=h(a),c=b[0],d=b[1],e=b[2],f=Math.atan2(e,d)*t;return[f<0?f+360:f,Math.sqrt(d*d+e*e),c,a[3]]}function k(a){var b=a[0]*s,c=a[1];return i([a[2],Math.cos(b)*c,Math.sin(b)*c,a[3]])}var l=.95047,m=1,n=1.08883,o=4/29,p=6/29,q=3*p*p,r=p*p*p,s=Math.PI/180,t=180/Math.PI;b.exports={lab:{forward:h,reverse:i},hcl:{forward:j,reverse:k}}},{}],117:[function(a,b,c){"use strict";function d(a){return a}function e(a,b){var c,k="color"===b.type;if(l(a)){var m=a.stops&&"object"==typeof a.stops[0][0],q=m||void 0!==a.property,r=m||!q,s=a.type||("interpolated"===b.function?"exponential":"interval");k&&(a=p({},a),a.stops&&(a.stops=a.stops.map(function(a){return[a[0],o(a[1])]})),a.default?a.default=o(a.default):a.default=o(b.default));var t,u,v;if("exponential"===s)t=i;else if("interval"===s)t=h;else if("categorical"===s){t=g,u=Object.create(null);for(var w=0,x=a.stops;w<x.length;w+=1){var y=x[w];u[y[0]]=y[1]}v=typeof a.stops[0][0]}else{if("identity"!==s)throw new Error('Unknown function type "'+s+'"');t=j}var z;if(a.colorSpace&&"rgb"!==a.colorSpace){if(!n[a.colorSpace])throw new Error("Unknown color space: "+a.colorSpace);var A=n[a.colorSpace];a=JSON.parse(JSON.stringify(a));for(var B=0;B<a.stops.length;B++)a.stops[B]=[a.stops[B][0],A.forward(a.stops[B][1])];z=A.reverse}else z=d;if(m){for(var C={},D=[],E=0;E<a.stops.length;E++){var F=a.stops[E],G=F[0].zoom;void 0===C[G]&&(C[G]={zoom:G,type:a.type,property:a.property,default:a.default,stops:[]},D.push(G)),C[G].stops.push([F[0].value,F[1]])}for(var H=[],I=0,J=D;I<J.length;I+=1){var K=J[I];H.push([C[K].zoom,e(C[K],b)])}c=function(c,d){return z(i({stops:H,base:a.base},b,c)(c,d))},c.isFeatureConstant=!1,c.isZoomConstant=!1}else r?(c=function(c){return z(t(a,b,c,u,v))},c.isFeatureConstant=!0,c.isZoomConstant=!1):(c=function(c,d){var e=d[a.property];return void 0===e?f(a.default,b.default):z(t(a,b,e,u,v))},c.isFeatureConstant=!1,
c.isZoomConstant=!0)}else k&&a&&(a=o(a)),c=function(){return a},c.isFeatureConstant=!0,c.isZoomConstant=!0;return c}function f(a,b,c){return void 0!==a?a:void 0!==b?b:void 0!==c?c:void 0}function g(a,b,c,d,e){return f(typeof c===e?d[c]:void 0,a.default,b.default)}function h(a,b,c){if("number"!==q(c))return f(a.default,b.default);var d=a.stops.length;if(1===d)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];var e=k(a.stops,c);return a.stops[e][1]}function i(a,b,c){var e=void 0!==a.base?a.base:1;if("number"!==q(c))return f(a.default,b.default);var g=a.stops.length;if(1===g)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[g-1][0])return a.stops[g-1][1];var h=k(a.stops,c),i=m(c,e,a.stops[h][0],a.stops[h+1][0]),j=a.stops[h][1],l=a.stops[h+1][1],n=r[b.type]||d;return"function"==typeof j?function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c=j.apply(void 0,a),d=l.apply(void 0,a);if(void 0!==c&&void 0!==d)return n(c,d,i)}:n(j,l,i)}function j(a,b,c){return"color"===b.type?c=o(c):q(c)===b.type||"enum"===b.type&&b.values[c]||(c=void 0),f(c,a.default,b.default)}function k(a,b){for(var c,d,e=a.length,f=0,g=e-1,h=0;f<=g;){if(h=Math.floor((f+g)/2),c=a[h][0],d=a[h+1][0],b===c||b>c&&b<d)return h;c<b?f=h+1:c>b&&(g=h-1)}return Math.max(h-1,0)}function l(a){return"object"==typeof a&&(a.stops||"identity"===a.type)}function m(a,b,c,d){var e=d-c,f=a-c;return 1===b?f/e:(Math.pow(b,f)-1)/(Math.pow(b,e)-1)}var n=a("./color_spaces"),o=a("../util/parse_color"),p=a("../util/extend"),q=a("../util/get_type"),r=a("../util/interpolate");b.exports=e,b.exports.isFunctionDefinition=l,b.exports.interpolationFactor=m,b.exports.findStopLessThanOrEqualTo=k},{"../util/extend":121,"../util/get_type":122,"../util/interpolate":123,"../util/parse_color":124,"./color_spaces":116}],118:[function(a,b,c){"use strict";function d(a){return g(f.map(function(b){return a[b]}))}function e(a){for(var b={},c=0;c<a.length;c++){var e=d(a[c]),f=b[e];f||(f=b[e]=[]),f.push(a[c])}var g=[];for(var h in b)g.push(b[h]);return g}var f=a("./util/ref_properties"),g=a("fast-stable-stringify");b.exports=e},{"./util/ref_properties":125,"fast-stable-stringify":8}],119:[function(a,b,c){"use strict";b.exports=a("./v8.json")},{"./v8.json":120}],120:[function(a,b,c){b.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image","source_canvas"],source_tile:{type:{required:!0,type:"enum",values:{vector:{},raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_canvas:{type:{required:!0,type:"enum",values:{canvas:{}}},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}},animate:{type:"boolean",default:"true"},canvas:{type:"string",required:!0}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},"fill-extrusion":{},raster:{},background:{}}},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"},"paint.*":{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_fill-extrusion","layout_symbol","layout_raster","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_fill-extrusion","paint_symbol","paint_raster","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,maximum:65535,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,maximum:65535,units:"meters",transition:!0,requires:["fill-extrusion-height"]}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}}}},{}],121:[function(a,b,c){"use strict";b.exports=function(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}},{}],122:[function(a,b,c){"use strict";b.exports=function(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}},{}],123:[function(a,b,c){"use strict";function d(a,b,c){return a*(1-c)+b*c}b.exports=d,d.number=d,d.vec2=function(a,b,c){return[d(a[0],b[0],c),d(a[1],b[1],c)]},d.color=function(a,b,c){return[d(a[0],b[0],c),d(a[1],b[1],c),d(a[2],b[2],c),d(a[3],b[3],c)]},d.array=function(a,b,c){return a.map(function(a,e){return d(a,b[e],c)})}},{}],124:[function(a,b,c){"use strict";var d=a("csscolorparser").parseCSSColor;b.exports=function(a){if("string"==typeof a){var b=d(a);if(!b)return;return[b[0]/255*b[3],b[1]/255*b[3],b[2]/255*b[3],b[3]]}return Array.isArray(a)?a:void 0}},{csscolorparser:6}],125:[function(a,b,c){"use strict";b.exports=["type","source","source-layer","minzoom","maxzoom","filter","layout"]},{}],126:[function(a,b,c){"use strict";b.exports=function(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}},{}],127:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type"),f=a("../util/extend");b.exports=function(b){var c=a("./validate_function"),g=a("./validate_object"),h={"*":function(){return[]},array:a("./validate_array"),boolean:a("./validate_boolean"),number:a("./validate_number"),color:a("./validate_color"),constants:a("./validate_constants"),enum:a("./validate_enum"),filter:a("./validate_filter"),function:a("./validate_function"),layer:a("./validate_layer"),object:a("./validate_object"),source:a("./validate_source"),light:a("./validate_light"),string:a("./validate_string")},i=b.value,j=b.valueSpec,k=b.key,l=b.styleSpec,m=b.style;if("string"===e(i)&&"@"===i[0]){if(l.$version>7)return[new d(k,i,"constants have been deprecated as of v8")];if(!(i in m.constants))return[new d(k,i,'constant "%s" not found',i)];b=f({},b,{value:m.constants[i]})}return j.function&&"object"===e(i)?c(b):j.type&&h[j.type]?h[j.type](b):g(f({},b,{valueSpec:j.type?l[j.type]:j}))}},{"../error/validation_error":114,"../util/extend":121,"../util/get_type":122,"./validate_array":128,"./validate_boolean":129,"./validate_color":130,"./validate_constants":131,"./validate_enum":132,"./validate_filter":133,"./validate_function":134,"./validate_layer":136,"./validate_light":138,"./validate_number":139,"./validate_object":140,"./validate_source":143,"./validate_string":144}],128:[function(a,b,c){"use strict";var d=a("../util/get_type"),e=a("./validate"),f=a("../error/validation_error");b.exports=function(a){var b=a.value,c=a.valueSpec,g=a.style,h=a.styleSpec,i=a.key,j=a.arrayElementValidator||e;if("array"!==d(b))return[new f(i,b,"array expected, %s found",d(b))];if(c.length&&b.length!==c.length)return[new f(i,b,"array length %d expected, length %d found",c.length,b.length)];if(c["min-length"]&&b.length<c["min-length"])return[new f(i,b,"array length at least %d expected, length %d found",c["min-length"],b.length)];var k={type:c.value};h.$version<7&&(k.function=c.function),"object"===d(c.value)&&(k=c.value);for(var l=[],m=0;m<b.length;m++)l=l.concat(j({array:b,arrayIndex:m,value:b[m],valueSpec:k,style:g,styleSpec:h,key:i+"["+m+"]"}));return l}},{"../error/validation_error":114,"../util/get_type":122,"./validate":127}],129:[function(a,b,c){"use strict";var d=a("../util/get_type"),e=a("../error/validation_error");b.exports=function(a){var b=a.value,c=a.key,f=d(b);return"boolean"!==f?[new e(c,b,"boolean expected, %s found",f)]:[]}},{"../error/validation_error":114,"../util/get_type":122}],130:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type"),f=a("csscolorparser").parseCSSColor;b.exports=function(a){var b=a.key,c=a.value,g=e(c);return"string"!==g?[new d(b,c,"color expected, %s found",g)]:null===f(c)?[new d(b,c,'color expected, "%s" found',c)]:[]}},{"../error/validation_error":114,"../util/get_type":122,csscolorparser:6}],131:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type");b.exports=function(a){var b=a.key,c=a.value;if(a.styleSpec.$version>7)return c?[new d(b,c,"constants have been deprecated as of v8")]:[];var f=e(c);if("object"!==f)return[new d(b,c,"object expected, %s found",f)];var g=[];for(var h in c)"@"!==h[0]&&g.push(new d(b+"."+h,c[h],'constants must start with "@"'));return g}},{"../error/validation_error":114,"../util/get_type":122}],132:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/unbundle_jsonlint");b.exports=function(a){var b=a.key,c=a.value,f=a.valueSpec,g=[];return Array.isArray(f.values)?-1===f.values.indexOf(e(c))&&g.push(new d(b,c,"expected one of [%s], %s found",f.values.join(", "),c)):-1===Object.keys(f.values).indexOf(e(c))&&g.push(new d(b,c,"expected one of [%s], %s found",Object.keys(f.values).join(", "),c)),g}},{"../error/validation_error":114,"../util/unbundle_jsonlint":126}],133:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("./validate_enum"),f=a("../util/get_type"),g=a("../util/unbundle_jsonlint");b.exports=function a(b){var c,h=b.value,i=b.key,j=b.styleSpec,k=[];if("array"!==f(h))return[new d(i,h,"array expected, %s found",f(h))];if(h.length<1)return[new d(i,h,"filter array must have at least 1 element")];switch(k=k.concat(e({key:i+"[0]",value:h[0],valueSpec:j.filter_operator,style:b.style,styleSpec:b.styleSpec})),g(h[0])){case"<":case"<=":case">":case">=":h.length>=2&&"$type"===g(h[1])&&k.push(new d(i,h,'"$type" cannot be use with operator "%s"',h[0]));case"==":case"!=":3!==h.length&&k.push(new d(i,h,'filter array for operator "%s" must have 3 elements',h[0]));case"in":case"!in":h.length>=2&&"string"!==(c=f(h[1]))&&k.push(new d(i+"[1]",h[1],"string expected, %s found",c));for(var l=2;l<h.length;l++)c=f(h[l]),"$type"===g(h[1])?k=k.concat(e({key:i+"["+l+"]",value:h[l],valueSpec:j.geometry_type,style:b.style,styleSpec:b.styleSpec})):"string"!==c&&"number"!==c&&"boolean"!==c&&k.push(new d(i+"["+l+"]",h[l],"string, number, or boolean expected, %s found",c));break;case"any":case"all":case"none":for(var m=1;m<h.length;m++)k=k.concat(a({key:i+"["+m+"]",value:h[m],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":c=f(h[1]),2!==h.length?k.push(new d(i,h,'filter array for "%s" operator must have 2 elements',h[0])):"string"!==c&&k.push(new d(i+"[1]",h[1],"string expected, %s found",c))}return k}},{"../error/validation_error":114,"../util/get_type":122,"../util/unbundle_jsonlint":126,"./validate_enum":132}],134:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type"),f=a("./validate"),g=a("./validate_object"),h=a("./validate_array"),i=a("./validate_number"),j=a("../util/unbundle_jsonlint");b.exports=function(a){function b(a){if("identity"===q)return[new d(a.key,a.value,'identity function may not have a "stops" property')];var b=[],f=a.value;return b=b.concat(h({key:a.key,value:f,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:c})),"array"===e(f)&&0===f.length&&b.push(new d(a.key,f,"array must have at least one stop")),b}function c(a){var b=[],c=a.value,h=a.key;if("array"!==e(c))return[new d(h,c,"array expected, %s found",e(c))];if(2!==c.length)return[new d(h,c,"array length %d expected, length %d found",2,c.length)];if(u){if("object"!==e(c[0]))return[new d(h,c,"object expected, %s found",e(c[0]))];if(void 0===c[0].zoom)return[new d(h,c,"object stop key must have zoom")];if(void 0===c[0].value)return[new d(h,c,"object stop key must have value")];if(o&&o>j(c[0].zoom))return[new d(h,c[0].zoom,"stop zoom values must appear in ascending order")];j(c[0].zoom)!==o&&(o=j(c[0].zoom),n=void 0,r={}),b=b.concat(g({key:h+"[0]",value:c[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:i,value:k}}))}else b=b.concat(k({key:h+"[0]",value:c[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec}));return b.concat(f({key:h+"[1]",value:c[1],valueSpec:p,style:a.style,styleSpec:a.styleSpec}))}function k(a){var b=e(a.value),c=j(a.value);if(m){if(b!==m)return[new d(a.key,a.value,"%s stop domain type must match previous stop domain type %s",b,m)]}else m=b;if("number"!==b&&"string"!==b&&"boolean"!==b)return[new d(a.key,a.value,"stop domain value must be a number, string, or boolean")];if("number"!==b&&"categorical"!==q){var f="number expected, %s found";return p["property-function"]&&void 0===q&&(f+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new d(a.key,a.value,f,b)]}return"categorical"!==q||"number"!==b||isFinite(c)&&Math.floor(c)===c?"categorical"!==q&&"number"===b&&void 0!==n&&c<n?[new d(a.key,a.value,"stop domain values must appear in ascending order")]:(n=c,"categorical"===q&&c in r?[new d(a.key,a.value,"stop domain values must be unique")]:(r[c]=!0,[])):[new d(a.key,a.value,"integer expected, found %s",c)]}function l(a){return f({key:a.key,value:a.value,valueSpec:p,style:a.style,styleSpec:a.styleSpec})}var m,n,o,p=a.valueSpec,q=j(a.value.type),r={},s="categorical"!==q&&void 0===a.value.property,t=!s,u="array"===e(a.value.stops)&&"array"===e(a.value.stops[0])&&"object"===e(a.value.stops[0][0]),v=g({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:b,default:l}});return"identity"===q&&s&&v.push(new d(a.key,a.value,'missing required property "property"')),"identity"===q||a.value.stops||v.push(new d(a.key,a.value,'missing required property "stops"')),"exponential"===q&&"piecewise-constant"===a.valueSpec.function&&v.push(new d(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(t&&!a.valueSpec["property-function"]?v.push(new d(a.key,a.value,"property functions not supported")):s&&!a.valueSpec["zoom-function"]&&v.push(new d(a.key,a.value,"zoom functions not supported"))),"categorical"!==q&&!u||void 0!==a.value.property||v.push(new d(a.key,a.value,'"property" property is required')),v}},{"../error/validation_error":114,"../util/get_type":122,"../util/unbundle_jsonlint":126,"./validate":127,"./validate_array":128,"./validate_number":139,"./validate_object":140}],135:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("./validate_string");b.exports=function(a){var b=a.value,c=a.key,f=e(a)
;return f.length?f:(-1===b.indexOf("{fontstack}")&&f.push(new d(c,b,'"glyphs" url must include a "{fontstack}" token')),-1===b.indexOf("{range}")&&f.push(new d(c,b,'"glyphs" url must include a "{range}" token')),f)}},{"../error/validation_error":114,"./validate_string":144}],136:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/unbundle_jsonlint"),f=a("./validate_object"),g=a("./validate_filter"),h=a("./validate_paint_property"),i=a("./validate_layout_property"),j=a("../util/extend");b.exports=function(a){var b=[],c=a.value,k=a.key,l=a.style,m=a.styleSpec;c.type||c.ref||b.push(new d(k,c,'either "type" or "ref" is required'));var n=e(c.type),o=e(c.ref);if(c.id)for(var p=e(c.id),q=0;q<a.arrayIndex;q++){var r=l.layers[q];e(r.id)===p&&b.push(new d(k,c.id,'duplicate layer id "%s", previously used at line %d',c.id,r.id.__line__))}if("ref"in c){["type","source","source-layer","filter","layout"].forEach(function(a){a in c&&b.push(new d(k,c[a],'"%s" is prohibited for ref layers',a))});var s;l.layers.forEach(function(a){e(a.id)===o&&(s=a)}),s?s.ref?b.push(new d(k,c.ref,"ref cannot reference another ref layer")):n=e(s.type):b.push(new d(k,c.ref,'ref layer "%s" not found',o))}else if("background"!==n)if(c.source){var t=l.sources&&l.sources[c.source],u=t&&e(t.type);t?"vector"===u&&"raster"===n?b.push(new d(k,c.source,'layer "%s" requires a raster source',c.id)):"raster"===u&&"raster"!==n?b.push(new d(k,c.source,'layer "%s" requires a vector source',c.id)):"vector"!==u||c["source-layer"]||b.push(new d(k,c,'layer "%s" must specify a "source-layer"',c.id)):b.push(new d(k,c.source,'source "%s" not found',c.source))}else b.push(new d(k,c,'missing required property "source"'));return b=b.concat(f({key:k,value:c,valueSpec:m.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},filter:g,layout:function(a){return f({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return i(j({layerType:n},a))}}})},paint:function(a){return f({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return h(j({layerType:n},a))}}})}}}))}},{"../error/validation_error":114,"../util/extend":121,"../util/unbundle_jsonlint":126,"./validate_filter":133,"./validate_layout_property":137,"./validate_object":140,"./validate_paint_property":141}],137:[function(a,b,c){"use strict";var d=a("./validate_property");b.exports=function(a){return d(a,"layout")}},{"./validate_property":142}],138:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type"),f=a("./validate");b.exports=function(a){var b=a.value,c=a.styleSpec,g=c.light,h=a.style,i=[],j=e(b);if(void 0===b)return i;if("object"!==j)return i=i.concat([new d("light",b,"object expected, %s found",j)]);for(var k in b){var l=k.match(/^(.*)-transition$/);i=l&&g[l[1]]&&g[l[1]].transition?i.concat(f({key:k,value:b[k],valueSpec:c.transition,style:h,styleSpec:c})):g[k]?i.concat(f({key:k,value:b[k],valueSpec:g[k],style:h,styleSpec:c})):i.concat([new d(k,b[k],'unknown property "%s"',k)])}return i}},{"../error/validation_error":114,"../util/get_type":122,"./validate":127}],139:[function(a,b,c){"use strict";var d=a("../util/get_type"),e=a("../error/validation_error");b.exports=function(a){var b=a.key,c=a.value,f=a.valueSpec,g=d(c);return"number"!==g?[new e(b,c,"number expected, %s found",g)]:"minimum"in f&&c<f.minimum?[new e(b,c,"%s is less than the minimum value %s",c,f.minimum)]:"maximum"in f&&c>f.maximum?[new e(b,c,"%s is greater than the maximum value %s",c,f.maximum)]:[]}},{"../error/validation_error":114,"../util/get_type":122}],140:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/get_type"),f=a("./validate");b.exports=function(a){var b=a.key,c=a.value,g=a.valueSpec||{},h=a.objectElementValidators||{},i=a.style,j=a.styleSpec,k=[],l=e(c);if("object"!==l)return[new d(b,c,"object expected, %s found",l)];for(var m in c){var n=m.split(".")[0],o=g[n]||g["*"],p=void 0;if(h[n])p=h[n];else if(g[n])p=f;else if(h["*"])p=h["*"];else{if(!g["*"]){k.push(new d(b,c[m],'unknown property "%s"',m));continue}p=f}k=k.concat(p({key:(b?b+".":b)+m,value:c[m],valueSpec:o,style:i,styleSpec:j,object:c,objectKey:m}))}for(var q in g)g[q].required&&void 0===g[q].default&&void 0===c[q]&&k.push(new d(b,c,'missing required property "%s"',q));return k}},{"../error/validation_error":114,"../util/get_type":122,"./validate":127}],141:[function(a,b,c){"use strict";var d=a("./validate_property");b.exports=function(a){return d(a,"paint")}},{"./validate_property":142}],142:[function(a,b,c){"use strict";var d=a("./validate"),e=a("../error/validation_error"),f=a("../util/get_type");b.exports=function(a,b){var c=a.key,g=a.style,h=a.styleSpec,i=a.value,j=a.objectKey,k=h[b+"_"+a.layerType];if(!k)return[];var l=j.match(/^(.*)-transition$/);if("paint"===b&&l&&k[l[1]]&&k[l[1]].transition)return d({key:c,value:i,valueSpec:h.transition,style:g,styleSpec:h});var m=a.valueSpec||k[j];if(!m)return[new e(c,i,'unknown property "%s"',j)];var n;if("string"===f(i)&&m["property-function"]&&!m.tokens&&(n=/^{([^}]+)}$/.exec(i)))return[new e(c,i,'"%s" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": %s` }`.',j,JSON.stringify(n[1]))];var o=[];return"symbol"===a.layerType&&"text-field"===j&&g&&!g.glyphs&&o.push(new e(c,i,'use of "text-field" requires a style "glyphs" property')),o.concat(d({key:a.key,value:i,valueSpec:m,style:g,styleSpec:h}))}},{"../error/validation_error":114,"../util/get_type":122,"./validate":127}],143:[function(a,b,c){"use strict";var d=a("../error/validation_error"),e=a("../util/unbundle_jsonlint"),f=a("./validate_object"),g=a("./validate_enum");b.exports=function(a){var b=a.value,c=a.key,h=a.styleSpec,i=a.style;if(!b.type)return[new d(c,b,'"type" is required')];var j=e(b.type),k=[];switch(j){case"vector":case"raster":if(k=k.concat(f({key:c,value:b,valueSpec:h.source_tile,style:a.style,styleSpec:h})),"url"in b)for(var l in b)["type","url","tileSize"].indexOf(l)<0&&k.push(new d(c+"."+l,b[l],'a source with a "url" property may not include a "%s" property',l));return k;case"geojson":return f({key:c,value:b,valueSpec:h.source_geojson,style:i,styleSpec:h});case"video":return f({key:c,value:b,valueSpec:h.source_video,style:i,styleSpec:h});case"image":return f({key:c,value:b,valueSpec:h.source_image,style:i,styleSpec:h});case"canvas":return f({key:c,value:b,valueSpec:h.source_canvas,style:i,styleSpec:h});default:return g({key:c+".type",value:b.type,valueSpec:{values:["vector","raster","geojson","video","image","canvas"]},style:i,styleSpec:h})}}},{"../error/validation_error":114,"../util/unbundle_jsonlint":126,"./validate_enum":132,"./validate_object":140}],144:[function(a,b,c){"use strict";var d=a("../util/get_type"),e=a("../error/validation_error");b.exports=function(a){var b=a.value,c=a.key,f=d(b);return"string"!==f?[new e(c,b,"string expected, %s found",f)]:[]}},{"../error/validation_error":114,"../util/get_type":122}],145:[function(a,b,c){"use strict";function d(a,b){b=b||i;var c=[];return c=c.concat(h({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:j,"*":function(){return[]}}})),b.$version>7&&a.constants&&(c=c.concat(g({key:"constants",value:a.constants,style:a,styleSpec:b}))),e(c)}function e(a){return[].concat(a).sort(function(a,b){return a.line-b.line})}function f(a){return function(){return e(a.apply(this,arguments))}}var g=a("./validate/validate_constants"),h=a("./validate/validate"),i=a("./reference/latest"),j=a("./validate/validate_glyphs_url");d.source=f(a("./validate/validate_source")),d.light=f(a("./validate/validate_light")),d.layer=f(a("./validate/validate_layer")),d.filter=f(a("./validate/validate_filter")),d.paintProperty=f(a("./validate/validate_paint_property")),d.layoutProperty=f(a("./validate/validate_layout_property")),b.exports=d},{"./reference/latest":119,"./validate/validate":127,"./validate/validate_constants":131,"./validate/validate_filter":133,"./validate/validate_glyphs_url":135,"./validate/validate_layer":136,"./validate/validate_layout_property":137,"./validate/validate_light":138,"./validate/validate_paint_property":141,"./validate/validate_source":143}],146:[function(a,b,c){"use strict";var d=function(){this.n=0,this.times=[]};d.prototype.stopped=function(){return this.times=this.times.filter(function(a){return a.time>=(new Date).getTime()}),!this.times.length},d.prototype.set=function(a){return this.times.push({id:this.n,time:a+(new Date).getTime()}),this.n++},d.prototype.cancel=function(a){this.times=this.times.filter(function(b){return b.id!==a})},b.exports=d},{}],147:[function(a,b,c){"use strict";var d=a("../util/evented"),e=a("../util/ajax"),f=a("../util/browser"),g=a("../util/mapbox").normalizeSpriteURL,h=function(){this.x=0,this.y=0,this.width=0,this.height=0,this.pixelRatio=1,this.sdf=!1},i=function(a){function b(b,c){var d=this;a.call(this),this.base=b,this.retina=f.devicePixelRatio>1,this.setEventedParent(c);var h=this.retina?"@2x":"";e.getJSON(g(b,h,".json"),function(a,b){a?d.fire("error",{error:a}):b&&(d.data=b,d.imgData&&d.fire("data",{dataType:"style"}))}),e.getImage(g(b,h,".png"),function(a,b){a?d.fire("error",{error:a}):b&&(d.imgData=f.getImageData(b),d.width=b.width,d.data&&d.fire("data",{dataType:"style"}))})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.toJSON=function(){return this.base},b.prototype.loaded=function(){return!(!this.data||!this.imgData)},b.prototype.resize=function(){var a=this;if(f.devicePixelRatio>1!==this.retina){var c=new b(this.base);c.on("data",function(){a.data=c.data,a.imgData=c.imgData,a.width=c.width,a.retina=c.retina})}},b.prototype.getSpritePosition=function(a){if(!this.loaded())return new h;var b=this.data&&this.data[a];return b&&this.imgData?b:new h},b}(d);b.exports=i},{"../util/ajax":196,"../util/browser":197,"../util/evented":205,"../util/mapbox":212}],148:[function(a,b,c){"use strict";var d=a("../style-spec/reference/latest"),e=a("../util/util"),f=a("../util/evented"),g=a("./validate_style"),h=a("./style_declaration"),i=a("./style_transition"),j="-transition",k=function(a){function b(b){a.call(this),this.properties=["anchor","color","position","intensity"],this._specifications=d.light,this.set(b)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){var b=this;if(!this._validate(g.light,a)){this._declarations={},this._transitions={},this._transitionOptions={},this.calculated={},a=e.extend({anchor:this._specifications.anchor.default,color:this._specifications.color.default,position:this._specifications.position.default,intensity:this._specifications.intensity.default},a);for(var c=0,d=b.properties;c<d.length;c+=1){var f=d[c];b._declarations[f]=new h(b._specifications[f],a[f])}return this}},b.prototype.getLight=function(){return{anchor:this.getLightProperty("anchor"),color:this.getLightProperty("color"),position:this.getLightProperty("position"),intensity:this.getLightProperty("intensity")}},b.prototype.getLightProperty=function(a){return e.endsWith(a,j)?this._transitionOptions[a]:this._declarations[a]&&this._declarations[a].value},b.prototype.getLightValue=function(a,b){if("position"===a){var c=this._transitions[a].calculate(b),d=e.sphericalToCartesian(c);return{x:d[0],y:d[1],z:d[2]}}return this._transitions[a].calculate(b)},b.prototype.setLight=function(a){var b=this;if(!this._validate(g.light,a))for(var c in a){var d=a[c];e.endsWith(c,j)?b._transitionOptions[c]=d:null===d||void 0===d?delete b._declarations[c]:b._declarations[c]=new h(b._specifications[c],d)}},b.prototype.recalculate=function(a){var b=this;for(var c in b._declarations)b.calculated[c]=b.getLightValue(c,{zoom:a})},b.prototype._applyLightDeclaration=function(a,b,c,d,f){var g=c.transition?this._transitions[a]:void 0,k=this._specifications[a];if(null!==b&&void 0!==b||(b=new h(k,k.default)),!g||g.declaration.json!==b.json){var l=e.extend({duration:300,delay:0},d,this.getLightProperty(a+j)),m=this._transitions[a]=new i(k,b,g,l);m.instant()||(m.loopID=f.set(m.endTime-Date.now())),g&&f.cancel(g.loopID)}},b.prototype.updateLightTransitions=function(a,b,c){var d,e=this;for(d in e._declarations)e._applyLightDeclaration(d,e._declarations[d],a,b,c)},b.prototype._validate=function(a,b){return g.emitErrors(this,a.call(g,e.extend({value:b,style:{glyphs:!0,sprite:!0},styleSpec:d})))},b}(f);b.exports=k},{"../style-spec/reference/latest":119,"../util/evented":205,"../util/util":218,"./style_declaration":150,"./style_transition":158,"./validate_style":159}],149:[function(a,b,c){"use strict";var d=a("../util/evented"),e=a("./style_layer"),f=a("./image_sprite"),g=a("./light"),h=a("../symbol/glyph_source"),i=a("../symbol/sprite_atlas"),j=a("../render/line_atlas"),k=a("../util/util"),l=a("../util/ajax"),m=a("../util/mapbox"),n=a("../util/browser"),o=a("../util/dispatcher"),p=a("./animation_loop"),q=a("./validate_style"),r=a("../source/source"),s=a("../source/query_features"),t=a("../source/source_cache"),u=a("../style-spec/reference/latest"),v=a("../style-spec/function"),w=a("../util/global_worker_pool"),x=a("../style-spec/deref"),y=a("../style-spec/diff"),z=a("../source/rtl_text_plugin"),A=k.pick(y.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition"]),B=k.pick(y.operations,["setCenter","setZoom","setBearing","setPitch"]),C=function(a){function b(b,c,d){var e=this;a.call(this),this.map=c,this.animationLoop=c&&c.animationLoop||new p,this.dispatcher=new o(w(),this),this.spriteAtlas=new i(1024,1024),this.spriteAtlas.setEventedParent(this),this.lineAtlas=new j(256,512),this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory={},this._loaded=!1,k.bindAll(["_redoPlacement"],this),this._resetUpdates(),d=k.extend({validate:"string"!=typeof b||!m.isMapboxURL(b)},d),this.setEventedParent(c),this.fire("dataloading",{dataType:"style"});var g=this;this._rtlTextPluginCallback=z.registerForPluginAvailability(function(a){g.dispatcher.broadcast("loadRTLTextPlugin",a.pluginBlobURL,a.errorCallback);for(var b in g.sourceCaches)g.sourceCaches[b].reload()});var r=function(a,b){if(a)return void e.fire("error",{error:a});if(!d.validate||!q.emitErrors(e,q(b))){e._loaded=!0,e.stylesheet=b,e.updateClasses();for(var c in b.sources)e.addSource(c,b.sources[c],d);b.sprite&&(e.sprite=new f(b.sprite,e)),e.glyphSource=new h(b.glyphs,d.localIdeographFontFamily,e),e._resolve(),e.fire("data",{dataType:"style"}),e.fire("style.load")}};"string"==typeof b?l.getJSON(m.normalizeStyleURL(b),r):n.frame(r.bind(this,null,b)),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var b=!!e.sourceCaches[a.sourceId]&&e.sourceCaches[a.sourceId].getSource();if(b&&b.vectorLayerIds)for(var c in e._layers){var d=e._layers[c];d.source===b.id&&e._validateLayer(d)}}})}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._validateLayer=function(a){var b=this.sourceCaches[a.source];if(a.sourceLayer&&b){var c=b.getSource();("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(a.sourceLayer))&&this.fire("error",{error:new Error('Source layer "'+a.sourceLayer+'" does not exist on source "'+c.id+'" as specified by style layer "'+a.id+'"')})}},b.prototype.loaded=function(){var a=this;if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var b in a.sourceCaches)if(!a.sourceCaches[b].loaded())return!1;return!(this.sprite&&!this.sprite.loaded())},b.prototype._resolve=function(){var a=this,b=x(this.stylesheet.layers);this._order=b.map(function(a){return a.id}),this._layers={};for(var c=0,d=b;c<d.length;c+=1){var f=d[c];f=e.create(f),f.setEventedParent(a,{layer:{id:f.id}}),a._layers[f.id]=f}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new g(this.stylesheet.light)},b.prototype._serializeLayers=function(a){var b=this;return a.map(function(a){return b._layers[a].serialize()})},b.prototype._applyClasses=function(a,b){var c=this;if(this._loaded){a=a||[],b=b||{transition:!0};var d=this.stylesheet.transition||{},e=this._updatedAllPaintProps?this._layers:this._updatedPaintProps;for(var f in e){var g=c._layers[f],h=c._updatedPaintProps[f];if(c._updatedAllPaintProps||h.all)g.updatePaintTransitions(a,b,d,c.animationLoop,c.zoomHistory);else for(var i in h)c._layers[f].updatePaintTransition(i,a,b,d,c.animationLoop,c.zoomHistory)}this.light.updateLightTransitions(b,d,this.animationLoop)}},b.prototype._recalculate=function(a){var b=this;if(this._loaded){for(var c in b.sourceCaches)b.sourceCaches[c].used=!1;this._updateZoomHistory(a);for(var d=0,e=b._order;d<e.length;d+=1){var f=e[d],g=b._layers[f];g.recalculate(a),!g.isHidden(a)&&g.source&&(b.sourceCaches[g.source].used=!0)}this.light.recalculate(a),Math.floor(this.z)!==Math.floor(a)&&this.animationLoop.set(300),this.z=a}},b.prototype._updateZoomHistory=function(a){var b=this.zoomHistory;void 0===b.lastIntegerZoom&&(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=0,b.lastZoom=a),Math.floor(b.lastZoom)<Math.floor(a)?(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=Date.now()):Math.floor(b.lastZoom)>Math.floor(a)&&(b.lastIntegerZoom=Math.floor(a+1),b.lastIntegerZoomTime=Date.now()),b.lastZoom=a},b.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},b.prototype.update=function(a,b){var c=this;if(this._changed){var d=Object.keys(this._updatedLayers),e=Object.keys(this._removedLayers);(d.length||e.length||this._updatedSymbolOrder)&&this._updateWorkerLayers(d,e);for(var f in c._updatedSources){var g=c._updatedSources[f];"reload"===g?c._reloadSource(f):"clear"===g&&c._clearSource(f)}this._applyClasses(a,b),this._resetUpdates(),this.fire("data",{dataType:"style"})}},b.prototype._updateWorkerLayers=function(a,b){var c=this,d=this._updatedSymbolOrder?this._order.filter(function(a){return"symbol"===c._layers[a].type}):null;this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b,symbolOrder:d})},b.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSymbolOrder=!1,this._updatedSources={},this._updatedPaintProps={},this._updatedAllPaintProps=!1},b.prototype.setState=function(a){var b=this;if(this._checkLoaded(),q.emitErrors(this,q(a)))return!1;a=k.extend({},a),a.layers=x(a.layers);var c=y(this.serialize(),a).filter(function(a){return!(a.command in B)});if(0===c.length)return!1;var d=c.filter(function(a){return!(a.command in A)});if(d.length>0)throw new Error("Unimplemented: "+d.map(function(a){return a.command}).join(", ")+".");return c.forEach(function(a){"setTransition"!==a.command&&b[a.command].apply(b,a.args)}),this.stylesheet=a,!0},b.prototype.addSource=function(a,b,c){var d=this;if(this._checkLoaded(),void 0!==this.sourceCaches[a])throw new Error("There is already a source with this ID");if(!b.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(b)+".");if(!(["vector","raster","geojson","video","image","canvas"].indexOf(b.type)>=0&&this._validate(q.source,"sources."+a,b,null,c))){var e=this.sourceCaches[a]=new t(a,b,this.dispatcher);e.style=this,e.setEventedParent(this,function(){return{isSourceLoaded:d.loaded(),source:e.serialize(),sourceId:a}}),e.onAdd(this.map),this._changed=!0}},b.prototype.removeSource=function(a){if(this._checkLoaded(),void 0===this.sourceCaches[a])throw new Error("There is no source with this ID");var b=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],b.fire("data",{sourceDataType:"metadata",dataType:"source",sourceId:a}),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},b.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},b.prototype.addLayer=function(a,b,c){this._checkLoaded();var d=a.id;if("object"==typeof a.source&&(this.addSource(d,a.source),a=k.extend(a,{source:d})),!this._validate(q.layer,"layers."+d,a,{arrayIndex:-1},c)){var f=e.create(a);this._validateLayer(f),f.setEventedParent(this,{layer:{id:d}});var g=b?this._order.indexOf(b):this._order.length;if(this._order.splice(g,0,d),this._layers[d]=f,this._removedLayers[d]&&f.source){var h=this._removedLayers[d];delete this._removedLayers[d],h.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),"symbol"===f.type&&(this._updatedSymbolOrder=!0),this.updateClasses(d)}},b.prototype.moveLayer=function(a,b){this._checkLoaded(),this._changed=!0;var c=this._layers[a];if(!c)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot be moved.")});var d=this._order.indexOf(a);this._order.splice(d,1);var e=b?this._order.indexOf(b):this._order.length;this._order.splice(e,0,a),"symbol"===c.type&&(this._updatedSymbolOrder=!0,c.source&&!this._updatedSources[c.source]&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()))},b.prototype.removeLayer=function(a){this._checkLoaded();var b=this._layers[a];if(!b)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot be removed.")});b.setEventedParent(null);var c=this._order.indexOf(a);this._order.splice(c,1),"symbol"===b.type&&(this._updatedSymbolOrder=!0),this._changed=!0,this._removedLayers[a]=b,delete this._layers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a]},b.prototype.getLayer=function(a){return this._layers[a]},b.prototype.setLayerZoomRange=function(a,b,c){this._checkLoaded();var d=this.getLayer(a);if(!d)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot have zoom extent.")});d.minzoom===b&&d.maxzoom===c||(null!=b&&(d.minzoom=b),null!=c&&(d.maxzoom=c),this._updateLayer(d))},b.prototype.setFilter=function(a,b){this._checkLoaded();var c=this.getLayer(a);if(!c)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot be filtered.")});null!==b&&void 0!==b&&this._validate(q.filter,"layers."+c.id+".filter",b)||k.deepEqual(c.filter,b)||(c.filter=k.clone(b),this._updateLayer(c))},b.prototype.getFilter=function(a){return k.clone(this.getLayer(a).filter)},b.prototype.setLayoutProperty=function(a,b,c){this._checkLoaded();var d=this.getLayer(a);if(!d)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")});k.deepEqual(d.getLayoutProperty(b),c)||(d.setLayoutProperty(b,c),this._updateLayer(d))},b.prototype.getLayoutProperty=function(a,b){return this.getLayer(a).getLayoutProperty(b)},b.prototype.setPaintProperty=function(a,b,c,d){this._checkLoaded();var e=this.getLayer(a);if(!e)return void this.fire("error",{error:new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")});if(!k.deepEqual(e.getPaintProperty(b,d),c)){var f=e.isPaintValueFeatureConstant(b);e.setPaintProperty(b,c,d),!(c&&v.isFunctionDefinition(c)&&"$zoom"!==c.property&&void 0!==c.property)&&f||this._updateLayer(e),this.updateClasses(a,b)}},b.prototype.getPaintProperty=function(a,b,c){return this.getLayer(a).getPaintProperty(b,c)},b.prototype.getTransition=function(){return k.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},b.prototype.updateClasses=function(a,b){if(this._changed=!0,a){var c=this._updatedPaintProps;c[a]||(c[a]={}),c[a][b||"all"]=!0}else this._updatedAllPaintProps=!0},b.prototype.serialize=function(){var a=this;return k.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:k.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._order.map(function(b){return a._layers[b].serialize()})},function(a){return void 0!==a})},b.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},b.prototype._flattenRenderedFeatures=function(a){for(var b=this,c=[],d=this._order.length-1;d>=0;d--)for(var e=b._order[d],f=0,g=a;f<g.length;f+=1){var h=g[f],i=h[e];if(i)for(var j=0,k=i;j<k.length;j+=1){var l=k[j];c.push(l)}}return c},b.prototype.queryRenderedFeatures=function(a,b,c,d){var e=this;b&&b.filter&&this._validate(q.filter,"queryRenderedFeatures.filter",b.filter);var f={};if(b&&b.layers){if(!Array.isArray(b.layers))return this.fire("error",{error:"parameters.layers must be an Array."}),[];for(var g=0,h=b.layers;g<h.length;g+=1){var i=h[g],j=e._layers[i];if(!j)return e.fire("error",{error:"The layer '"+i+"' does not exist in the map's style and cannot be queried for features."}),[];f[j.source]=!0}}var k=[];for(var l in e.sourceCaches)if(!b.layers||f[l]){var m=s.rendered(e.sourceCaches[l],e._layers,a,b,c,d);k.push(m)}return this._flattenRenderedFeatures(k)},b.prototype.querySourceFeatures=function(a,b){b&&b.filter&&this._validate(q.filter,"querySourceFeatures.filter",b.filter);var c=this.sourceCaches[a];return c?s.source(c,b):[]},b.prototype.addSourceType=function(a,b,c){return r.getType(a)?c(new Error('A source type called "'+a+'" already exists.')):(r.setType(a,b),b.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:b.workerSourceURL},c):c(null,null))},b.prototype.getLight=function(){return this.light.getLight()},b.prototype.setLight=function(a,b){this._checkLoaded();var c=this.light.getLight(),d=!1;for(var e in a)if(!k.deepEqual(a[e],c[e])){d=!0;break}if(d){var f=this.stylesheet.transition||{};this.light.setLight(a),this.light.updateLightTransitions(b||{transition:!0},f,this.animationLoop)}},b.prototype._validate=function(a,b,c,d,e){return(!e||!1!==e.validate)&&q.emitErrors(this,a.call(q,k.extend({key:b,style:this.serialize(),value:c,styleSpec:u},d)))},b.prototype._remove=function(){var a=this;z.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var b in a.sourceCaches)a.sourceCaches[b].clearTiles();this.dispatcher.remove()},b.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},b.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},b.prototype._updateSources=function(a){var b=this;for(var c in b.sourceCaches)b.sourceCaches[c].update(a)},b.prototype._redoPlacement=function(){var a=this;for(var b in a.sourceCaches)a.sourceCaches[b].redoPlacement()},b.prototype.getIcons=function(a,b,c){var d=this,e=function(){d.spriteAtlas.setSprite(d.sprite),d.spriteAtlas.addIcons(b.icons,c)};!this.sprite||this.sprite.loaded()?e():this.sprite.on("data",e)},b.prototype.getGlyphs=function(a,b,c){function d(a,b,d){a&&console.error(a),h[d]=b,0==--g&&c(null,h)}var e=this,f=b.stacks,g=Object.keys(f).length,h={};for(var i in f)e.glyphSource.getSimpleGlyphs(i,f[i],b.uid,d)},b}(d);b.exports=C},{"../render/line_atlas":86,"../source/query_features":99,"../source/rtl_text_plugin":101,"../source/source":102,"../source/source_cache":103,"../style-spec/deref":112,"../style-spec/diff":113,"../style-spec/function":117,"../style-spec/reference/latest":119,"../symbol/glyph_source":168,"../symbol/sprite_atlas":173,"../util/ajax":196,"../util/browser":197,"../util/dispatcher":203,"../util/evented":205,"../util/global_worker_pool":207,"../util/mapbox":212,"../util/util":218,"./animation_loop":146,"./image_sprite":147,"./light":148,"./style_layer":151,"./validate_style":159}],150:[function(a,b,c){"use strict";var d=a("../style-spec/function"),e=a("../util/util"),f=function(a,b){var c=this;if(this.value=e.clone(b),this.isFunction=d.isFunctionDefinition(b),this.json=JSON.stringify(this.value),this.minimum=a.minimum,this.function=d(this.value,a),this.isFeatureConstant=this.function.isFeatureConstant,this.isZoomConstant=this.function.isZoomConstant,this.isFeatureConstant||this.isZoomConstant){if(!this.isZoomConstant){this.stopZoomLevels=[];for(var f=0,g=c.value.stops;f<g.length;f+=1){var h=g[f];c.stopZoomLevels.indexOf(h[0])<0&&c.stopZoomLevels.push(h[0])}}}else{this.stopZoomLevels=[];for(var i=[],j=0,k=c.value.stops;j<k.length;j+=1){var l=k[j],m=l[0].zoom;c.stopZoomLevels.indexOf(m)<0&&(c.stopZoomLevels.push(m),i.push([m,i.length]))}this._functionInterpolationT=d({type:"exponential",stops:i,base:b.base},{type:"number"})}};f.prototype.calculate=function(a,b){var c=this.function(a&&a.zoom,b||{});return void 0!==this.minimum&&c<this.minimum?this.minimum:c},f.prototype.calculateInterpolationT=function(a){return this.isFeatureConstant||this.isZoomConstant?0:this._functionInterpolationT(a&&a.zoom,{})},b.exports=f},{"../style-spec/function":117,"../util/util":218}],151:[function(a,b,c){"use strict";function d(a){return a.value}var e=a("../util/util"),f=a("./style_transition"),g=a("./style_declaration"),h=a("../style-spec/reference/latest"),i=a("./validate_style"),j=a("./../style-spec/util/parse_color"),k=a("../util/evented"),l="-transition",m=function(a){function b(b){var c=this;a.call(this),this.id=b.id,this.metadata=b.metadata,this.type=b.type,this.minzoom=b.minzoom,this.maxzoom=b.maxzoom,"background"!==b.type&&(this.source=b.source,this.sourceLayer=b["source-layer"],this.filter=b.filter),this.paint={},this.layout={},this._paintSpecifications=h["paint_"+this.type],this._layoutSpecifications=h["layout_"+this.type],this._paintTransitions={},this._paintTransitionOptions={},this._paintDeclarations={},this._layoutDeclarations={},this._layoutFunctions={};var d,e,f={validate:!1};for(var g in b){var i=g.match(/^paint(?:\.(.*))?$/);if(i){var j=i[1]||"";for(d in b[g])c.setPaintProperty(d,b[g][d],j,f)}}for(e in b.layout)c.setLayoutProperty(e,b.layout[e],f);for(d in c._paintSpecifications)c.paint[d]=c.getPaintValue(d);for(e in c._layoutSpecifications)c._updateLayoutValue(e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setLayoutProperty=function(a,b,c){if(null==b)delete this._layoutDeclarations[a];else{var d="layers."+this.id+".layout."+a;if(this._validate(i.layoutProperty,d,a,b,c))return;this._layoutDeclarations[a]=new g(this._layoutSpecifications[a],b)}this._updateLayoutValue(a)},b.prototype.getLayoutProperty=function(a){return this._layoutDeclarations[a]&&this._layoutDeclarations[a].value},b.prototype.getLayoutValue=function(a,b,c){var d=this._layoutSpecifications[a],e=this._layoutDeclarations[a];return e?e.calculate(b,c):d.default},b.prototype.setPaintProperty=function(a,b,c,d){var f="layers."+this.id+(c?'["paint.'+c+'"].':".paint.")+a;if(e.endsWith(a,l))if(this._paintTransitionOptions[c||""]||(this._paintTransitionOptions[c||""]={}),null===b||void 0===b)delete this._paintTransitionOptions[c||""][a];else{if(this._validate(i.paintProperty,f,a,b,d))return;this._paintTransitionOptions[c||""][a]=b}else if(this._paintDeclarations[c||""]||(this._paintDeclarations[c||""]={}),null===b||void 0===b)delete this._paintDeclarations[c||""][a];else{if(this._validate(i.paintProperty,f,a,b,d))return;this._paintDeclarations[c||""][a]=new g(this._paintSpecifications[a],b)}},b.prototype.getPaintProperty=function(a,b){return b=b||"",e.endsWith(a,l)?this._paintTransitionOptions[b]&&this._paintTransitionOptions[b][a]:this._paintDeclarations[b]&&this._paintDeclarations[b][a]&&this._paintDeclarations[b][a].value},b.prototype.getPaintValue=function(a,b,c){
var d=this._paintSpecifications[a],e=this._paintTransitions[a];return e?e.calculate(b,c):"color"===d.type&&d.default?j(d.default):d.default},b.prototype.getPaintValueStopZoomLevels=function(a){var b=this._paintTransitions[a];return b?b.declaration.stopZoomLevels:[]},b.prototype.getLayoutValueStopZoomLevels=function(a){var b=this._layoutDeclarations[a];return b?b.stopZoomLevels:[]},b.prototype.getPaintInterpolationT=function(a,b){return this._paintTransitions[a].declaration.calculateInterpolationT(b)},b.prototype.getLayoutInterpolationT=function(a,b){return this._layoutDeclarations[a].calculateInterpolationT(b)},b.prototype.isPaintValueFeatureConstant=function(a){var b=this._paintTransitions[a];return!b||b.declaration.isFeatureConstant},b.prototype.isLayoutValueFeatureConstant=function(a){var b=this._layoutDeclarations[a];return!b||b.isFeatureConstant},b.prototype.isPaintValueZoomConstant=function(a){var b=this._paintTransitions[a];return!b||b.declaration.isZoomConstant},b.prototype.isLayoutValueZoomConstant=function(a){var b=this._layoutDeclarations[a];return!b||b.isZoomConstant},b.prototype.isHidden=function(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.layout.visibility},b.prototype.updatePaintTransitions=function(a,b,c,d,f){for(var g=this,h=e.extend({},this._paintDeclarations[""]),i=0;i<a.length;i++)e.extend(h,g._paintDeclarations[a[i]]);var j;for(j in h)g._applyPaintDeclaration(j,h[j],b,c,d,f);for(j in g._paintTransitions)j in h||g._applyPaintDeclaration(j,null,b,c,d,f)},b.prototype.updatePaintTransition=function(a,b,c,d,e,f){for(var g=this,h=this._paintDeclarations[""][a],i=0;i<b.length;i++){var j=g._paintDeclarations[b[i]];j&&j[a]&&(h=j[a])}this._applyPaintDeclaration(a,h,c,d,e,f)},b.prototype.recalculate=function(a){var b=this;for(var c in b._paintTransitions)b.paint[c]=b.getPaintValue(c,{zoom:a});for(var d in b._layoutFunctions)b.layout[d]=b.getLayoutValue(d,{zoom:a})},b.prototype.serialize=function(){var a=this,b={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:e.mapObject(this._layoutDeclarations,d)};for(var c in a._paintDeclarations)b[""===c?"paint":"paint."+c]=e.mapObject(a._paintDeclarations[c],d);return e.filterObject(b,function(a,b){return void 0!==a&&!("layout"===b&&!Object.keys(a).length)})},b.prototype._applyPaintDeclaration=function(a,b,c,d,h,i){var j=c.transition?this._paintTransitions[a]:void 0,k=this._paintSpecifications[a];if(null!==b&&void 0!==b||(b=new g(k,k.default)),!j||j.declaration.json!==b.json){var m=e.extend({duration:300,delay:0},d,this.getPaintProperty(a+l)),n=this._paintTransitions[a]=new f(k,b,j,m,i);n.instant()||(n.loopID=h.set(n.endTime-Date.now())),j&&h.cancel(j.loopID)}},b.prototype._updateLayoutValue=function(a){var b=this._layoutDeclarations[a];b&&b.isFunction?this._layoutFunctions[a]=!0:(delete this._layoutFunctions[a],this.layout[a]=this.getLayoutValue(a))},b.prototype._validate=function(a,b,c,d,e){return(!e||!1!==e.validate)&&i.emitErrors(this,a.call(i,{key:b,layerType:this.type,objectKey:c,value:d,styleSpec:h,style:{glyphs:!0,sprite:!0}}))},b}(k);b.exports=m;var n={circle:a("./style_layer/circle_style_layer"),fill:a("./style_layer/fill_style_layer"),"fill-extrusion":a("./style_layer/fill_extrusion_style_layer"),line:a("./style_layer/line_style_layer"),symbol:a("./style_layer/symbol_style_layer"),background:m,raster:m};m.create=function(a){return new n[a.type](a)}},{"../style-spec/reference/latest":119,"../util/evented":205,"../util/util":218,"./../style-spec/util/parse_color":124,"./style_declaration":150,"./style_layer/circle_style_layer":152,"./style_layer/fill_extrusion_style_layer":153,"./style_layer/fill_style_layer":154,"./style_layer/line_style_layer":155,"./style_layer/symbol_style_layer":156,"./style_transition":158,"./validate_style":159}],152:[function(a,b,c){"use strict";var d=a("../style_layer"),e=a("../../data/bucket/circle_bucket"),f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new e(a)},b}(d);b.exports=f},{"../../data/bucket/circle_bucket":56,"../style_layer":151}],153:[function(a,b,c){"use strict";var d=a("../style_layer"),e=a("../../data/bucket/fill_extrusion_bucket"),f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPaintValue=function(b,c,d){var e=a.prototype.getPaintValue.call(this,b,c,d);return"fill-extrusion-color"===b&&e&&(e[3]=1),e},b.prototype.createBucket=function(a){return new e(a)},b}(d);b.exports=f},{"../../data/bucket/fill_extrusion_bucket":58,"../style_layer":151}],154:[function(a,b,c){"use strict";var d=a("../style_layer"),e=a("../../data/bucket/fill_bucket"),f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPaintValue=function(b,c,d){var e=this;if("fill-outline-color"===b){if(void 0===this.getPaintProperty("fill-outline-color"))return a.prototype.getPaintValue.call(this,"fill-color",c,d);for(var f=this._paintTransitions["fill-outline-color"];f;){if(!(f&&f.declaration&&f.declaration.value))return a.prototype.getPaintValue.call(e,"fill-color",c,d);f=f.oldTransition}}return a.prototype.getPaintValue.call(this,b,c,d)},b.prototype.getPaintValueStopZoomLevels=function(b){return"fill-outline-color"===b&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):a.prototype.getPaintValueStopZoomLevels.call(this,b)},b.prototype.getPaintInterpolationT=function(b,c){return"fill-outline-color"===b&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintInterpolationT.call(this,"fill-color",c):a.prototype.getPaintInterpolationT.call(this,b,c)},b.prototype.isPaintValueFeatureConstant=function(b){return"fill-outline-color"===b&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):a.prototype.isPaintValueFeatureConstant.call(this,b)},b.prototype.isPaintValueZoomConstant=function(b){return"fill-outline-color"===b&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueZoomConstant.call(this,"fill-color"):a.prototype.isPaintValueZoomConstant.call(this,b)},b.prototype.createBucket=function(a){return new e(a)},b}(d);b.exports=f},{"../../data/bucket/fill_bucket":57,"../style_layer":151}],155:[function(a,b,c){"use strict";var d=a("../style_layer"),e=a("../../data/bucket/line_bucket"),f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new e(a)},b}(d);b.exports=f},{"../../data/bucket/line_bucket":59,"../style_layer":151}],156:[function(a,b,c){"use strict";var d=a("../style_layer"),e=a("../../data/bucket/symbol_bucket"),f=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getLayoutValue=function(b,c,d){var e=a.prototype.getLayoutValue.call(this,b,c,d);if("auto"!==e)return e;switch(b){case"text-rotation-alignment":case"icon-rotation-alignment":return"line"===this.getLayoutValue("symbol-placement",c,d)?"map":"viewport";case"text-pitch-alignment":return this.getLayoutValue("text-rotation-alignment",c,d);case"icon-pitch-alignment":return this.getLayoutValue("icon-rotation-alignment",c,d);default:return e}},b.prototype.createBucket=function(a){return new e(a)},b}(d);b.exports=f},{"../../data/bucket/symbol_bucket":60,"../style_layer":151}],157:[function(a,b,c){"use strict";var d=a("./style_layer"),e=a("../util/util"),f=a("../style-spec/feature_filter"),g=a("../style-spec/group_by_layout"),h=function(a){a&&this.replace(a)};h.prototype.replace=function(a){var b=this;this.symbolOrder=[];for(var c=0,d=a;c<d.length;c+=1){var e=d[c];"symbol"===e.type&&b.symbolOrder.push(e.id)}this._layerConfigs={},this._layers={},this.update(a,[])},h.prototype.update=function(a,b,c){for(var h=this,i=0,j=a;i<j.length;i+=1){var k=j[i];h._layerConfigs[k.id]=k;var l=h._layers[k.id]=d.create(k);l.updatePaintTransitions({},{transition:!1}),l.filter=f(l.filter)}for(var m=0,n=b;m<n.length;m+=1){var o=n[m];delete h._layerConfigs[o],delete h._layers[o]}c&&(this.symbolOrder=c),this.familiesBySource={};for(var p=g(e.values(this._layerConfigs)),q=0,r=p;q<r.length;q+=1){var s=r[q],t=s.map(function(a){return h._layers[a.id]}),u=t[0];if(!u.layout||"none"!==u.layout.visibility){var v=u.source||"",w=h.familiesBySource[v];w||(w=h.familiesBySource[v]={});var x=u.sourceLayer||"_geojsonTileLayer",y=w[x];y||(y=w[x]=[]),y.push(t)}}},b.exports=h},{"../style-spec/feature_filter":115,"../style-spec/group_by_layout":118,"../util/util":218,"./style_layer":151}],158:[function(a,b,c){"use strict";function d(a,b,c){if(void 0!==a&&void 0!==b)return{from:a.to,fromScale:a.toScale,to:b.to,toScale:b.toScale,t:c}}var e=a("../util/util"),f=a("../style-spec/util/interpolate"),g={lastIntegerZoom:0,lastIntegerZoomTime:0,lastZoom:0},h=function(a,b,c,e,h){this.declaration=b,this.startTime=this.endTime=(new Date).getTime(),this.oldTransition=c,this.duration=e.duration||0,this.delay=e.delay||0,this.zoomTransitioned="piecewise-constant"===a.function&&a.transition,this.interp=this.zoomTransitioned?d:f[a.type],this.zoomHistory=h||g,this.instant()||(this.endTime=this.startTime+this.duration+this.delay),c&&c.endTime<=this.startTime&&delete c.oldTransition};h.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay},h.prototype.calculate=function(a,b,c){var d=this._calculateTargetValue(a,b);if(this.instant())return d;if((c=c||Date.now())>=this.endTime)return d;var f=this.oldTransition.calculate(a,b,this.startTime),g=e.easeCubicInOut((c-this.startTime-this.delay)/this.duration);return this.interp(f,d,g)},h.prototype._calculateTargetValue=function(a,b){if(!this.zoomTransitioned)return this.declaration.calculate(a,b);var c=a.zoom,d=this.zoomHistory.lastIntegerZoom,e=c>d?2:.5,g=this.declaration.calculate({zoom:c>d?c-1:c+1},b),h=this.declaration.calculate({zoom:c},b),i=Math.min((Date.now()-this.zoomHistory.lastIntegerZoomTime)/this.duration,1),j=Math.abs(c-d),k=f(i,1,j);return void 0!==g&&void 0!==h?{from:g,fromScale:e,to:h,toScale:1,t:k}:void 0},b.exports=h},{"../style-spec/util/interpolate":123,"../util/util":218}],159:[function(a,b,c){"use strict";b.exports=a("../style-spec/validate_style.min"),b.exports.emitErrors=function(a,b){if(b&&b.length){for(var c=0;c<b.length;c++)a.fire("error",{error:new Error(b[c].message)});return!0}return!1}},{"../style-spec/validate_style.min":145}],160:[function(a,b,c){"use strict";var d=a("point-geometry"),e=function(a){function b(b,c,d,e){a.call(this,b,c),this.angle=d,void 0!==e&&(this.segment=e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.x,this.y,this.angle,this.segment)},b}(d);b.exports=e},{"point-geometry":36}],161:[function(a,b,c){"use strict";function d(a,b,c,d,e){if(void 0===b.segment)return!0;for(var f=b,g=b.segment+1,h=0;h>-c/2;){if(--g<0)return!1;h-=a[g].dist(f),f=a[g]}h+=a[g].dist(a[g+1]),g++;for(var i=[],j=0;h<c/2;){var k=a[g-1],l=a[g],m=a[g+1];if(!m)return!1;var n=k.angleTo(l)-l.angleTo(m);for(n=Math.abs((n+3*Math.PI)%(2*Math.PI)-Math.PI),i.push({distance:h,angleDelta:n}),j+=n;h-i[0].distance>d;)j-=i.shift().angleDelta;if(j>e)return!1;g++,h+=l.dist(m)}return!0}b.exports=d},{}],162:[function(a,b,c){"use strict";function d(a,b,c,d,f){for(var g=[],h=0;h<a.length;h++)for(var i=a[h],j=void 0,k=0;k<i.length-1;k++){var l=i[k],m=i[k+1];l.x<b&&m.x<b||(l.x<b?l=new e(b,l.y+(m.y-l.y)*((b-l.x)/(m.x-l.x)))._round():m.x<b&&(m=new e(b,l.y+(m.y-l.y)*((b-l.x)/(m.x-l.x)))._round()),l.y<c&&m.y<c||(l.y<c?l=new e(l.x+(m.x-l.x)*((c-l.y)/(m.y-l.y)),c)._round():m.y<c&&(m=new e(l.x+(m.x-l.x)*((c-l.y)/(m.y-l.y)),c)._round()),l.x>=d&&m.x>=d||(l.x>=d?l=new e(d,l.y+(m.y-l.y)*((d-l.x)/(m.x-l.x)))._round():m.x>=d&&(m=new e(d,l.y+(m.y-l.y)*((d-l.x)/(m.x-l.x)))._round()),l.y>=f&&m.y>=f||(l.y>=f?l=new e(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f)._round():m.y>=f&&(m=new e(l.x+(m.x-l.x)*((f-l.y)/(m.y-l.y)),f)._round()),j&&l.equals(j[j.length-1])||(j=[l],g.push(j)),j.push(m)))))}return g}var e=a("point-geometry");b.exports=d},{"point-geometry":36}],163:[function(a,b,c){"use strict";var d=a("../util/struct_array"),e=a("point-geometry"),f=d({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"offsetX"},{type:"Int16",name:"offsetY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"unadjustedMaxScale"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});Object.defineProperty(f.prototype.StructType.prototype,"anchorPoint",{get:function(){return new e(this.anchorPointX,this.anchorPointY)}}),b.exports=f},{"../util/struct_array":215,"point-geometry":36}],164:[function(a,b,c){"use strict";var d=function(a,b,c,d,e,f,g,h,i,j,k){var l=g.top*h-i,m=g.bottom*h+i,n=g.left*h-i,o=g.right*h+i;if(this.boxStartIndex=a.length,j){var p=m-l,q=o-n;if(p>0)if(p=Math.max(10*h,p),k){var r=b[c.segment+1].sub(b[c.segment])._unit()._mult(q),s=[c.sub(r),c.add(r)];this._addLineCollisionBoxes(a,s,c,0,q,p,d,e,f)}else this._addLineCollisionBoxes(a,b,c,c.segment,q,p,d,e,f)}else a.emplaceBack(c.x,c.y,0,0,n,l,o,m,1/0,1/0,d,e,f,0,0,0,0,0);this.boxEndIndex=a.length};d.prototype._addLineCollisionBoxes=function(a,b,c,d,e,f,g,h,i){var j=f/2,k=Math.floor(e/j),l=Math.floor(k/2),m=-f/2,n=c,o=d+1,p=m,q=-e/2,r=q-e/8;do{if(--o<0){if(p>q)return;o=0;break}p-=b[o].dist(n),n=b[o]}while(p>r);for(var s=b[o].dist(b[o+1]),t=-l;t<k+l;t++){var u=t*j,v=q+u;if(u<0&&(v+=u),u>e&&(v+=u-e),!(v<p)){for(;p+s<v;){if(p+=s,++o+1>=b.length)return;s=b[o].dist(b[o+1])}var w=v-p,x=b[o],y=b[o+1],z=y.sub(x)._unit()._mult(w)._add(x)._round(),A=Math.max(Math.abs(v-m)-j/2,0),B=e/2/A;(t<0||t>=k)&&(B=Math.min(B,.99)),a.emplaceBack(z.x,z.y,z.x-c.x,z.y-c.y,-f/2,-f/2,f/2,f/2,B,B,g,h,i,0,0,0,0,0)}}},b.exports=d},{}],165:[function(a,b,c){"use strict";var d=a("point-geometry"),e=a("../data/extent"),f=a("grid-index"),g=a("../util/intersection_tests"),h=function(a,b,c,d,g,h,i){void 0===h&&(h=new f(e,12,6)),void 0===i&&(i=new f(e,12,0)),this.angle=a,this.pitch=b,this.cameraToCenterDistance=c,this.cameraToTileDistance=d,this.grid=h,this.ignoredGrid=i,this.perspectiveRatio=1+.5*(d/c-1),this.minScale=.5/this.perspectiveRatio,this.maxScale=2/this.perspectiveRatio;var j=Math.sin(this.angle),k=Math.cos(this.angle);this.rotationMatrix=[k,-j,j,k],this.reverseRotationMatrix=[k,j,-j,k],this.yStretch=Math.max(1,d/(c*Math.cos(b/180*Math.PI))),this.collisionBoxArray=g,0===g.length&&(g.emplaceBack(),g.emplaceBack(0,0,0,0,0,-32767,0,32767,1/0,1/0,0,0,0,0,0,0,0,0,0),g.emplaceBack(e,0,0,0,0,-32767,0,32767,1/0,1/0,0,0,0,0,0,0,0,0,0),g.emplaceBack(0,0,0,0,-32767,0,32767,0,1/0,1/0,0,0,0,0,0,0,0,0,0),g.emplaceBack(0,e,0,0,-32767,0,32767,0,1/0,1/0,0,0,0,0,0,0,0,0,0)),this.tempCollisionBox=g.get(0),this.edges=[g.get(1),g.get(2),g.get(3),g.get(4)]};h.deserialize=function(a,b){return new h(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,b,new f(a.grid),new f(a.ignoredGrid))},h.prototype.serialize=function(a){var b=this.grid.toArrayBuffer(),c=this.ignoredGrid.toArrayBuffer();return a&&(a.push(b),a.push(c)),{angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,grid:b,ignoredGrid:c}},h.prototype.placeCollisionFeature=function(a,b,c){for(var e=this,f=this.collisionBoxArray,g=this.minScale,h=this.rotationMatrix,i=this.yStretch,j=a.boxStartIndex;j<a.boxEndIndex;j++){var k=f.get(j),l=k.anchorPoint._matMult(h),m=l.x,n=l.y,o=m+k.x1*e.perspectiveRatio,p=n+k.y1*i*e.perspectiveRatio,q=m+k.x2*e.perspectiveRatio,r=n+k.y2*i*e.perspectiveRatio;k.bbox0=o,k.bbox1=p,k.bbox2=q,k.bbox3=r;var s=new d(k.offsetX,k.offsetY)._matMult(h),t=s.x*s.x,u=s.y*s.y,v=u*i*i,w=Math.sqrt((t+v)/(t+u))||1;if(k.maxScale=k.unadjustedMaxScale*w,!b)for(var x=e.grid.query(o,p,q,r),y=0;y<x.length;y++){var z=f.get(x[y]),A=z.anchorPoint._matMult(h);if((g=e.getPlacementScale(g,l,k,A,z))>=e.maxScale)return g}if(c){var B=void 0;if(e.angle){var C=e.reverseRotationMatrix,D=new d(k.x1,k.y1).matMult(C),E=new d(k.x2,k.y1).matMult(C),F=new d(k.x1,k.y2).matMult(C),G=new d(k.x2,k.y2).matMult(C);B=e.tempCollisionBox,B.anchorPointX=k.anchorPoint.x,B.anchorPointY=k.anchorPoint.y,B.x1=Math.min(D.x,E.x,F.x,G.x),B.y1=Math.min(D.y,E.x,F.x,G.x),B.x2=Math.max(D.x,E.x,F.x,G.x),B.y2=Math.max(D.y,E.x,F.x,G.x),B.maxScale=k.maxScale}else B=k;for(var H=0;H<this.edges.length;H++){var I=e.edges[H];if((g=e.getPlacementScale(g,k.anchorPoint,B,I.anchorPoint,I))>=e.maxScale)return g}}}return g},h.prototype.queryRenderedSymbols=function(a,b){var c={},e=[];if(0===a.length||0===this.grid.keys.length&&0===this.ignoredGrid.keys.length)return e;for(var f=this.collisionBoxArray,h=this.rotationMatrix,i=this.yStretch,j=[],k=1/0,l=1/0,m=-1/0,n=-1/0,o=0;o<a.length;o++)for(var p=a[o],q=0;q<p.length;q++){var r=p[q].matMult(h);k=Math.min(k,r.x),l=Math.min(l,r.y),m=Math.max(m,r.x),n=Math.max(n,r.y),j.push(r)}for(var s=this.grid.query(k,l,m,n),t=this.ignoredGrid.query(k,l,m,n),u=0;u<t.length;u++)s.push(t[u]);for(var v=b/this.perspectiveRatio,w=Math.pow(2,Math.ceil(Math.log(v)/Math.LN2*10)/10),x=0;x<s.length;x++){var y=f.get(s[x]),z=y.sourceLayerIndex,A=y.featureIndex;if(void 0===c[z]&&(c[z]={}),!c[z][A]&&!(w<y.placementScale||w>y.maxScale)){var B=y.anchorPoint.matMult(h),C=B.x+y.x1/v,D=B.y+y.y1/v*i,E=B.x+y.x2/v,F=B.y+y.y2/v*i,G=[new d(C,D),new d(E,D),new d(E,F),new d(C,F)];g.polygonIntersectsPolygon(j,G)&&(c[z][A]=!0,e.push(s[x]))}}return e},h.prototype.getPlacementScale=function(a,b,c,d,e){var f=b.x-d.x,g=b.y-d.y,h=(e.x1-c.x2)/f,i=(e.x2-c.x1)/f,j=(e.y1-c.y2)*this.yStretch/g,k=(e.y2-c.y1)*this.yStretch/g;(isNaN(h)||isNaN(i))&&(h=i=1),(isNaN(j)||isNaN(k))&&(j=k=1);var l=Math.min(Math.max(h,i),Math.max(j,k)),m=e.maxScale,n=c.maxScale;return l>m&&(l=m),l>n&&(l=n),l>a&&l>=e.placementScale&&(a=l),a},h.prototype.insertCollisionFeature=function(a,b,c){for(var d=this,e=c?this.ignoredGrid:this.grid,f=this.collisionBoxArray,g=a.boxStartIndex;g<a.boxEndIndex;g++){var h=f.get(g);h.placementScale=b,b<d.maxScale&&(1===d.perspectiveRatio||h.maxScale>=1)&&e.insert(g,h.bbox0,h.bbox1,h.bbox2,h.bbox3)}},b.exports=h},{"../data/extent":64,"../util/intersection_tests":209,"grid-index":19,"point-geometry":36}],166:[function(a,b,c){"use strict";function d(a,b,c,d,f,g,h,i,j){var k=d?.6*g*h:0,l=Math.max(d?d.right-d.left:0,f?f.right-f.left:0),m=0===a[0].x||a[0].x===j||0===a[0].y||a[0].y===j;b-l*h<b/4&&(b=l*h+b/4);var n=2*g;return e(a,m?b/2*i%b:(l/2+n)*h*i%b,b,k,c,l*h,m,!1,j)}function e(a,b,c,d,i,j,k,l,m){for(var n=j/2,o=0,p=0;p<a.length-1;p++)o+=a[p].dist(a[p+1]);for(var q=0,r=b-c,s=[],t=0;t<a.length-1;t++){for(var u=a[t],v=a[t+1],w=u.dist(v),x=v.angleTo(u);r+c<q+w;){r+=c;var y=(r-q)/w,z=f(u.x,v.x,y),A=f(u.y,v.y,y);if(z>=0&&z<m&&A>=0&&A<m&&r-n>=0&&r+n<=o){var B=new g(z,A,x,t)._round();d&&!h(a,B,j,d,i)||s.push(B)}}q+=w}return l||s.length||k||(s=e(a,q/2,c,d,i,j,k,!0,m)),s}var f=a("../style-spec/util/interpolate"),g=a("../symbol/anchor"),h=a("./check_max_angle");b.exports=d},{"../style-spec/util/interpolate":123,"../symbol/anchor":160,"./check_max_angle":161}],167:[function(a,b,c){"use strict";var d=a("@mapbox/shelf-pack"),e=a("../util/util"),f=4,g=128,h=2048,i=function(){this.width=g,this.height=g,this.atlas=new d(this.width,this.height),this.index={},this.ids={},this.data=new Uint8Array(this.width*this.height)};i.prototype.getGlyphs=function(){var a,b,c,d=this,e={};for(var f in d.ids)a=f.split("#"),b=a[0],c=a[1],e[b]||(e[b]=[]),e[b].push(c);return e},i.prototype.getRects=function(){var a,b,c,d=this,e={};for(var f in d.ids)a=f.split("#"),b=a[0],c=a[1],e[b]||(e[b]={}),e[b][c]=d.index[f];return e},i.prototype.addGlyph=function(a,b,c,d){var f=this;if(!c)return null;var g=b+"#"+c.id;if(this.index[g])return this.ids[g].indexOf(a)<0&&this.ids[g].push(a),this.index[g];if(!c.bitmap)return null;var h=c.width+2*d,i=c.height+2*d,j=h+2,k=i+2,l=this.atlas.packOne(j,k);if(l||(this.resize(),l=this.atlas.packOne(j,k)),!l)return e.warnOnce("glyph bitmap overflow"),null;this.index[g]=l,this.ids[g]=[a];for(var m=this.data,n=c.bitmap,o=0;o<i;o++)for(var p=f.width*(l.y+o+1)+l.x+1,q=h*o,r=0;r<h;r++)m[p+r]=n[q+r];return this.dirty=!0,l},i.prototype.resize=function(){var a=this,b=this.width,c=this.height;if(!(b>=h||c>=h)){this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null),this.width*=f,this.height*=f,this.atlas.resize(this.width,this.height);for(var d=new ArrayBuffer(this.width*this.height),e=0;e<c;e++){var g=new Uint8Array(a.data.buffer,c*e,b);new Uint8Array(d,c*e*f,b).set(g)}this.data=new Uint8Array(d)}},i.prototype.bind=function(a){this.gl=a,this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,null))},i.prototype.updateTexture=function(a){this.bind(a),this.dirty&&(a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data),this.dirty=!1)},b.exports=i},{"../util/util":218,"@mapbox/shelf-pack":2}],168:[function(a,b,c){"use strict";function d(a,b,c,d){return d=d||"abc",c.replace("{s}",d[a.length%d.length]).replace("{fontstack}",a).replace("{range}",b)}var e=a("../util/mapbox").normalizeGlyphsURL,f=a("../util/ajax"),g=a("../util/glyphs"),h=a("../symbol/glyph_atlas"),i=a("pbf"),j=a("@mapbox/tiny-sdf"),k=a("../util/is_char_in_unicode_block"),l=a("../util/evented"),m=function(a,b,c){this.advance=a.advance,this.left=a.left-c-1,this.top=a.top+c+1,this.rect=b},n=function(a){function b(b,c,d){a.call(this),this.url=b&&e(b),this.atlases={},this.stacks={},this.loading={},this.localIdeographFontFamily=c,this.tinySDFs={},this.setEventedParent(d)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getSimpleGlyphs=function(a,b,c,d){var e=this;void 0===this.stacks[a]&&(this.stacks[a]={ranges:{},cjkGlyphs:{}}),void 0===this.atlases[a]&&(this.atlases[a]=new h);for(var f={},g=this.stacks[a],i=this.atlases[a],j={},l=0,n=0;n<b.length;n++)!function(b){var d=Math.floor(b/256);if(e.localIdeographFontFamily&&(k["CJK Unified Ideographs"](b)||k["Hangul Syllables"](b))){g.cjkGlyphs[b]||(g.cjkGlyphs[b]=e.loadCJKGlyph(a,b));var h=g.cjkGlyphs[b],n=i.addGlyph(c,a,h,3);h&&(f[b]=new m(h,n,3))}else if(g.ranges[d]){var o=g.ranges[d].glyphs[b],p=i.addGlyph(c,a,o,3);o&&(f[b]=new m(o,p,3))}else void 0===j[d]&&(j[d]=[],l++),j[d].push(b)}(b[n]);l||d(void 0,f,a);var o=function(b,g,h){if(b)return void e.fire("error",{error:b});for(var k=e.stacks[a].ranges[g]=h.stacks[0],n=0;n<j[g].length;n++){var o=j[g][n],p=k.glyphs[o],q=i.addGlyph(c,a,p,3);p&&(f[o]=new m(p,q,3))}--l||d(void 0,f,a)};for(var p in j)e.loadRange(a,p,o)},b.prototype.createTinySDF=function(a,b){return new j(24,3,8,.25,a,b)},b.prototype.loadCJKGlyph=function(a,b){var c=this.tinySDFs[a];if(!c){var d="400";/bold/i.test(a)?d="900":/medium/i.test(a)?d="500":/light/i.test(a)&&(d="200"),c=this.tinySDFs[a]=this.createTinySDF(this.localIdeographFontFamily,d)}return{id:b,bitmap:c.draw(String.fromCharCode(b)),width:24,height:24,left:0,top:-8,advance:24}},b.prototype.loadPBF=function(a,b){f.getArrayBuffer(a,b)},b.prototype.loadRange=function(a,b,c){if(256*b>65535)return c("glyphs > 65535 not supported");void 0===this.loading[a]&&(this.loading[a]={});var e=this.loading[a];if(e[b])e[b].push(c);else{e[b]=[c];var f=256*b+"-"+(256*b+255),h=d(a,f,this.url);this.loadPBF(h,function(a,c){for(var d=!a&&new g(new i(c.data)),f=0;f<e[b].length;f++)e[b][f](a,b,d);delete e[b]})}},b.prototype.getGlyphAtlas=function(a){return this.atlases[a]},b}(l);b.exports=n},{"../symbol/glyph_atlas":167,"../util/ajax":196,"../util/evented":205,"../util/glyphs":208,"../util/is_char_in_unicode_block":210,"../util/mapbox":212,"@mapbox/tiny-sdf":3,pbf:35}],169:[function(a,b,c){"use strict";b.exports=function(a){function b(b){h.push(a[b]),i++}function c(a,b,c){var d=g[a];return delete g[a],g[b]=d,h[d].geometry[0].pop(),h[d].geometry[0]=h[d].geometry[0].concat(c[0]),d}function d(a,b,c){var d=f[b];return delete f[b],f[a]=d,h[d].geometry[0].shift(),h[d].geometry[0]=c[0].concat(h[d].geometry[0]),d}function e(a,b,c){var d=c?b[0][b[0].length-1]:b[0][0];return a+":"+d.x+":"+d.y}for(var f={},g={},h=[],i=0,j=0;j<a.length;j++){var k=a[j],l=k.geometry,m=k.text;if(m){var n=e(m,l),o=e(m,l,!0);if(n in g&&o in f&&g[n]!==f[o]){var p=d(n,o,l),q=c(n,o,h[p].geometry);delete f[n],delete g[o],g[e(m,h[q].geometry,!0)]=q,h[p].geometry=null}else n in g?c(n,o,l):o in f?d(n,o,l):(b(j),f[n]=i-1,g[o]=i-1)}else b(j)}return h.filter(function(a){return a.geometry})}},{}],170:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=m.identity(new Float32Array(16));return b?(m.identity(f),m.scale(f,f,[1/e,1/e,1]),c||m.rotateZ(f,f,d.angle)):(m.scale(f,f,[d.width/2,-d.height/2,1]),m.translate(f,f,[1,-1,0]),m.multiply(f,f,a)),f}function e(a,b,c,d,e){var f=m.identity(new Float32Array(16));return b?(m.multiply(f,f,a),m.scale(f,f,[e,e,1]),c||m.rotateZ(f,f,-d.angle)):(m.scale(f,f,[1,-1,1]),m.translate(f,f,[-1,-1,0]),m.scale(f,f,[2/d.width,2/d.height,1])),f}function f(a,b){var c=[a.x,a.y,0,1];return n.transformMat4(c,c,b),new l(c[0]/c[3],c[1]/c[3])}function g(a,b,c,d){var e=a[0]/a[3],f=a[1]/a[3];return e>=-c[0]&&e<=c[0]&&f>=-c[1]&&f<=c[1]&&d.frameHistory.isVisible(b)}function h(a,b,c,d,e,h,j,m,p,q){var r=d?a.textSizeData:a.iconSizeData,s=o.evaluateSizeForZoom(r,c.transform,q,d),t=[256/c.width*2+1,256/c.height*2+1],u=d?a.buffers.glyph.dynamicLayoutVertexArray:a.buffers.icon.dynamicLayoutVertexArray;u.clear();for(var v=a.lineVertexArray,w=d?a.placedGlyphArray:a.placedIconArray,x=0;x<w.length;x++){var y=w.get(x),z=[y.anchorX,y.anchorY,0,1];if(n.transformMat4(z,z,b),g(z,y.placementZoom,t,c)){var A=z[3],B=1+.5*(A/c.transform.cameraToCenterDistance-1),C=o.evaluateSizeForFeature(r,s,y),D=j?C*B:C/B,E=f(new l(y.anchorX,y.anchorY),e),F={},G=i(y,D,!1,m,b,e,h,a.glyphOffsetArray,v,u,E,F);(G.notEnoughRoom||G.needsFlipping&&i(y,D,!0,m,b,e,h,a.glyphOffsetArray,v,u,E,F).notEnoughRoom)&&k(y.numGlyphs,u)}else k(y.numGlyphs,u)}d?a.buffers.glyph.dynamicLayoutVertexBuffer.updateData(u.serialize()):a.buffers.icon.dynamicLayoutVertexBuffer.updateData(u.serialize())}function i(a,b,c,d,e,g,h,i,k,l,m,n){var o,q=b/24,r=a.lineOffsetX*b,s=a.lineOffsetY*b;if(a.numGlyphs>1){var t=a.glyphStartIndex+a.numGlyphs,u=i.get(a.glyphStartIndex).offsetX,v=i.get(t-1).offsetX,w=a.lineStartIndex,x=a.lineStartIndex+a.lineLength,y=j(q*u,r,s,c,m,a.segment,w,x,k,g,n);if(!y)return{notEnoughRoom:!0};var z=j(q*v,r,s,c,m,a.segment,w,x,k,g,n);if(!z)return{notEnoughRoom:!0};var A=f(y.point,h),B=f(z.point,h);if(d&&!c&&(a.vertical?A.y<B.y:A.x>B.x))return{needsFlipping:!0};o=[y];for(var C=a.glyphStartIndex+1;C<t-1;C++){var D=i.get(C);o.push(j(q*D.offsetX,r,s,c,m,a.segment,w,x,k,g,n))}o.push(z)}else{if(d&&!c){var E=f(k.get(a.lineStartIndex+a.segment),e),F=f(k.get(a.lineStartIndex+a.segment+1),e);if(a.vertical?F.y>E.y:F.x<E.x)return{needsFlipping:!0}}var G=i.get(a.glyphStartIndex),H=j(q*G.offsetX,r,s,c,m,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,k,g,n);if(!H)return{notEnoughRoom:!0};o=[H]}for(var I=a.placementZoom,J=0,K=o;J<K.length;J+=1){var L=K[J];p(l,L.point,L.angle,I)}return{}}function j(a,b,c,d,e,g,h,i,j,k,l){var m=d?a-b:a+b,n=m>0?1:-1,o=0;d&&(n*=-1,o=Math.PI),n<0&&(o+=Math.PI);for(var p=n>0?h+g:h+g+1,q=e,r=e,s=0,t=0,u=Math.abs(m);s+t<=u;){if((p+=n)<h||p>=i)return null;r=q,q=l[p],void 0===q&&(q=l[p]=f(j.get(p),k)),s+=t,t=r.dist(q)}var v=(u-s)/t,w=q.sub(r),x=w.mult(v)._add(r);return x._add(w._unit()._perp()._mult(c*n)),{point:x,angle:o+Math.atan2(q.y-r.y,q.x-r.x)}}function k(a,b){for(var c=0;c<a;c++)p(b,q,0,25)}var l=a("point-geometry"),m=a("@mapbox/gl-matrix").mat4,n=a("@mapbox/gl-matrix").vec4,o=a("./symbol_size"),p=a("../data/bucket/symbol_bucket").addDynamicAttributes;b.exports={updateLineLabels:h,getLabelPlaneMatrix:d,getGlCoordMatrix:e};var q=new l(-1/0,-1/0)},{"../data/bucket/symbol_bucket":60,"./symbol_size":174,"@mapbox/gl-matrix":1,"point-geometry":36}],171:[function(a,b,c){"use strict";function d(a,b,c,d,e,f,g){this.tl=a,this.tr=b,this.bl=c,this.br=d,this.tex=e,this.writingMode=f,this.glyphOffset=g}function e(a,b,c,e,f,h,i){var j,k,l,m,n=b.image,o=c.layout,p=b.top-1/n.pixelRatio,q=b.left-1/n.pixelRatio,r=b.bottom+1/n.pixelRatio,s=b.right+1/n.pixelRatio;if("none"!==o["icon-text-fit"]&&f){var t=s-q,u=r-p,v=o["text-size"]/24,w=f.left*v,x=f.right*v,y=f.top*v,z=f.bottom*v,A=x-w,B=z-y,C=o["icon-text-fit-padding"][0],D=o["icon-text-fit-padding"][1],E=o["icon-text-fit-padding"][2],F=o["icon-text-fit-padding"][3],G="width"===o["icon-text-fit"]?.5*(B-u):0,H="height"===o["icon-text-fit"]?.5*(A-t):0,I="width"===o["icon-text-fit"]||"both"===o["icon-text-fit"]?A:t,J="height"===o["icon-text-fit"]||"both"===o["icon-text-fit"]?B:u;j=new g(w+H-F,y+G-C),k=new g(w+H+D+I,y+G-C),l=new g(w+H+D+I,y+G+E+J),m=new g(w+H-F,y+G+E+J)}else j=new g(q,p),k=new g(s,p),l=new g(s,r),m=new g(q,r);var K=c.getLayoutValue("icon-rotate",h,i)*Math.PI/180;if(K){var L=Math.sin(K),M=Math.cos(K),N=[M,-L,L,M];j._matMult(N),k._matMult(N),m._matMult(N),l._matMult(N)}return[new d(j,k,m,l,{x:n.textureRect.x-1,y:n.textureRect.y-1,w:n.textureRect.w+2,h:n.textureRect.h+2},void 0,[0,0])]}function f(a,b,c,e,f,h){for(var i=c.getLayoutValue("text-rotate",f,h)*Math.PI/180,j=c.getLayoutValue("text-offset",f,h).map(function(a){return 24*a}),k=b.positionedGlyphs,l=[],m=0;m<k.length;m++){var n=k[m],o=n.glyph;if(o){var p=o.rect;if(p){var q=o.advance/2,r=e?[n.x+q,n.y]:[0,0],s=e?[0,0]:[n.x+q+j[0],n.y+j[1]],t=o.left-q+s[0],u=-o.top+s[1],v=t+p.w,w=u+p.h,x=new g(t,u),y=new g(v,u),z=new g(t,w),A=new g(v,w),B=new g(s[0]-q,o.advance/2);if(0!==n.angle&&(x._sub(B)._rotate(n.angle)._add(B),y._sub(B)._rotate(n.angle)._add(B),z._sub(B)._rotate(n.angle)._add(B),A._sub(B)._rotate(n.angle)._add(B)),i){var C=Math.sin(i),D=Math.cos(i),E=[D,-C,C,D];x._matMult(E),y._matMult(E),z._matMult(E),A._matMult(E)}l.push(new d(x,y,z,A,p,b.writingMode,r))}}}return l}var g=a("point-geometry");b.exports={getIconQuads:e,getGlyphQuads:f,SymbolQuad:d}},{"point-geometry":36}],172:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.codePoint=a,this.x=b,this.y=c,this.glyph=d||null,this.angle=e}function e(a,b,c,d,e,f,g){this.positionedGlyphs=a,this.text=b,this.top=c,this.bottom=d,this.left=e,this.right=f,this.writingMode=g}function f(a,b){for(var c=[],d=0,e=0,f=b;e<f.length;e+=1){var g=f[e];c.push(a.substring(d,g)),d=g}return d<a.length&&c.push(a.substring(d,a.length)),c}function g(a,b,c,d,g,h,i,j,k,l){var n=a.trim();l===w.vertical&&(n=u(n));var p,q=[],r=new e(q,n,j[1],j[1],j[0],j[0],l);return p=v.processBidirectionalText?v.processBidirectionalText(n,m(n,i,c,b)):f(n,m(n,i,c,b)),o(r,b,p,d,g,h,j,l,i,k),!!q.length&&r}function h(a,b,c,d){var e=0;for(var f in a){var g=d[a.charCodeAt(f)];g&&(e+=g.advance+b)}return e/Math.max(1,Math.ceil(e/c))}function i(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function j(a,b){var c=0
;return 10===a&&(c-=1e4),40!==a&&65288!==a||(c+=50),41!==b&&65289!==b||(c+=50),c}function k(a,b,c,d,e,f){for(var g=null,h=i(b,c,e,f),j=0,k=d;j<k.length;j+=1){var l=k[j],m=b-l.x,n=i(m,c,e,f)+l.badness;n<=h&&(g=l,h=n)}return{index:a,x:b,priorBreak:g,badness:h}}function l(a){return a?l(a.priorBreak).concat(a.index):[]}function m(a,b,c,d){if(!c)return[];if(!a)return[];for(var e=[],f=h(a,b,c,d),g=0,i=0;i<a.length;i++){var m=a.charCodeAt(i),n=d[m];n&&!x[m]&&(g+=n.advance+b),i<a.length-1&&(y[m]||t.charAllowsIdeographicBreaking(m))&&e.push(k(i+1,g,f,e,j(m,a.charCodeAt(i+1)),!1))}return l(k(a.length,g,f,e,0,!0))}function n(a){var b=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":b=1;break;case"left":case"top-left":case"bottom-left":b=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:b,verticalAlign:c}}function o(a,b,c,e,f,g,h,i,j,k){var l=0,m=-17,o=0,r=a.positionedGlyphs,s="right"===g?1:"left"===g?0:.5;for(var u in c){var v=c[u].trim();if(v.length){for(var x=r.length,y=0;y<v.length;y++){var z=v.charCodeAt(y),A=b[z];A&&(t.charHasUprightVerticalOrientation(z)&&i!==w.horizontal?(r.push(new d(z,l,0,A,-Math.PI/2)),l+=k+j):(r.push(new d(z,l,m,A,0)),l+=A.advance+j))}if(r.length!==x){var B=l-j;o=Math.max(B,o),p(r,b,x,r.length-1,s)}l=0,m+=e}else m+=e}var C=n(f);q(r,s,C.horizontalAlign,C.verticalAlign,o,e,c.length);var D=c.length*e;a.top+=-C.verticalAlign*D,a.bottom=a.top+D,a.left+=-C.horizontalAlign*o,a.right=a.left+o}function p(a,b,c,d,e){if(e)for(var f=b[a[d].codePoint].advance,g=(a[d].x+f)*e,h=c;h<=d;h++)a[h].x-=g}function q(a,b,c,d,e,f,g){for(var h=(b-c)*e,i=(-d*g+.5)*f,j=0;j<a.length;j++)a[j].x+=h,a[j].y+=i}function r(a,b){var c=b[0],d=b[1],e=c-a.displaySize[0]/2,f=e+a.displaySize[0],g=d-a.displaySize[1]/2;return new s(a,g,g+a.displaySize[1],e,f)}function s(a,b,c,d,e){this.image=a,this.top=b,this.bottom=c,this.left=d,this.right=e}var t=a("../util/script_detection"),u=a("../util/verticalize_punctuation"),v=a("../source/rtl_text_plugin"),w={horizontal:1,vertical:2};b.exports={shapeText:g,shapeIcon:r,WritingMode:w};var x={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},y={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0}},{"../source/rtl_text_plugin":101,"../util/script_detection":213,"../util/verticalize_punctuation":220}],173:[function(a,b,c){"use strict";function d(a){var b={x:a.rect.x+k,y:a.rect.y+k,w:a.rect.w-2*k,h:a.rect.h-2*k};return{sdf:a.sdf,pixelRatio:a.pixelRatio,isNativePixelRatio:a.pixelRatio===g.devicePixelRatio,textureRect:b,tl:[b.x,b.y],br:[b.x+b.w,b.y+b.h],displaySize:[b.w/a.pixelRatio,b.h/a.pixelRatio]}}function e(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=d*b+c,o=h*f+g;if(k)for(o-=f,m=-1;m<=j;m++,o+=f)for(n=((m+j)%j+d)*b+c,l=-1;l<=i;l++)e[o+l]=a[n+(l+i)%i];else for(m=0;m<j;m++,n+=b,o+=f)for(l=0;l<i;l++)e[o+l]=a[n+l]}var f=a("@mapbox/shelf-pack"),g=a("../util/browser"),h=a("../util/util"),i=a("../util/window"),j=a("../util/evented"),k=1,l=function(a){function b(b,c){a.call(this),this.images={},this.data=!1,this.texture=0,this.filter=0,this.width=Math.ceil(b*g.devicePixelRatio),this.height=Math.ceil(c*g.devicePixelRatio),this.shelfPack=new f(this.width,this.height),this.dirty=!0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getPixelSize=function(){return[this.width,this.height]},b.prototype.allocateImage=function(a,b){var c=a+2*k,d=b+2*k;return this.shelfPack.packOne(c,d)||(h.warnOnce("SpriteAtlas out of space."),null)},b.prototype.addImage=function(a,b,c){var d,e,f;if(b instanceof i.HTMLImageElement?(d=b.width,e=b.height,b=g.getImageData(b),f=1):(d=c.width,e=c.height,f=c.pixelRatio||1),ArrayBuffer.isView(b)&&(b=new Uint32Array(b.buffer)),!(b instanceof Uint32Array))return this.fire("error",{error:new Error("Image provided in an invalid format. Supported formats are HTMLImageElement and ArrayBufferView.")});if(this.images[a])return this.fire("error",{error:new Error("An image with this name already exists.")});var h=this.allocateImage(d,e);if(!h)return this.fire("error",{error:new Error("There is not enough space to add this image.")});this.images[a]={rect:h,width:d,height:e,pixelRatio:f,sdf:!1},this.copy(b,d,h,{x:0,y:0,width:d,height:e},!1),this.fire("data",{dataType:"style"})},b.prototype.removeImage=function(a){var b=this.images[a];if(delete this.images[a],!b)return this.fire("error",{error:new Error("No image with this name exists.")});this.shelfPack.unref(b.rect),this.fire("data",{dataType:"style"})},b.prototype.getIcon=function(a){return this._getImage(a,!1)},b.prototype.getPattern=function(a){return this._getImage(a,!0)},b.prototype._getImage=function(a,b){if(this.images[a])return d(this.images[a]);if(!this.sprite)return null;var c=this.sprite.getSpritePosition(a);if(!c.width||!c.height)return null;var e=this.allocateImage(c.width,c.height);if(!e)return null;var f={rect:e,width:c.width,height:c.height,sdf:c.sdf,pixelRatio:c.pixelRatio};if(this.images[a]=f,!this.sprite.imgData)return null;var g=new Uint32Array(this.sprite.imgData.buffer);return this.copy(g,this.sprite.width,e,c,b),d(f)},b.prototype.allocate=function(){var a=this;if(!this.data){this.data=new Uint32Array(this.width*this.height);for(var b=0;b<this.data.length;b++)a.data[b]=0}},b.prototype.copy=function(a,b,c,d,f){this.allocate();var g=this.data;e(a,b,d.x,d.y,g,this.getPixelSize()[0],c.x+k,c.y+k,d.width,d.height,f),this.dirty=!0},b.prototype.setSprite=function(a){a&&this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height),this.sprite=a},b.prototype.addIcons=function(a,b){for(var c=this,d={},e=0,f=a;e<f.length;e+=1){var g=f[e];d[g]=c.getIcon(g)}b(null,d)},b.prototype.bind=function(a,b){var c=!1;this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c=!0);var d=b?a.LINEAR:a.NEAREST;d!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d),this.filter=d),this.dirty&&(this.allocate(),c?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),this.dirty=!1)},b}(j);b.exports=l},{"../util/browser":197,"../util/evented":205,"../util/util":218,"../util/window":199,"@mapbox/shelf-pack":2}],174:[function(a,b,c){"use strict";function d(a,b,c){var d=b;return a.isFeatureConstant?d.uSize:a.isZoomConstant?c.lowerSize/10:f.number(c.lowerSize/10,c.upperSize/10,d.uSizeT)}function e(a,b,c,d){var e={};if(a.isZoomConstant||a.isFeatureConstant)if(a.isFeatureConstant&&!a.isZoomConstant){var f;if("interval"===a.functionType)f=c.getLayoutValue(d?"text-size":"icon-size",{zoom:b.zoom});else{var i="interval"===a.functionType?0:h(b.zoom,a.functionBase,a.coveringZoomRange[0],a.coveringZoomRange[1]),j=a.coveringStopValues[0],k=a.coveringStopValues[1];f=j+(k-j)*g.clamp(i,0,1)}e.uSize=f}else a.isFeatureConstant&&a.isZoomConstant&&(e.uSize=a.layoutSize);else{var l=h(b.zoom,a.functionBase,a.coveringZoomRange[0],a.coveringZoomRange[1]);e.uSizeT=g.clamp(l,0,1)}return e}var f=a("../style-spec/util/interpolate"),g=a("../util/util"),h=a("../style-spec/function").interpolationFactor;b.exports={evaluateSizeForFeature:d,evaluateSizeForZoom:e}},{"../style-spec/function":117,"../style-spec/util/interpolate":123,"../util/util":218}],175:[function(a,b,c){"use strict";var d=a("../source/rtl_text_plugin");b.exports=function(a,b,c,e){var f=b.getLayoutValue("text-transform",c,e);return"uppercase"===f?a=a.toLocaleUpperCase():"lowercase"===f&&(a=a.toLocaleLowerCase()),d.applyArabicShaping&&(a=d.applyArabicShaping(a)),a}},{"../source/rtl_text_plugin":101}],176:[function(a,b,c){"use strict";var d=a("../util/dom"),e=a("point-geometry"),f={scrollZoom:a("./handler/scroll_zoom"),boxZoom:a("./handler/box_zoom"),dragRotate:a("./handler/drag_rotate"),dragPan:a("./handler/drag_pan"),keyboard:a("./handler/keyboard"),doubleClickZoom:a("./handler/dblclick_zoom"),touchZoomRotate:a("./handler/touch_zoom_rotate")};b.exports=function(a,b){function c(a){r("mouseout",a)}function g(b){a.stop(),w=d.mousePos(t,b),r("mousedown",b),v=!0}function h(b){var c=a.dragRotate&&a.dragRotate.isActive();u&&!c&&r("contextmenu",u),u=null,v=!1,r("mouseup",b)}function i(b){if(!(a.dragPan&&a.dragPan.isActive()||a.dragRotate&&a.dragRotate.isActive())){for(var c=b.toElement||b.target;c&&c!==t;)c=c.parentNode;c===t&&r("mousemove",b)}}function j(b){a.stop(),s("touchstart",b),!b.touches||b.touches.length>1||(x?(clearTimeout(x),x=null,r("dblclick",b)):x=setTimeout(n,300))}function k(a){s("touchmove",a)}function l(a){s("touchend",a)}function m(a){s("touchcancel",a)}function n(){x=null}function o(a){d.mousePos(t,a).equals(w)&&r("click",a)}function p(a){r("dblclick",a),a.preventDefault()}function q(b){var c=a.dragRotate&&a.dragRotate.isActive();v||c?v&&(u=b):r("contextmenu",b),b.preventDefault()}function r(b,c){var e=d.mousePos(t,c);return a.fire(b,{lngLat:a.unproject(e),point:e,originalEvent:c})}function s(b,c){var f=d.touchPos(t,c),g=f.reduce(function(a,b,c,d){return a.add(b.div(d.length))},new e(0,0));return a.fire(b,{lngLat:a.unproject(g),point:g,lngLats:f.map(function(b){return a.unproject(b)},this),points:f,originalEvent:c})}var t=a.getCanvasContainer(),u=null,v=!1,w=null,x=null;for(var y in f)a[y]=new f[y](a,b),b.interactive&&b[y]&&a[y].enable(b[y]);t.addEventListener("mouseout",c,!1),t.addEventListener("mousedown",g,!1),t.addEventListener("mouseup",h,!1),t.addEventListener("mousemove",i,!1),t.addEventListener("touchstart",j,!1),t.addEventListener("touchend",l,!1),t.addEventListener("touchmove",k,!1),t.addEventListener("touchcancel",m,!1),t.addEventListener("click",o,!1),t.addEventListener("dblclick",p,!1),t.addEventListener("contextmenu",q,!1)}},{"../util/dom":204,"./handler/box_zoom":184,"./handler/dblclick_zoom":185,"./handler/drag_pan":186,"./handler/drag_rotate":187,"./handler/keyboard":188,"./handler/scroll_zoom":189,"./handler/touch_zoom_rotate":190,"point-geometry":36}],177:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../style-spec/util/interpolate"),f=a("../util/browser"),g=a("../geo/lng_lat"),h=a("../geo/lng_lat_bounds"),i=a("point-geometry"),j=a("../util/evented"),k=function(a){function b(b,c){a.call(this),this.moving=!1,this.transform=b,this._bearingSnap=c.bearingSnap}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getCenter=function(){return this.transform.center},b.prototype.setCenter=function(a,b){return this.jumpTo({center:a},b)},b.prototype.panBy=function(a,b,c){return a=i.convert(a).mult(-1),this.panTo(this.transform.center,d.extend({offset:a},b),c)},b.prototype.panTo=function(a,b,c){return this.easeTo(d.extend({center:a},b),c)},b.prototype.getZoom=function(){return this.transform.zoom},b.prototype.setZoom=function(a,b){return this.jumpTo({zoom:a},b),this},b.prototype.zoomTo=function(a,b,c){return this.easeTo(d.extend({zoom:a},b),c)},b.prototype.zoomIn=function(a,b){return this.zoomTo(this.getZoom()+1,a,b),this},b.prototype.zoomOut=function(a,b){return this.zoomTo(this.getZoom()-1,a,b),this},b.prototype.getBearing=function(){return this.transform.bearing},b.prototype.setBearing=function(a,b){return this.jumpTo({bearing:a},b),this},b.prototype.rotateTo=function(a,b,c){return this.easeTo(d.extend({bearing:a},b),c)},b.prototype.resetNorth=function(a,b){return this.rotateTo(0,d.extend({duration:1e3},a),b),this},b.prototype.snapToNorth=function(a,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,b):this},b.prototype.getPitch=function(){return this.transform.pitch},b.prototype.setPitch=function(a,b){return this.jumpTo({pitch:a},b),this},b.prototype.fitBounds=function(a,b,c){if(b=d.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},b),"number"==typeof b.padding){var e=b.padding;b.padding={top:e,bottom:e,right:e,left:e}}if(!d.deepEqual(Object.keys(b.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"]))return void d.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'");a=h.convert(a);var f=[b.padding.left-b.padding.right,b.padding.top-b.padding.bottom],g=Math.min(b.padding.right,b.padding.left),j=Math.min(b.padding.top,b.padding.bottom);b.offset=[b.offset[0]+f[0],b.offset[1]+f[1]];var k=i.convert(b.offset),l=this.transform,m=l.project(a.getNorthWest()),n=l.project(a.getSouthEast()),o=n.sub(m),p=(l.width-2*g-2*Math.abs(k.x))/o.x,q=(l.height-2*j-2*Math.abs(k.y))/o.y;return q<0||p<0?void d.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."):(b.center=l.unproject(m.add(n).div(2)),b.zoom=Math.min(l.scaleZoom(l.scale*Math.min(p,q)),b.maxZoom),b.bearing=0,b.linear?this.easeTo(b,c):this.flyTo(b,c))},b.prototype.jumpTo=function(a,b){this.stop();var c=this.transform,d=!1,e=!1,f=!1;return"zoom"in a&&c.zoom!==+a.zoom&&(d=!0,c.zoom=+a.zoom),"center"in a&&(c.center=g.convert(a.center)),"bearing"in a&&c.bearing!==+a.bearing&&(e=!0,c.bearing=+a.bearing),"pitch"in a&&c.pitch!==+a.pitch&&(f=!0,c.pitch=+a.pitch),this.fire("movestart",b).fire("move",b),d&&this.fire("zoomstart",b).fire("zoom",b).fire("zoomend",b),e&&this.fire("rotate",b),f&&this.fire("pitchstart",b).fire("pitch",b).fire("pitchend",b),this.fire("moveend",b)},b.prototype.easeTo=function(a,b){var c=this;this.stop(),a=d.extend({offset:[0,0],duration:500,easing:d.ease},a),!1===a.animate&&(a.duration=0),a.smoothEasing&&0!==a.duration&&(a.easing=this._smoothOutEasing(a.duration));var f=this.transform,h=this.getZoom(),j=this.getBearing(),k=this.getPitch(),l="zoom"in a?+a.zoom:h,m="bearing"in a?this._normalizeBearing(a.bearing,j):j,n="pitch"in a?+a.pitch:k,o=f.centerPoint.add(i.convert(a.offset)),p=f.pointLocation(o),q=g.convert(a.center||p);this._normalizeCenter(q);var r,s,t=f.project(p),u=f.project(q).sub(t),v=f.zoomScale(l-h);return a.around&&(r=g.convert(a.around),s=f.locationPoint(r)),this.zooming=l!==h,this.rotating=j!==m,this.pitching=n!==k,this._prepareEase(b,a.noMoveStart),clearTimeout(this._onEaseEnd),this._ease(function(a){if(this.zooming&&(f.zoom=e(h,l,a)),this.rotating&&(f.bearing=e(j,m,a)),this.pitching&&(f.pitch=e(k,n,a)),r)f.setLocationAtPoint(r,s);else{var c=f.zoomScale(f.zoom-h),d=l>h?Math.min(2,v):Math.max(.5,v),g=Math.pow(d,1-a),i=f.unproject(t.add(u.mult(a*g)).mult(c));f.setLocationAtPoint(f.renderWorldCopies?i.wrap():i,o)}this._fireMoveEvents(b)},function(){a.delayEndEvents?c._onEaseEnd=setTimeout(function(){return c._easeToEnd(b)},a.delayEndEvents):c._easeToEnd(b)},a),this},b.prototype._prepareEase=function(a,b){this.moving=!0,b||this.fire("movestart",a),this.zooming&&this.fire("zoomstart",a),this.pitching&&this.fire("pitchstart",a)},b.prototype._fireMoveEvents=function(a){this.fire("move",a),this.zooming&&this.fire("zoom",a),this.rotating&&this.fire("rotate",a),this.pitching&&this.fire("pitch",a)},b.prototype._easeToEnd=function(a){var b=this.zooming,c=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,b&&this.fire("zoomend",a),c&&this.fire("pitchend",a),this.fire("moveend",a)},b.prototype.flyTo=function(a,b){function c(a){var b=(A*A-z*z+(a?-1:1)*E*E*B*B)/(2*(a?A:z)*E*B);return Math.log(Math.sqrt(b*b+1)-b)}function f(a){return(Math.exp(a)-Math.exp(-a))/2}function h(a){return(Math.exp(a)+Math.exp(-a))/2}function j(a){return f(a)/h(a)}var k=this;this.stop(),a=d.extend({offset:[0,0],speed:1.2,curve:1.42,easing:d.ease},a);var l=this.transform,m=this.getZoom(),n=this.getBearing(),o=this.getPitch(),p="zoom"in a?d.clamp(+a.zoom,l.minZoom,l.maxZoom):m,q="bearing"in a?this._normalizeBearing(a.bearing,n):n,r="pitch"in a?+a.pitch:o,s=l.zoomScale(p-m),t=l.centerPoint.add(i.convert(a.offset)),u=l.pointLocation(t),v=g.convert(a.center||u);this._normalizeCenter(v);var w=l.project(u),x=l.project(v).sub(w),y=a.curve,z=Math.max(l.width,l.height),A=z/s,B=x.mag();if("minZoom"in a){var C=d.clamp(Math.min(a.minZoom,m,p),l.minZoom,l.maxZoom),D=z/l.zoomScale(C-m);y=Math.sqrt(D/B*2)}var E=y*y,F=c(0),G=function(a){return h(F)/h(F+y*a)},H=function(a){return z*((h(F)*j(F+y*a)-f(F))/E)/B},I=(c(1)-F)/y;if(Math.abs(B)<1e-6||isNaN(I)){if(Math.abs(z-A)<1e-6)return this.easeTo(a,b);var J=A<z?-1:1;I=Math.abs(Math.log(A/z))/y,H=function(){return 0},G=function(a){return Math.exp(J*y*a)}}if("duration"in a)a.duration=+a.duration;else{var K="screenSpeed"in a?+a.screenSpeed/y:+a.speed;a.duration=1e3*I/K}return this.zooming=!0,this.rotating=n!==q,this.pitching=r!==o,this._prepareEase(b,!1),this._ease(function(a){var c=a*I,d=1/G(c);l.zoom=m+l.scaleZoom(d),this.rotating&&(l.bearing=e(n,q,a)),this.pitching&&(l.pitch=e(o,r,a));var f=l.unproject(w.add(x.mult(H(c))).mult(d));l.setLocationAtPoint(l.renderWorldCopies?f.wrap():f,t),this._fireMoveEvents(b)},function(){return k._easeToEnd(b)},a),this},b.prototype.isEasing=function(){return!!this._abortFn},b.prototype.isMoving=function(){return this.moving},b.prototype.stop=function(){return this._abortFn&&(this._abortFn(),this._finishEase()),this},b.prototype._ease=function(a,b,c){this._finishFn=b,this._abortFn=f.timed(function(b){a.call(this,c.easing(b)),1===b&&this._finishEase()},!1===c.animate?0:c.duration,this)},b.prototype._finishEase=function(){delete this._abortFn;var a=this._finishFn;delete this._finishFn,a.call(this)},b.prototype._normalizeBearing=function(a,b){a=d.wrap(a,-180,180);var c=Math.abs(a-b);return Math.abs(a-360-b)<c&&(a-=360),Math.abs(a+360-b)<c&&(a+=360),a},b.prototype._normalizeCenter=function(a){var b=this.transform;if(b.renderWorldCopies&&!b.lngRange){var c=a.lng-b.center.lng;a.lng+=c>180?-360:c<-180?360:0}},b.prototype._smoothOutEasing=function(a){var b=d.ease;if(this._prevEase){var c=this._prevEase,e=(Date.now()-c.start)/c.duration,f=c.easing(e+.01)-c.easing(e),g=.27/Math.sqrt(f*f+1e-4)*.01,h=Math.sqrt(.0729-g*g);b=d.bezier(g,h,.25,1)}return this._prevEase={start:(new Date).getTime(),duration:a,easing:b},b},b}(j);b.exports=k},{"../geo/lng_lat":72,"../geo/lng_lat_bounds":73,"../style-spec/util/interpolate":123,"../util/browser":197,"../util/evented":205,"../util/util":218,"point-geometry":36}],178:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/config"),g=function(a){this.options=a,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};g.prototype.getDefaultPosition=function(){return"bottom-right"},g.prototype.onAdd=function(a){var b=this.options&&this.options.compact;return this._map=a,this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===b&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},g.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},g.prototype._updateEditLink=function(){this._editLink||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:f.ACCESS_TOKEN}];if(this._editLink){var b=a.reduce(function(b,c,d){return void 0!==c.value&&(b+=c.key+"="+c.value+(d<a.length-1?"&":"")),b},"?");this._editLink.href="https://www.mapbox.com/feedback/"+b+(this._map._hash?this._map._hash.getHashString(!0):"")}},g.prototype._updateData=function(a){a&&"metadata"===a.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},g.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}var c=this._map.style.sourceCaches;for(var d in c){var e=c[d].getSource();e.attribution&&a.indexOf(e.attribution)<0&&a.push(e.attribution)}a.sort(function(a,b){return a.length-b.length}),a=a.filter(function(b,c){for(var d=c+1;d<a.length;d++)if(a[d].indexOf(b)>=0)return!1;return!0}),this._container.innerHTML=a.join(" | "),this._editLink=null}},g.prototype._updateCompact=function(){var a=this._map.getCanvasContainer().offsetWidth<=640;this._container.classList[a?"add":"remove"]("mapboxgl-compact")},b.exports=g},{"../../util/config":201,"../../util/dom":204,"../../util/util":218}],179:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/window"),g=function(){this._fullscreen=!1,e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in f.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in f.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in f.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};g.prototype.onAdd=function(a){return this._map=a,this._mapContainer=this._map.getContainer(),this._container=d.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._container},g.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map=null,f.document.removeEventListener(this._fullscreenchange,this._changeIcon)},g.prototype._checkFullscreenSupport=function(){return!!(f.document.fullscreenEnabled||f.document.mozFullscreenEnabled||f.document.msFullscreenEnabled||f.document.webkitFullscreenEnabled)},g.prototype._setupUI=function(){var a=this._fullscreenButton=d.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);a.setAttribute("aria-label","Toggle fullscreen"),a.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.document.addEventListener(this._fullscreenchange,this._changeIcon)},g.prototype._isFullscreen=function(){return this._fullscreen},g.prototype._changeIcon=function(){(f.document.fullscreenElement||f.document.mozFullScreenElement||f.document.webkitFullscreenElement||f.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},g.prototype._onClickFullscreen=function(){this._isFullscreen()?f.document.exitFullscreen?f.document.exitFullscreen():f.document.mozCancelFullScreen?f.document.mozCancelFullScreen():f.document.msExitFullscreen?f.document.msExitFullscreen():f.document.webkitCancelFullScreen&&f.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()},b.exports=g},{"../../util/dom":204,"../../util/util":218,"../../util/window":199}],180:[function(a,b,c){"use strict";function d(a){void 0!==e?a(e):void 0!==h.navigator.permissions?h.navigator.permissions.query({name:"geolocation"}).then(function(b){e="denied"!==b.state,a(e)}):(e=!!h.navigator.geolocation,a(e))}var e,f=a("../../util/evented"),g=a("../../util/dom"),h=a("../../util/window"),i=a("../../util/util"),j=a("../../geo/lng_lat"),k=a("../marker"),l={positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},m="mapboxgl-ctrl",n=function(a){function b(b){a.call(this),this.options=i.extend({},l,b),i.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker","_onClickGeolocate"],this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.onAdd=function(a){return this._map=a,this._container=g.create("div",m+" "+m+"-group"),d(this._setupUI),this._container},b.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(h.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),this._container.parentNode.removeChild(this._container),this._map=void 0},b.prototype._onSuccess=function(a){if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(a),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire("geolocate",a),this._finish()},b.prototype._updateCamera=function(a){var b=new j(a.coords.longitude,a.coords.latitude),c=a.coords.accuracy;this._map.fitBounds(b.toBounds(c),this.options.fitBoundsOptions,{geolocateSource:!0})},b.prototype._updateMarker=function(a){a?this._userLocationDotMarker.setLngLat([a.coords.longitude,a.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},b.prototype._onError=function(a){if(this.options.trackUserLocation)if(1===a.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire("error",a),this._finish()},b.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},b.prototype._setupUI=function(a){var b=this;!1!==a&&(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=g.create("button",m+"-icon "+m+"-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed",!1),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=g.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new k(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this._onClickGeolocate.bind(this)),this.options.trackUserLocation&&this._map.on("movestart",function(a){a.geolocateSource||"ACTIVE_LOCK"!==b._watchState||(b._watchState="BACKGROUND",b._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),b._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),b.fire("trackuserlocationend"))}))},b.prototype._onClickGeolocate=function(){if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire("trackuserlocationstart");break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire("trackuserlocationend");break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire("trackuserlocationstart")}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed",!0),this._geolocationWatchID=h.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else h.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4)},b.prototype._clearWatch=function(){h.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed",!1),this.options.showUserLocation&&this._updateMarker(null)},b}(f);b.exports=n},{"../../geo/lng_lat":72,"../../util/dom":204,"../../util/evented":205,"../../util/util":218,"../../util/window":199,"../marker":193}],181:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=function(){e.bindAll(["_updateLogo"],this)};f.prototype.onAdd=function(a){this._map=a,this._container=d.create("div","mapboxgl-ctrl");var b=d.create("a","mapboxgl-ctrl-logo");return b.target="_blank",b.href="https://www.mapbox.com/",b.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(b),this._container.style.display="none",
this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},f.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("sourcedata",this._updateLogo)},f.prototype.getDefaultPosition=function(){return"bottom-left"},f.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},f.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var b in a)if(a[b].getSource().mapbox_logo)return!0;return!1}},b.exports=f},{"../../util/dom":204,"../../util/util":218}],182:[function(a,b,c){"use strict";function d(a){return new f.MouseEvent(a.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:a.detail,view:a.view,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,movementX:a.movementX,movementY:a.movementY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})}var e=a("../../util/dom"),f=a("../../util/window"),g=a("../../util/util"),h="mapboxgl-ctrl",i=function(){g.bindAll(["_rotateCompassArrow"],this)};i.prototype._rotateCompassArrow=function(){var a="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=a},i.prototype.onAdd=function(a){return this._map=a,this._container=e.create("div",h+" "+h+"-group",a.getContainer()),this._container.addEventListener("contextmenu",this._onContextMenu.bind(this)),this._zoomInButton=this._createButton(h+"-icon "+h+"-zoom-in","Zoom In",a.zoomIn.bind(a)),this._zoomOutButton=this._createButton(h+"-icon "+h+"-zoom-out","Zoom Out",a.zoomOut.bind(a)),this._compass=this._createButton(h+"-icon "+h+"-compass","Reset North",a.resetNorth.bind(a)),this._compassArrow=e.create("span",h+"-compass-arrow",this._compass),this._compass.addEventListener("mousedown",this._onCompassDown.bind(this)),this._onCompassMove=this._onCompassMove.bind(this),this._onCompassUp=this._onCompassUp.bind(this),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._container},i.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("rotate",this._rotateCompassArrow),this._map=void 0},i.prototype._onContextMenu=function(a){a.preventDefault()},i.prototype._onCompassDown=function(a){0===a.button&&(e.disableDrag(),f.document.addEventListener("mousemove",this._onCompassMove),f.document.addEventListener("mouseup",this._onCompassUp),this._map.getCanvasContainer().dispatchEvent(d(a)),a.stopPropagation())},i.prototype._onCompassMove=function(a){0===a.button&&(this._map.getCanvasContainer().dispatchEvent(d(a)),a.stopPropagation())},i.prototype._onCompassUp=function(a){0===a.button&&(f.document.removeEventListener("mousemove",this._onCompassMove),f.document.removeEventListener("mouseup",this._onCompassUp),e.enableDrag(),this._map.getCanvasContainer().dispatchEvent(d(a)),a.stopPropagation())},i.prototype._createButton=function(a,b,c){var d=e.create("button",a,this._container);return d.type="button",d.setAttribute("aria-label",b),d.addEventListener("click",function(){c()}),d},b.exports=i},{"../../util/dom":204,"../../util/util":218,"../../util/window":199}],183:[function(a,b,c){"use strict";function d(a,b,c){var d=c&&c.maxWidth||100,g=a._container.clientHeight/2,h=f(a.unproject([0,g]),a.unproject([d,g]));if(c&&"imperial"===c.unit){var i=3.2808*h;i>5280?e(b,d,i/5280,"mi"):e(b,d,i,"ft")}else e(b,d,h,"m")}function e(a,b,c,d){var e=g(c),f=e/c;"m"===d&&e>=1e3&&(e/=1e3,d="km"),a.style.width=b*f+"px",a.innerHTML=e+d}function f(a,b){var c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=Math.sin(d)*Math.sin(e)+Math.cos(d)*Math.cos(e)*Math.cos((b.lng-a.lng)*c);return 6371e3*Math.acos(Math.min(f,1))}function g(a){var b=Math.pow(10,(""+Math.floor(a)).length-1),c=a/b;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,b*c}var h=a("../../util/dom"),i=a("../../util/util"),j=function(a){this.options=a,i.bindAll(["_onMove"],this)};j.prototype.getDefaultPosition=function(){return"bottom-left"},j.prototype._onMove=function(){d(this._map,this._container,this.options)},j.prototype.onAdd=function(a){return this._map=a,this._container=h.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},j.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container),this._map.off("move",this._onMove),this._map=void 0},b.exports=j},{"../../util/dom":204,"../../util/util":218}],184:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../geo/lng_lat_bounds"),f=a("../../util/util"),g=a("../../util/window"),h=function(a){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),f.bindAll(["_onMouseDown","_onMouseMove","_onMouseUp","_onKeyDown"],this)};h.prototype.isEnabled=function(){return!!this._enabled},h.prototype.isActive=function(){return!!this._active},h.prototype.enable=function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)},h.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)},h.prototype._onMouseDown=function(a){a.shiftKey&&0===a.button&&(g.document.addEventListener("mousemove",this._onMouseMove,!1),g.document.addEventListener("keydown",this._onKeyDown,!1),g.document.addEventListener("mouseup",this._onMouseUp,!1),d.disableDrag(),this._startPos=d.mousePos(this._el,a),this._active=!0)},h.prototype._onMouseMove=function(a){var b=this._startPos,c=d.mousePos(this._el,a);this._box||(this._box=d.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var e=Math.min(b.x,c.x),f=Math.max(b.x,c.x),g=Math.min(b.y,c.y),h=Math.max(b.y,c.y);d.setTransform(this._box,"translate("+e+"px,"+g+"px)"),this._box.style.width=f-e+"px",this._box.style.height=h-g+"px"},h.prototype._onMouseUp=function(a){if(0===a.button){var b=this._startPos,c=d.mousePos(this._el,a),f=(new e).extend(this._map.unproject(b)).extend(this._map.unproject(c));this._finish(),b.x===c.x&&b.y===c.y?this._fireEvent("boxzoomcancel",a):this._map.fitBounds(f,{linear:!0}).fire("boxzoomend",{originalEvent:a,boxZoomBounds:f})}},h.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",a))},h.prototype._finish=function(){this._active=!1,g.document.removeEventListener("mousemove",this._onMouseMove,!1),g.document.removeEventListener("keydown",this._onKeyDown,!1),g.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.parentNode.removeChild(this._box),this._box=null),d.enableDrag()},h.prototype._fireEvent=function(a,b){return this._map.fire(a,{originalEvent:b})},b.exports=h},{"../../geo/lng_lat_bounds":73,"../../util/dom":204,"../../util/util":218,"../../util/window":199}],185:[function(a,b,c){"use strict";var d=function(a){this._map=a,this._onDblClick=this._onDblClick.bind(this)};d.prototype.isEnabled=function(){return!!this._enabled},d.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)},d.prototype.disable=function(){this.isEnabled()&&(this._map.off("dblclick",this._onDblClick),this._enabled=!1)},d.prototype._onDblClick=function(a){this._map.zoomTo(this._map.getZoom()+(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)},b.exports=d},{}],186:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/window"),g=.3,h=e.bezier(0,0,g,1),i=1400,j=function(a){this._map=a,this._el=a.getCanvasContainer(),e.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp"],this)};j.prototype.isEnabled=function(){return!!this._enabled},j.prototype.isActive=function(){return!!this._active},j.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)},j.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=!1)},j.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(a.touches?(f.document.addEventListener("touchmove",this._onMove),f.document.addEventListener("touchend",this._onTouchEnd)):(f.document.addEventListener("mousemove",this._onMove),f.document.addEventListener("mouseup",this._onMouseUp)),f.addEventListener("blur",this._onMouseUp),this._active=!1,this._startPos=this._pos=d.mousePos(this._el,a),this._inertia=[[Date.now(),this._pos]])},j.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",a),this._fireEvent("movestart",a));var b=d.mousePos(this._el,a),c=this._map;c.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),b]),c.transform.setLocationAtPoint(c.transform.pointLocation(this._pos),b),this._fireEvent("drag",a),this._fireEvent("move",a),this._pos=b,a.preventDefault()}},j.prototype._onUp=function(a){var b=this;if(this.isActive()){this._active=!1,this._fireEvent("dragend",a),this._drainInertiaBuffer();var c=function(){b._map.moving=!1,b._fireEvent("moveend",a)},d=this._inertia;if(d.length<2)return void c();var e=d[d.length-1],f=d[0],j=e[1].sub(f[1]),k=(e[0]-f[0])/1e3;if(0===k||e[1].equals(f[1]))return void c();var l=j.mult(g/k),m=l.mag();m>i&&(m=i,l._unit()._mult(m));var n=m/(2500*g),o=l.mult(-n/2);this._map.panBy(o,{duration:1e3*n,easing:h,noMoveStart:!0},{originalEvent:a})}},j.prototype._onMouseUp=function(a){this._ignoreEvent(a)||(this._onUp(a),f.document.removeEventListener("mousemove",this._onMove),f.document.removeEventListener("mouseup",this._onMouseUp),f.removeEventListener("blur",this._onMouseUp))},j.prototype._onTouchEnd=function(a){this._ignoreEvent(a)||(this._onUp(a),f.document.removeEventListener("touchmove",this._onMove),f.document.removeEventListener("touchend",this._onTouchEnd))},j.prototype._fireEvent=function(a,b){return this._map.fire(a,{originalEvent:b})},j.prototype._ignoreEvent=function(a){var b=this._map;return!(!b.boxZoom||!b.boxZoom.isActive())||!(!b.dragRotate||!b.dragRotate.isActive())||(a.touches?a.touches.length>1:!!a.ctrlKey||("mousemove"===a.type?!1&a.buttons:a.button&&0!==a.button))},j.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,b=Date.now();a.length>0&&b-a[0][0]>160;)a.shift()},b.exports=j},{"../../util/dom":204,"../../util/util":218,"../../util/window":199}],187:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/window"),g=.25,h=e.bezier(0,0,g,1),i=180,j=function(a,b){this._map=a,this._el=a.getCanvasContainer(),this._bearingSnap=b.bearingSnap,this._pitchWithRotate=!1!==b.pitchWithRotate,e.bindAll(["_onDown","_onMove","_onUp"],this)};j.prototype.isEnabled=function(){return!!this._enabled},j.prototype.isActive=function(){return!!this._active},j.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)},j.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)},j.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(f.document.addEventListener("mousemove",this._onMove),f.document.addEventListener("mouseup",this._onUp),f.addEventListener("blur",this._onUp),this._active=!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=d.mousePos(this._el,a),this._center=this._map.transform.centerPoint,a.preventDefault())},j.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a));var b=this._map;b.stop();var c=this._pos,e=d.mousePos(this._el,a),f=.8*(c.x-e.x),g=-.5*(c.y-e.y),h=b.getBearing()-f,i=b.getPitch()-g,j=this._inertia,k=j[j.length-1];this._drainInertiaBuffer(),j.push([Date.now(),b._normalizeBearing(h,k[1])]),b.transform.bearing=h,this._pitchWithRotate&&(this._fireEvent("pitch",a),b.transform.pitch=i),this._fireEvent("rotate",a),this._fireEvent("move",a),this._pos=e}},j.prototype._onUp=function(a){var b=this;if(!this._ignoreEvent(a)&&(f.document.removeEventListener("mousemove",this._onMove),f.document.removeEventListener("mouseup",this._onUp),f.removeEventListener("blur",this._onUp),this.isActive())){this._active=!1,this._fireEvent("rotateend",a),this._drainInertiaBuffer();var c=this._map,d=c.getBearing(),e=this._inertia,j=function(){Math.abs(d)<b._bearingSnap?c.resetNorth({noMoveStart:!0},{originalEvent:a}):(b._map.moving=!1,b._fireEvent("moveend",a)),b._pitchWithRotate&&b._fireEvent("pitchend",a)};if(e.length<2)return void j();var k=e[0],l=e[e.length-1],m=e[e.length-2],n=c._normalizeBearing(d,m[1]),o=l[1]-k[1],p=o<0?-1:1,q=(l[0]-k[0])/1e3;if(0===o||0===q)return void j();var r=Math.abs(o*(g/q));r>i&&(r=i);var s=r/(720*g);n+=p*r*(s/2),Math.abs(c._normalizeBearing(n,0))<this._bearingSnap&&(n=c._normalizeBearing(0,n)),c.rotateTo(n,{duration:1e3*s,easing:h,noMoveStart:!0},{originalEvent:a})}},j.prototype._fireEvent=function(a,b){return this._map.fire(a,{originalEvent:b})},j.prototype._ignoreEvent=function(a){var b=this._map;if(b.boxZoom&&b.boxZoom.isActive())return!0;if(b.dragPan&&b.dragPan.isActive())return!0;if(a.touches)return a.touches.length>1;var c=a.ctrlKey?1:2,d=a.ctrlKey?0:2,e=a.button;return"undefined"!=typeof InstallTrigger&&2===a.button&&a.ctrlKey&&f.navigator.platform.toUpperCase().indexOf("MAC")>=0&&(e=0),"mousemove"===a.type?a.buttons&0===c:!this.isActive()&&e!==d},j.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,b=Date.now();a.length>0&&b-a[0][0]>160;)a.shift()},b.exports=j},{"../../util/dom":204,"../../util/util":218,"../../util/window":199}],188:[function(a,b,c){"use strict";function d(a){return a*(2-a)}var e=100,f=function(a){this._map=a,this._el=a.getCanvasContainer(),this._onKeyDown=this._onKeyDown.bind(this)};f.prototype.isEnabled=function(){return!!this._enabled},f.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},f.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},f.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=0,c=0,f=0,g=0,h=0;switch(a.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:a.shiftKey?c=-1:(a.preventDefault(),g=-1);break;case 39:a.shiftKey?c=1:(a.preventDefault(),g=1);break;case 38:a.shiftKey?f=1:(a.preventDefault(),h=-1);break;case 40:a.shiftKey?f=-1:(h=1,a.preventDefault());break;default:return}var i=this._map,j=i.getZoom(),k={duration:300,delayEndEvents:500,easing:d,zoom:b?Math.round(j)+b*(a.shiftKey?2:1):j,bearing:i.getBearing()+15*c,pitch:i.getPitch()+10*f,offset:[-g*e,-h*e],center:i.getCenter()};i.easeTo(k,{originalEvent:a})}},b.exports=f},{}],189:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/browser"),g=a("../../util/window"),h=g.navigator.userAgent.toLowerCase(),i=-1!==h.indexOf("firefox"),j=-1!==h.indexOf("safari")&&-1===h.indexOf("chrom"),k=function(a){this._map=a,this._el=a.getCanvasContainer(),e.bindAll(["_onWheel","_onTimeout"],this)};k.prototype.isEnabled=function(){return!!this._enabled},k.prototype.enable=function(a){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},k.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)},k.prototype._onWheel=function(a){var b;"wheel"===a.type?(b=a.deltaY,i&&a.deltaMode===g.WheelEvent.DOM_DELTA_PIXEL&&(b/=f.devicePixelRatio),a.deltaMode===g.WheelEvent.DOM_DELTA_LINE&&(b*=40)):"mousewheel"===a.type&&(b=-a.wheelDeltaY,j&&(b/=3));var c=f.now(),e=c-(this._time||0);this._pos=d.mousePos(this._el,a),this._time=c,0!==b&&b%4.000244140625==0?this._type="wheel":0!==b&&Math.abs(b)<4?this._type="trackpad":e>400?(this._type=null,this._lastValue=b,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=Math.abs(e*b)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,b+=this._lastValue)),a.shiftKey&&b&&(b/=4),this._type&&this._zoom(-b,a),a.preventDefault()},k.prototype._onTimeout=function(){this._type="wheel",this._zoom(-this._lastValue)},k.prototype._zoom=function(a,b){if(0!==a){var c=this._map,d=2/(1+Math.exp(-Math.abs(a/100)));a<0&&0!==d&&(d=1/d);var e=c.ease?c.ease.to:c.transform.scale,f=c.transform.scaleZoom(e*d);c.zoomTo(f,{duration:"wheel"===this._type?200:0,around:this._aroundCenter?c.getCenter():c.unproject(this._pos),delayEndEvents:200,smoothEasing:!0},{originalEvent:b})}},b.exports=k},{"../../util/browser":197,"../../util/dom":204,"../../util/util":218,"../../util/window":199}],190:[function(a,b,c){"use strict";var d=a("../../util/dom"),e=a("../../util/util"),f=a("../../util/window"),g=.15,h=e.bezier(0,0,g,1),i=2.5,j=function(a){this._map=a,this._el=a.getCanvasContainer(),e.bindAll(["_onStart","_onMove","_onEnd"],this)};j.prototype.isEnabled=function(){return!!this._enabled},j.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",this._onStart,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},j.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)},j.prototype.disableRotation=function(){this._rotationDisabled=!0},j.prototype.enableRotation=function(){this._rotationDisabled=!1},j.prototype._onStart=function(a){if(2===a.touches.length){var b=d.mousePos(this._el,a.touches[0]),c=d.mousePos(this._el,a.touches[1]);this._startVec=b.sub(c),this._startScale=this._map.transform.scale,this._startBearing=this._map.transform.bearing,this._gestureIntent=void 0,this._inertia=[],f.document.addEventListener("touchmove",this._onMove,!1),f.document.addEventListener("touchend",this._onEnd,!1)}},j.prototype._onMove=function(a){if(2===a.touches.length){var b=d.mousePos(this._el,a.touches[0]),c=d.mousePos(this._el,a.touches[1]),e=b.add(c).div(2),f=b.sub(c),g=f.mag()/this._startVec.mag(),h=this._rotationDisabled?0:180*f.angleWith(this._startVec)/Math.PI,i=this._map;if(this._gestureIntent){var j={duration:0,around:i.unproject(e)};"rotate"===this._gestureIntent&&(j.bearing=this._startBearing+h),"zoom"!==this._gestureIntent&&"rotate"!==this._gestureIntent||(j.zoom=i.transform.scaleZoom(this._startScale*g)),i.stop(),this._drainInertiaBuffer(),this._inertia.push([Date.now(),g,e]),i.easeTo(j,{originalEvent:a})}else{var k=Math.abs(1-g)>.15;Math.abs(h)>10?this._gestureIntent="rotate":k&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._startVec=f,this._startScale=i.transform.scale,this._startBearing=i.transform.bearing)}a.preventDefault()}},j.prototype._onEnd=function(a){f.document.removeEventListener("touchmove",this._onMove),f.document.removeEventListener("touchend",this._onEnd),this._drainInertiaBuffer();var b=this._inertia,c=this._map;if(b.length<2)return void c.snapToNorth({},{originalEvent:a});var d=b[b.length-1],e=b[0],j=c.transform.scaleZoom(this._startScale*d[1]),k=c.transform.scaleZoom(this._startScale*e[1]),l=j-k,m=(d[0]-e[0])/1e3,n=d[2];if(0===m||j===k)return void c.snapToNorth({},{originalEvent:a});var o=l*g/m;Math.abs(o)>i&&(o=o>0?i:-i);var p=1e3*Math.abs(o/(12*g)),q=j+o*p/2e3;q<0&&(q=0),c.easeTo({zoom:q,duration:p,easing:h,around:this._aroundCenter?c.getCenter():c.unproject(n)},{originalEvent:a})},j.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,b=Date.now();a.length>2&&b-a[0][0]>160;)a.shift()},b.exports=j},{"../../util/dom":204,"../../util/util":218,"../../util/window":199}],191:[function(a,b,c){"use strict";var d=a("../util/util"),e=a("../util/window"),f=function(){d.bindAll(["_onHashChange","_updateHash"],this)};f.prototype.addTo=function(a){return this._map=a,e.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},f.prototype.remove=function(){return e.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),delete this._map,this},f.prototype.getHashString=function(a){var b=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.max(0,Math.ceil(Math.log(c)/Math.LN2)),e=Math.round(b.lng*Math.pow(10,d))/Math.pow(10,d),f=Math.round(b.lat*Math.pow(10,d))/Math.pow(10,d),g=this._map.getBearing(),h=this._map.getPitch(),i="";return i+=a?"#/"+e+"/"+f+"/"+c:"#"+c+"/"+f+"/"+e,(g||h)&&(i+="/"+Math.round(10*g)/10),h&&(i+="/"+Math.round(h)),i},f.prototype._onHashChange=function(){var a=e.location.hash.replace("#","").split("/");return a.length>=3&&(this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:+(a[3]||0),pitch:+(a[4]||0)}),!0)},f.prototype._updateHash=function(){var a=this.getHashString();e.history.replaceState("","",a)},b.exports=f},{"../util/util":218,"../util/window":199}],192:[function(a,b,c){"use strict";function d(a){a.parentNode&&a.parentNode.removeChild(a)}var e=a("../util/util"),f=a("../util/browser"),g=a("../util/window"),h=a("../util/dom"),i=a("../util/ajax"),j=a("../style/style"),k=a("../style/animation_loop"),l=a("../render/painter"),m=a("../geo/transform"),n=a("./hash"),o=a("./bind_handlers"),p=a("./camera"),q=a("../geo/lng_lat"),r=a("../geo/lng_lat_bounds"),s=a("point-geometry"),t=a("./control/attribution_control"),u=a("./control/logo_control"),v=a("mapbox-gl-supported"),w=0,x=22,y={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:w,maxZoom:x,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null},z=function(a){function b(b){var c=this;if(b=e.extend({},y,b),null!=b.minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than minZoom");var d=new m(b.minZoom,b.maxZoom,b.renderWorldCopies);if(a.call(this,d,b),this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,"string"==typeof b.container){if(this._container=g.document.getElementById(b.container),!this._container)throw new Error("Container '"+b.container+"' not found.")}else this._container=b.container;this.animationLoop=new k,b.maxBounds&&this.setMaxBounds(b.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),this.on("moveend",function(){c.animationLoop.set(300),c._rerender()}),void 0!==g&&(g.addEventListener("online",this._onWindowOnline,!1),g.addEventListener("resize",this._onWindowResize,!1)),o(this,b),this._hash=b.hash&&(new n).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),this._classes=[],this.resize(),b.classes&&this.setClasses(b.classes),b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new t),this.addControl(new u,b.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this.style.update(this._classes,{transition:!1})}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};return b.prototype.addControl=function(a,b){void 0===b&&a.getDefaultPosition&&(b=a.getDefaultPosition()),void 0===b&&(b="top-right");var c=a.onAdd(this),d=this._controlPositions[b];return-1!==b.indexOf("bottom")?d.insertBefore(c,d.firstChild):d.appendChild(c),this},b.prototype.removeControl=function(a){return a.onRemove(this),this},b.prototype.addClass=function(a,b){return e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(a)>=0||""===a?this:(this._classes.push(a),this._classOptions=b,this.style&&this.style.updateClasses(),this._update(!0))},b.prototype.removeClass=function(a,b){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");var c=this._classes.indexOf(a);return c<0||""===a?this:(this._classes.splice(c,1),this._classOptions=b,this.style&&this.style.updateClasses(),this._update(!0))},b.prototype.setClasses=function(a,b){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");for(var c={},d=0;d<a.length;d++)""!==a[d]&&(c[a[d]]=!0);return this._classes=Object.keys(c),this._classOptions=b,this.style&&this.style.updateClasses(),this._update(!0)},b.prototype.hasClass=function(a){return e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes.indexOf(a)>=0},b.prototype.getClasses=function(){return e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS."),this._classes},b.prototype.resize=function(){var a=this._containerDimensions(),b=a[0],c=a[1];return this._resizeCanvas(b,c),this.transform.resize(b,c),this.painter.resize(b,c),this.fire("movestart").fire("move").fire("resize").fire("moveend")},b.prototype.getBounds=function(){var a=new r(this.transform.pointLocation(new s(0,this.transform.height)),this.transform.pointLocation(new s(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(a.extend(this.transform.pointLocation(new s(this.transform.size.x,0))),a.extend(this.transform.pointLocation(new s(0,this.transform.size.y)))),a},b.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new r([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},b.prototype.setMaxBounds=function(a){if(a){var b=r.convert(a);this.transform.lngRange=[b.getWest(),b.getEast()],this.transform.latRange=[b.getSouth(),b.getNorth()],this.transform._constrain(),this._update()}else null!==a&&void 0!==a||(this.transform.lngRange=[],this.transform.latRange=[],this._update());return this},b.prototype.setMinZoom=function(a){if((a=null===a||void 0===a?w:a)>=w&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw new Error("minZoom must be between "+w+" and the current maxZoom, inclusive")},b.prototype.getMinZoom=function(){return this.transform.minZoom},b.prototype.setMaxZoom=function(a){if((a=null===a||void 0===a?x:a)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw new Error("maxZoom must be greater than the current minZoom")},b.prototype.getMaxZoom=function(){return this.transform.maxZoom},b.prototype.project=function(a){return this.transform.locationPoint(q.convert(a))},b.prototype.unproject=function(a){return this.transform.pointLocation(s.convert(a))},b.prototype.on=function(b,c,d){var f=this;if(void 0===d)return a.prototype.on.call(this,b,c);var g=function(){if("mouseenter"===b||"mouseover"===b){var a=!1;return{layer:c,listener:d,delegates:{mousemove:function(g){var h=f.queryRenderedFeatures(g.point,{layers:[c]});h.length?a||(a=!0,d.call(f,e.extend({features:h},g,{type:b}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"===b||"mouseout"===b){var g=!1;return{layer:c,listener:d,delegates:{mousemove:function(a){f.queryRenderedFeatures(a.point,{layers:[c]}).length?g=!0:g&&(g=!1,d.call(f,e.extend({},a,{type:b})))},mouseout:function(a){g&&(g=!1,d.call(f,e.extend({},a,{type:b})))}}}}var h=function(a){var b=f.queryRenderedFeatures(a.point,{layers:[c]});b.length&&d.call(f,e.extend({features:b},a))};return{layer:c,listener:d,delegates:(i={},i[b]=h,i)};var i}();this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(g);for(var h in g.delegates)f.on(h,g.delegates[h]);return this},b.prototype.off=function(b,c,d){var e=this;if(void 0===d)return a.prototype.off.call(this,b,c);if(this._delegatedListeners&&this._delegatedListeners[b])for(var f=this._delegatedListeners[b],g=0;g<f.length;g++){var h=f[g];if(h.layer===c&&h.listener===d){for(var i in h.delegates)e.off(i,h.delegates[i]);return f.splice(g,1),e}}},b.prototype.queryRenderedFeatures=function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c,d={};return 2===a.length?(c=arguments[0],d=arguments[1]):1===a.length&&function(a){return a instanceof s||Array.isArray(a)}(a[0])?c=a[0]:1===a.length&&(d=a[0]),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(c),d,this.transform.zoom,this.transform.angle):[]},b.prototype._makeQueryGeometry=function(a){var b=this;void 0===a&&(a=[s.convert([0,0]),s.convert([this.transform.width,this.transform.height])]);var c;if(a instanceof s||"number"==typeof a[0])c=[s.convert(a)];else{var d=[s.convert(a[0]),s.convert(a[1])];c=[d[0],new s(d[1].x,d[0].y),d[1],new s(d[0].x,d[1].y),d[0]]}return c=c.map(function(a){return b.transform.pointCoordinate(a)})},b.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)},b.prototype.setStyle=function(a,b){if((!b||!1!==b.diff&&!b.localIdeographFontFamily)&&this.style&&a&&!(a instanceof j)&&"string"!=typeof a)try{return this.style.setState(a)&&this._update(!0),this}catch(a){e.warnOnce("Unable to perform style diff: "+(a.message||a.error||a)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement),this.off("move",this.style._redoPlacement)),a?(this.style=a instanceof j?a:new j(a,this,b),this.style.setEventedParent(this,{style:this.style}),this.on("rotate",this.style._redoPlacement),this.on("pitch",this.style._redoPlacement),this.on("move",this.style._redoPlacement),this):(this.style=null,this)},b.prototype.getStyle=function(){if(this.style)return this.style.serialize()},b.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},b.prototype.addSource=function(a,b){return this.style.addSource(a,b),this._update(!0),this},b.prototype.isSourceLoaded=function(a){var b=this.style&&this.style.sourceCaches[a];return void 0===b?void this.fire("error",{error:new Error("There is no source with ID '"+a+"'")}):b.loaded()},b.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var b in a){var c=a[b],d=c._tiles;for(var e in d){var f=d[e];if("loaded"!==f.state&&"errored"!==f.state)return!1}}return!0},b.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,b,c)},b.prototype.removeSource=function(a){return this.style.removeSource(a),this._update(!0),this},b.prototype.getSource=function(a){
return this.style.getSource(a)},b.prototype.addImage=function(a,b,c){this.style.spriteAtlas.addImage(a,b,c)},b.prototype.removeImage=function(a){this.style.spriteAtlas.removeImage(a)},b.prototype.loadImage=function(a,b){i.getImage(a,b)},b.prototype.addLayer=function(a,b){return this.style.addLayer(a,b),this._update(!0),this},b.prototype.moveLayer=function(a,b){return this.style.moveLayer(a,b),this._update(!0),this},b.prototype.removeLayer=function(a){return this.style.removeLayer(a),this._update(!0),this},b.prototype.getLayer=function(a){return this.style.getLayer(a)},b.prototype.setFilter=function(a,b){return this.style.setFilter(a,b),this._update(!0),this},b.prototype.setLayerZoomRange=function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this._update(!0),this},b.prototype.getFilter=function(a){return this.style.getFilter(a)},b.prototype.setPaintProperty=function(a,b,c,d){return this.style.setPaintProperty(a,b,c,d),this._update(!0),this},b.prototype.getPaintProperty=function(a,b,c){return this.style.getPaintProperty(a,b,c)},b.prototype.setLayoutProperty=function(a,b,c){return this.style.setLayoutProperty(a,b,c),this._update(!0),this},b.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)},b.prototype.setLight=function(a){return this.style.setLight(a),this._update(!0),this},b.prototype.getLight=function(){return this.style.getLight()},b.prototype.getContainer=function(){return this._container},b.prototype.getCanvasContainer=function(){return this._canvasContainer},b.prototype.getCanvas=function(){return this._canvas},b.prototype._containerDimensions=function(){var a=0,b=0;return this._container&&(a=this._container.offsetWidth||400,b=this._container.offsetHeight||300),[a,b]},b.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map");var b=this._canvasContainer=h.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=h.create("canvas","mapboxgl-canvas",b),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);var d=this._controlContainer=h.create("div","mapboxgl-control-container",a),e=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){e[a]=h.create("div","mapboxgl-ctrl-"+a,d)})},b.prototype._resizeCanvas=function(a,b){var c=g.devicePixelRatio||1;this._canvas.width=c*a,this._canvas.height=c*b,this._canvas.style.width=a+"px",this._canvas.style.height=b+"px"},b.prototype._setupPainter=function(){var a=e.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},v.webGLContextAttributes),b=this._canvas.getContext("webgl",a)||this._canvas.getContext("experimental-webgl",a);if(!b)return void this.fire("error",{error:new Error("Failed to initialize WebGL")});this.painter=new l(b,this.transform)},b.prototype._contextLost=function(a){a.preventDefault(),this._frameId&&(f.cancelFrame(this._frameId),this._frameId=null),this.fire("webglcontextlost",{originalEvent:a})},b.prototype._contextRestored=function(a){this._setupPainter(),this.resize(),this._update(),this.fire("webglcontextrestored",{originalEvent:a})},b.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},b.prototype._update=function(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this._rerender(),this):this},b.prototype._render=function(){return this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming}),this.fire("render"),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load")),this._frameId=null,this.animationLoop.stopped()||(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty)&&this._rerender(),this},b.prototype.remove=function(){this._hash&&this._hash.remove(),f.cancelFrame(this._frameId),this._frameId=null,this.setStyle(null),void 0!==g&&(g.removeEventListener("resize",this._onWindowResize,!1),g.removeEventListener("online",this._onWindowOnline,!1));var a=this.painter.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),d(this._canvasContainer),d(this._controlContainer),this._container.classList.remove("mapboxgl-map"),this.fire("remove")},b.prototype._rerender=function(){this.style&&!this._frameId&&(this._frameId=f.frame(this._render))},b.prototype._onWindowOnline=function(){this._update()},b.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},c.showTileBoundaries.get=function(){return!!this._showTileBoundaries},c.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())},c.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},c.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,this.style._redoPlacement())},c.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},c.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())},c.repaint.get=function(){return!!this._repaint},c.repaint.set=function(a){this._repaint=a,this._update()},c.vertices.get=function(){return!!this._vertices},c.vertices.set=function(a){this._vertices=a,this._update()},b.prototype._onData=function(a){this._update("style"===a.dataType),this.fire(a.dataType+"data",a)},b.prototype._onDataLoading=function(a){this.fire(a.dataType+"dataloading",a)},Object.defineProperties(b.prototype,c),b}(p);b.exports=z},{"../geo/lng_lat":72,"../geo/lng_lat_bounds":73,"../geo/transform":74,"../render/painter":87,"../style/animation_loop":146,"../style/style":149,"../util/ajax":196,"../util/browser":197,"../util/dom":204,"../util/util":218,"../util/window":199,"./bind_handlers":176,"./camera":177,"./control/attribution_control":178,"./control/logo_control":181,"./hash":191,"mapbox-gl-supported":33,"point-geometry":36}],193:[function(a,b,c){"use strict";var d=a("../util/dom"),e=a("../geo/lng_lat"),f=a("point-geometry"),g=a("../util/smart_wrap"),h=function(a,b){this._offset=f.convert(b&&b.offset||[0,0]),this._update=this._update.bind(this),this._onMapClick=this._onMapClick.bind(this),a||(a=d.create("div")),a.classList.add("mapboxgl-marker"),this._element=a,this._popup=null};h.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},h.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map=null),d.remove(this._element),this._popup&&this._popup.remove(),this},h.prototype.getLngLat=function(){return this._lngLat},h.prototype.setLngLat=function(a){return this._lngLat=e.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},h.prototype.getElement=function(){return this._element},h.prototype.setPopup=function(a){return this._popup&&(this._popup.remove(),this._popup=null),a&&("offset"in a.options||(a.options.offset=this._offset),this._popup=a,this._popup.setLngLat(this._lngLat)),this},h.prototype._onMapClick=function(a){var b=a.originalEvent.target,c=this._element;this._popup&&(b===c||c.contains(b))&&this.togglePopup()},h.prototype.getPopup=function(){return this._popup},h.prototype.togglePopup=function(){var a=this._popup;a&&(a.isOpen()?a.remove():a.addTo(this._map))},h.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=g(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset)._add({x:-this._element.offsetWidth/2,y:-this._element.offsetHeight/2}),a&&"moveend"!==a.type||(this._pos=this._pos.round()),d.setTransform(this._element,"translate("+this._pos.x+"px, "+this._pos.y+"px)"))},b.exports=h},{"../geo/lng_lat":72,"../util/dom":204,"../util/smart_wrap":214,"point-geometry":36}],194:[function(a,b,c){"use strict";function d(a){if(a){if("number"==typeof a){var b=Math.round(Math.sqrt(.5*Math.pow(a,2)));return{top:new j(0,a),"top-left":new j(b,b),"top-right":new j(-b,b),bottom:new j(0,-a),"bottom-left":new j(b,-b),"bottom-right":new j(-b,-b),left:new j(a,0),right:new j(-a,0)}}if(e(a)){var c=j.convert(a);return{top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{top:j.convert(a.top||[0,0]),"top-left":j.convert(a["top-left"]||[0,0]),"top-right":j.convert(a["top-right"]||[0,0]),bottom:j.convert(a.bottom||[0,0]),"bottom-left":j.convert(a["bottom-left"]||[0,0]),"bottom-right":j.convert(a["bottom-right"]||[0,0]),left:j.convert(a.left||[0,0]),right:j.convert(a.right||[0,0])}}return d(new j(0,0))}function e(a){return a instanceof j||Array.isArray(a)}var f=a("../util/util"),g=a("../util/evented"),h=a("../util/dom"),i=a("../geo/lng_lat"),j=a("point-geometry"),k=a("../util/window"),l=a("../util/smart_wrap"),m={closeButton:!0,closeOnClick:!0},n=function(a){function b(b){a.call(this),this.options=f.extend(Object.create(m),b),f.bindAll(["_update","_onClickClose"],this)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.addTo=function(a){return this._map=a,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this},b.prototype.isOpen=function(){return!!this._map},b.prototype.remove=function(){return this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._container&&(this._container.parentNode.removeChild(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire("close"),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(a){return this._lngLat=i.convert(a),this._pos=null,this._update(),this},b.prototype.setText=function(a){return this.setDOMContent(k.document.createTextNode(a))},b.prototype.setHTML=function(a){var b,c=k.document.createDocumentFragment(),d=k.document.createElement("body");for(d.innerHTML=a;b=d.firstChild;)c.appendChild(b);return this.setDOMContent(c)},b.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},b.prototype._createContent=function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._content=h.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=h.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},b.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=h.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=h.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=l(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat);var a=this.options.anchor,b=d(this.options.offset);if(!a){var c=this._container.offsetWidth,e=this._container.offsetHeight;a=this._pos.y+b.bottom.y<e?["top"]:this._pos.y>this._map.transform.height-e?["bottom"]:[],this._pos.x<c/2?a.push("left"):this._pos.x>this._map.transform.width-c/2&&a.push("right"),a=0===a.length?"bottom":a.join("-")}var f=this._pos.add(b[a]).round(),g={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},i=this._container.classList;for(var j in g)i.remove("mapboxgl-popup-anchor-"+j);i.add("mapboxgl-popup-anchor-"+a),h.setTransform(this._container,g[a]+" translate("+f.x+"px,"+f.y+"px)")}},b.prototype._onClickClose=function(){this.remove()},b}(g);b.exports=n},{"../geo/lng_lat":72,"../util/dom":204,"../util/evented":205,"../util/smart_wrap":214,"../util/util":218,"../util/window":199,"point-geometry":36}],195:[function(a,b,c){"use strict";var d=function(a,b,c){this.target=a,this.parent=b,this.mapId=c,this.callbacks={},this.callbackID=0,this.receive=this.receive.bind(this),this.target.addEventListener("message",this.receive,!1)};d.prototype.send=function(a,b,c,d,e){var f=c?this.mapId+":"+this.callbackID++:null;c&&(this.callbacks[f]=c),this.target.postMessage({targetMapId:e,sourceMapId:this.mapId,type:a,id:String(f),data:b},d)},d.prototype.receive=function(a){var b,c=this,d=a.data,e=d.id;if(!d.targetMapId||this.mapId===d.targetMapId){var f=function(a,b,d){c.target.postMessage({sourceMapId:c.mapId,type:"<response>",id:String(e),error:a?String(a):null,data:b},d)};if("<response>"===d.type)b=this.callbacks[d.id],delete this.callbacks[d.id],b&&d.error?b(new Error(d.error)):b&&b(null,d.data);else if(void 0!==d.id&&this.parent[d.type])this.parent[d.type](d.sourceMapId,d.data,f);else if(void 0!==d.id&&this.parent.getWorkerSource){var g=d.type.split("."),h=this.parent.getWorkerSource(d.sourceMapId,g[0]);h[g[1]](d.data,f)}else this.parent[d.type](d.data)}},d.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)},b.exports=d},{}],196:[function(a,b,c){"use strict";function d(a){var b=e.document.createElement("a");return b.href=a,b.protocol===e.document.location.protocol&&b.host===e.document.location.host}var e=a("./window"),f=function(a){function b(b,c){a.call(this,b),this.status=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error);c.getJSON=function(a,b){var c=new e.XMLHttpRequest;return c.open("GET",a,!0),c.setRequestHeader("Accept","application/json"),c.onerror=function(){b(new Error(c.statusText))},c.onload=function(){if(c.status>=200&&c.status<300&&c.response){var a;try{a=JSON.parse(c.response)}catch(a){return b(a)}b(null,a)}else b(new f(c.statusText,c.status))},c.send(),c},c.getArrayBuffer=function(a,b){var c=new e.XMLHttpRequest;return c.open("GET",a,!0),c.responseType="arraybuffer",c.onerror=function(){b(new Error(c.statusText))},c.onload=function(){var a=c.response;if(0===a.byteLength&&200===c.status)return b(new Error("http status 200 returned without content."));c.status>=200&&c.status<300&&c.response?b(null,{data:a,cacheControl:c.getResponseHeader("Cache-Control"),expires:c.getResponseHeader("Expires")}):b(new f(c.statusText,c.status))},c.send(),c},c.getImage=function(a,b){return c.getArrayBuffer(a,function(a,c){if(a)b(a);else if(c){var d=new e.Image,f=e.URL||e.webkitURL;d.onload=function(){b(null,d),f.revokeObjectURL(d.src)};var g=new e.Blob([new Uint8Array(c.data)],{type:"image/png"});d.cacheControl=c.cacheControl,d.expires=c.expires,d.src=c.data.byteLength?f.createObjectURL(g):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},c.getVideo=function(a,b){var c=e.document.createElement("video");c.onloadstart=function(){b(null,c)};for(var f=0;f<a.length;f++){var g=e.document.createElement("source");d(a[f])||(c.crossOrigin="Anonymous"),g.src=a[f],c.appendChild(g)}return c}},{"./window":199}],197:[function(a,b,c){"use strict";var d=a("./window"),e=d.performance&&d.performance.now?d.performance.now.bind(d.performance):Date.now.bind(Date),f=d.requestAnimationFrame||d.mozRequestAnimationFrame||d.webkitRequestAnimationFrame||d.msRequestAnimationFrame,g=d.cancelAnimationFrame||d.mozCancelAnimationFrame||d.webkitCancelAnimationFrame||d.msCancelAnimationFrame;b.exports={now:e,frame:function(a){return f(a)},cancelFrame:function(a){return g(a)},timed:function(a,b,c){function d(){if(!g){var i=e();i>=h+b?a.call(c,1):(a.call(c,(i-h)/b),f(d))}}if(!b)return a.call(c,1),null;var g=!1,h=e();return f(d),function(){g=!0}},getImageData:function(a){var b=d.document.createElement("canvas"),c=b.getContext("2d");return b.width=a.width,b.height=a.height,c.drawImage(a,0,0,a.width,a.height),c.getImageData(0,0,a.width,a.height).data},hardwareConcurrency:d.navigator.hardwareConcurrency||4,get devicePixelRatio(){return d.devicePixelRatio},supportsWebp:!1};var h=d.document.createElement("img");h.onload=function(){b.exports.supportsWebp=!0},h.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":199}],198:[function(a,b,c){"use strict";var d=a("webworkify"),e=a("../window"),f=e.URL.createObjectURL(new d(a("../../source/worker"),{bare:!0}));b.exports=function(){return new e.Worker(f)}},{"../../source/worker":110,"../window":199,webworkify:51}],199:[function(a,b,c){"use strict";b.exports=self},{}],200:[function(a,b,c){"use strict";function d(a,b){return b.area-a.area}var e=a("quickselect"),f=a("./util").calculateSignedArea;b.exports=function(a,b){var c=a.length;if(c<=1)return[a];for(var g,h,i=[],j=0;j<c;j++){var k=f(a[j]);0!==k&&(a[j].area=Math.abs(k),void 0===h&&(h=k<0),h===k<0?(g&&i.push(g),g=[a[j]]):g.push(a[j]))}if(g&&i.push(g),b>1)for(var l=0;l<i.length;l++)i[l].length<=b||(e(i[l],b,1,i[l].length-1,d),i[l]=i[l].slice(0,b));return i}},{"./util":218,quickselect:38}],201:[function(a,b,c){"use strict";var d={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null};b.exports=d},{}],202:[function(a,b,c){"use strict";var d=function(a){var b=this;this._stringToNumber={},this._numberToString=[];for(var c=0;c<a.length;c++){var d=a[c];b._stringToNumber[d]=c,b._numberToString[c]=d}};d.prototype.encode=function(a){return this._stringToNumber[a]},d.prototype.decode=function(a){return this._numberToString[a]},b.exports=d},{}],203:[function(a,b,c){"use strict";var d=a("./util"),e=a("./actor"),f=function(a,b){var c=this;this.workerPool=a,this.actors=[],this.currentActor=0,this.id=d.uniqueId();for(var f=this.workerPool.acquire(this.id),g=0;g<f.length;g++){var h=f[g],i=new e(h,b,c.id);i.name="Worker "+g,c.actors.push(i)}};f.prototype.broadcast=function(a,b,c){c=c||function(){},d.asyncAll(this.actors,function(c,d){c.send(a,b,d)},c)},f.prototype.send=function(a,b,c,d,e){return("number"!=typeof d||isNaN(d))&&(d=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[d].send(a,b,c,e),d},f.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},b.exports=f},{"./actor":195,"./util":218}],204:[function(a,b,c){"use strict";function d(a){for(var b=0;b<a.length;b++)if(a[b]in i)return a[b];return a[0]}function e(a){a.preventDefault(),a.stopPropagation(),g.removeEventListener("click",e,!0)}var f=a("point-geometry"),g=a("./window");c.create=function(a,b,c){var d=g.document.createElement(a);return b&&(d.className=b),c&&c.appendChild(d),d};var h,i=g.document.documentElement.style,j=d(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);c.disableDrag=function(){j&&(h=i[j],i[j]="none")},c.enableDrag=function(){j&&(i[j]=h)};var k=d(["transform","WebkitTransform"]);c.setTransform=function(a,b){a.style[k]=b},c.suppressClick=function(){g.addEventListener("click",e,!0),g.setTimeout(function(){g.removeEventListener("click",e,!0)},0)},c.mousePos=function(a,b){var c=a.getBoundingClientRect();return b=b.touches?b.touches[0]:b,new f(b.clientX-c.left-a.clientLeft,b.clientY-c.top-a.clientTop)},c.touchPos=function(a,b){for(var c=a.getBoundingClientRect(),d=[],e="touchend"===b.type?b.changedTouches:b.touches,g=0;g<e.length;g++)d.push(new f(e[g].clientX-c.left-a.clientLeft,e[g].clientY-c.top-a.clientTop));return d},c.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)}},{"./window":199,"point-geometry":36}],205:[function(a,b,c){"use strict";function d(a,b,c){c[a]=c[a]||[],c[a].push(b)}function e(a,b,c){if(c&&c[a]){var d=c[a].indexOf(b);-1!==d&&c[a].splice(d,1)}}var f=a("./util"),g=function(){};g.prototype.on=function(a,b){return this._listeners=this._listeners||{},d(a,b,this._listeners),this},g.prototype.off=function(a,b){return e(a,b,this._listeners),e(a,b,this._oneTimeListeners),this},g.prototype.once=function(a,b){return this._oneTimeListeners=this._oneTimeListeners||{},d(a,b,this._oneTimeListeners),this},g.prototype.fire=function(a,b){var c=this;if(this.listens(a)){b=f.extend({},b,{type:a,target:this});for(var d=this._listeners&&this._listeners[a]?this._listeners[a].slice():[],g=0;g<d.length;g++)d[g].call(c,b);for(var h=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[],i=0;i<h.length;i++)h[i].call(c,b),e(a,h[i],c._oneTimeListeners);this._eventedParent&&this._eventedParent.fire(a,f.extend({},b,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else f.endsWith(a,"error")&&console.error(b&&b.error||b||"Empty error event");return this},g.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},g.prototype.setEventedParent=function(a,b){return this._eventedParent=a,this._eventedParentData=b,this},b.exports=g},{"./util":218}],206:[function(a,b,c){"use strict";function d(a,b){return b.max-a.max}function e(a,b,c,d){this.p=new i(a,b),this.h=c,this.d=f(this.p,d),this.max=this.d+this.h*Math.SQRT2}function f(a,b){for(var c=!1,d=1/0,e=0;e<b.length;e++)for(var f=b[e],g=0,h=f.length,i=h-1;g<h;i=g++){var k=f[g],l=f[i];k.y>a.y!=l.y>a.y&&a.x<(l.x-k.x)*(a.y-k.y)/(l.y-k.y)+k.x&&(c=!c),d=Math.min(d,j(a,k,l))}return(c?1:-1)*Math.sqrt(d)}function g(a){for(var b=0,c=0,d=0,f=a[0],g=0,h=f.length,i=h-1;g<h;i=g++){var j=f[g],k=f[i],l=j.x*k.y-k.x*j.y;c+=(j.x+k.x)*l,d+=(j.y+k.y)*l,b+=3*l}return new e(c/b,d/b,0,a)}var h=a("tinyqueue"),i=a("point-geometry"),j=a("./intersection_tests").distToSegmentSquared;b.exports=function(a,b,c){b=b||1;for(var f,i,j,k,l=a[0],m=0;m<l.length;m++){var n=l[m];(!m||n.x<f)&&(f=n.x),(!m||n.y<i)&&(i=n.y),(!m||n.x>j)&&(j=n.x),(!m||n.y>k)&&(k=n.y)}var o=j-f,p=k-i,q=Math.min(o,p),r=q/2,s=new h(null,d);if(0===q)return[f,i];for(var t=f;t<j;t+=q)for(var u=i;u<k;u+=q)s.push(new e(t+r,u+r,r,a));for(var v=g(a),w=s.length;s.length;){var x=s.pop();(x.d>v.d||!v.d)&&(v=x,c&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,w)),x.max-v.d<=b||(r=x.h/2,s.push(new e(x.p.x-r,x.p.y-r,r,a)),s.push(new e(x.p.x+r,x.p.y-r,r,a)),s.push(new e(x.p.x-r,x.p.y+r,r,a)),s.push(new e(x.p.x+r,x.p.y+r,r,a)),w+=4)}return c&&(console.log("num probes: "+w),console.log("best distance: "+v.d)),v.p}},{"./intersection_tests":209,"point-geometry":36,tinyqueue:40}],207:[function(a,b,c){"use strict";var d,e=a("./worker_pool");b.exports=function(){return d||(d=new e),d}},{"./worker_pool":221}],208:[function(a,b,c){"use strict";function d(a,b){this.stacks=a.readFields(e,[],b)}function e(a,b,c){if(1===a){var d=c.readMessage(f,{glyphs:{}});b.push(d)}}function f(a,b,c){if(1===a)b.name=c.readString();else if(2===a)b.range=c.readString();else if(3===a){var d=c.readMessage(g,{});b.glyphs[d.id]=d}}function g(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}b.exports=d},{}],209:[function(a,b,c){"use strict";function d(a,b){for(var c=0;c<a.length;c++)if(n(b,a[c]))return!0;for(var d=0;d<b.length;d++)if(n(a,b[d]))return!0;return!!i(a,b)}function e(a,b,c){for(var d=0;d<a.length;d++)for(var e=a[d],f=0;f<b.length;f++)for(var g=b[f],h=0;h<g.length;h++){var i=g[h];if(n(e,i))return!0;if(k(i,e,c))return!0}return!1}function f(a,b){if(1===a.length&&1===a[0].length)return m(b,a[0][0]);for(var c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++)if(m(a,d[e]))return!0;for(var f=0;f<a.length;f++){for(var g=a[f],h=0;h<g.length;h++)if(m(b,g[h]))return!0;for(var j=0;j<b.length;j++)if(i(g,b[j]))return!0}return!1}function g(a,b,c){for(var d=0;d<b.length;d++)for(var e=b[d],f=0;f<a.length;f++){var g=a[f];if(g.length>=3)for(var i=0;i<e.length;i++)if(n(g,e[i]))return!0;if(h(g,e,c))return!0}return!1}function h(a,b,c){if(a.length>1){if(i(a,b))return!0;for(var d=0;d<b.length;d++)if(k(b[d],a,c))return!0}for(var e=0;e<a.length;e++)if(k(a[e],b,c))return!0;return!1}function i(a,b){if(0===a.length||0===b.length)return!1;for(var c=0;c<a.length-1;c++)for(var d=a[c],e=a[c+1],f=0;f<b.length-1;f++){var g=b[f],h=b[f+1];if(j(d,e,g,h))return!0}return!1}function j(a,b,c,d){return o(a,c,d)!==o(b,c,d)&&o(a,b,c)!==o(a,b,d)}function k(a,b,c){var d=c*c;if(1===b.length)return a.distSqr(b[0])<d;for(var e=1;e<b.length;e++)if(l(a,b[e-1],b[e])<d)return!0;return!1}function l(a,b,c){var d=b.distSqr(c);if(0===d)return a.distSqr(b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e<0?a.distSqr(b):e>1?a.distSqr(c):a.distSqr(c.sub(b)._mult(e)._add(b))}function m(a,b){for(var c,d,e,f=!1,g=0;g<a.length;g++){c=a[g];for(var h=0,i=c.length-1;h<c.length;i=h++)d=c[h],e=c[i],d.y>b.y!=e.y>b.y&&b.x<(e.x-d.x)*(b.y-d.y)/(e.y-d.y)+d.x&&(f=!f)}return f}function n(a,b){for(var c=!1,d=0,e=a.length-1;d<a.length;e=d++){var f=a[d],g=a[e];f.y>b.y!=g.y>b.y&&b.x<(g.x-f.x)*(b.y-f.y)/(g.y-f.y)+f.x&&(c=!c)}return c}var o=a("./util").isCounterClockwise;b.exports={multiPolygonIntersectsBufferedMultiPoint:e,multiPolygonIntersectsMultiPolygon:f,multiPolygonIntersectsBufferedMultiLine:g,polygonIntersectsPolygon:d,distToSegmentSquared:l}},{"./util":218}],210:[function(a,b,c){"use strict";var d={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}};b.exports=d},{}],211:[function(a,b,c){"use strict";var d=function(a,b){this.max=a,this.onRemove=b,this.reset()};d.prototype.reset=function(){var a=this;for(var b in a.data)a.onRemove(a.data[b]);return this.data={},this.order=[],this},d.prototype.add=function(a,b){if(this.has(a))this.order.splice(this.order.indexOf(a),1),this.data[a]=b,this.order.push(a);else if(this.data[a]=b,this.order.push(a),this.order.length>this.max){var c=this.get(this.order[0]);c&&this.onRemove(c)}return this},d.prototype.has=function(a){return a in this.data},d.prototype.keys=function(){return this.order},d.prototype.get=function(a){if(!this.has(a))return null;var b=this.data[a];return delete this.data[a],this.order.splice(this.order.indexOf(a),1),b},d.prototype.getWithoutRemoving=function(a){return this.has(a)?this.data[a]:null},d.prototype.remove=function(a){if(!this.has(a))return this;var b=this.data[a];return delete this.data[a],this.onRemove(b),this.order.splice(this.order.indexOf(a),1),this},d.prototype.setMaxSize=function(a){var b=this;for(this.max=a;this.order.length>this.max;){var c=b.get(b.order[0]);c&&b.onRemove(c)}return this},b.exports=d},{}],212:[function(a,b,c){"use strict";function d(a,b){var c=g(i.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,"/"!==c.path&&(a.path=""+c.path+a.path),!i.REQUIRE_ACCESS_TOKEN)return h(a);if(!(b=b||i.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+k);if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+k);return a.params.push("access_token="+b),h(a)}function e(a){return 0===a.indexOf("mapbox:")}function f(a){for(var b=0;b<a.length;b++)0===a[b].indexOf("access_token=tk.")&&(a[b]="access_token="+(i.ACCESS_TOKEN||""))}function g(a){var b=a.match(m);if(!b)throw new Error("Unable to parse URL object");return{protocol:b[1],authority:b[2],path:b[3]||"/",params:b[4]?b[4].split("&"):[]}}function h(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}var i=a("./config"),j=a("./browser"),k="See https://www.mapbox.com/api-documentation/#access-tokens";c.isMapboxURL=e,c.normalizeStyleURL=function(a,b){if(!e(a))return a;var c=g(a);return c.path="/styles/v1"+c.path,d(c,b)},c.normalizeGlyphsURL=function(a,b){if(!e(a))return a;var c=g(a);return c.path="/fonts/v1"+c.path,d(c,b)},c.normalizeSourceURL=function(a,b){if(!e(a))return a;var c=g(a);return c.path="/v4/"+c.authority+".json",c.params.push("secure"),d(c,b)},c.normalizeSpriteURL=function(a,b,c,f){var i=g(a);return e(a)?(i.path="/styles/v1"+i.path+"/sprite"+b+c,d(i,f)):(i.path+=""+b+c,h(i))};var l=/(\.(png|jpg)\d*)(?=$)/;c.normalizeTileURL=function(a,b,c){if(!b||!e(b))return a;var d=g(a),i=j.devicePixelRatio>=2||512===c?"@2x":"",k=j.supportsWebp?".webp":"$1"
;return d.path=d.path.replace(l,""+i+k),f(d.params),h(d)};var m=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":197,"./config":201}],213:[function(a,b,c){"use strict";var d=a("./is_char_in_unicode_block");b.exports.allowsIdeographicBreaking=function(a){for(var b=0,d=a;b<d.length;b+=1){var e=d[b];if(!c.charAllowsIdeographicBreaking(e.charCodeAt(0)))return!1}return!0},b.exports.allowsVerticalWritingMode=function(a){for(var b=0,d=a;b<d.length;b+=1){var e=d[b];if(c.charHasUprightVerticalOrientation(e.charCodeAt(0)))return!0}return!1},b.exports.allowsLetterSpacing=function(a){for(var b=0,d=a;b<d.length;b+=1){var e=d[b];if(!c.charAllowsLetterSpacing(e.charCodeAt(0)))return!1}return!0},b.exports.charAllowsLetterSpacing=function(a){return!(d.Arabic(a)||d["Arabic Supplement"](a)||d["Arabic Extended-A"](a)||d["Arabic Presentation Forms-A"](a)||d["Arabic Presentation Forms-B"](a))},b.exports.charAllowsIdeographicBreaking=function(a){return!!(!(a<11904)&&(d["Bopomofo Extended"](a)||d.Bopomofo(a)||d["CJK Compatibility Forms"](a)||d["CJK Compatibility Ideographs"](a)||d["CJK Compatibility"](a)||d["CJK Radicals Supplement"](a)||d["CJK Strokes"](a)||d["CJK Symbols and Punctuation"](a)||d["CJK Unified Ideographs Extension A"](a)||d["CJK Unified Ideographs"](a)||d["Enclosed CJK Letters and Months"](a)||d["Halfwidth and Fullwidth Forms"](a)||d.Hiragana(a)||d["Ideographic Description Characters"](a)||d["Kangxi Radicals"](a)||d["Katakana Phonetic Extensions"](a)||d.Katakana(a)||d["Vertical Forms"](a)||d["Yi Radicals"](a)||d["Yi Syllables"](a)))},c.charHasUprightVerticalOrientation=function(a){return!!(746===a||747===a||!(a<4352)&&(d["Bopomofo Extended"](a)||d.Bopomofo(a)||d["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||d["CJK Compatibility Ideographs"](a)||d["CJK Compatibility"](a)||d["CJK Radicals Supplement"](a)||d["CJK Strokes"](a)||!(!d["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||d["CJK Unified Ideographs Extension A"](a)||d["CJK Unified Ideographs"](a)||d["Enclosed CJK Letters and Months"](a)||d["Hangul Compatibility Jamo"](a)||d["Hangul Jamo Extended-A"](a)||d["Hangul Jamo Extended-B"](a)||d["Hangul Jamo"](a)||d["Hangul Syllables"](a)||d.Hiragana(a)||d["Ideographic Description Characters"](a)||d.Kanbun(a)||d["Kangxi Radicals"](a)||d["Katakana Phonetic Extensions"](a)||d.Katakana(a)&&12540!==a||!(!d["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!d["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||d["Unified Canadian Aboriginal Syllabics"](a)||d["Unified Canadian Aboriginal Syllabics Extended"](a)||d["Vertical Forms"](a)||d["Yijing Hexagram Symbols"](a)||d["Yi Syllables"](a)||d["Yi Radicals"](a)))},c.charHasNeutralVerticalOrientation=function(a){return!!(d["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||d["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||d["Letterlike Symbols"](a)||d["Number Forms"](a)||d["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||d["Control Pictures"](a)&&9251!==a||d["Optical Character Recognition"](a)||d["Enclosed Alphanumerics"](a)||d["Geometric Shapes"](a)||d["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||d["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||d["CJK Symbols and Punctuation"](a)||d.Katakana(a)||d["Private Use Area"](a)||d["CJK Compatibility Forms"](a)||d["Small Form Variants"](a)||d["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a)},c.charHasRotatedVerticalOrientation=function(a){return!(c.charHasUprightVerticalOrientation(a)||c.charHasNeutralVerticalOrientation(a))}},{"./is_char_in_unicode_block":210}],214:[function(a,b,c){"use strict";var d=a("../geo/lng_lat");b.exports=function(a,b,c){if(a=new d(a.lng,a.lat),b){var e=new d(a.lng-360,a.lat),f=new d(a.lng+360,a.lat),g=c.locationPoint(a).distSqr(b);c.locationPoint(e).distSqr(b)<g?a=e:c.locationPoint(f).distSqr(b)<g&&(a=f)}for(;Math.abs(a.lng-c.center.lng)>180;){var h=c.locationPoint(a);if(h.x>=0&&h.y>=0&&h.x<=c.width&&h.y<=c.height)break;a.lng>c.center.lng?a.lng-=360:a.lng+=360}return a}},{"../geo/lng_lat":72}],215:[function(a,b,c){"use strict";function d(a){var b=JSON.stringify(a);if(o[b])return o[b];var c=void 0===a.alignment?1:a.alignment,d=0,g=0,i=["Uint8"],l=a.members.map(function(a){i.indexOf(a.type)<0&&i.push(a.type);var b=f(a.type),h=d=e(d,Math.max(c,b)),j=a.components||1;return g=Math.max(g,b),d+=b*j,{name:a.name,type:a.type,components:j,offset:h}}),p=e(d,Math.max(g,c)),q=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(m);q.prototype.alignment=c,q.prototype.size=p;for(var r=0,s=l;r<s.length;r+=1)for(var t=s[r],u=0;u<t.components;u++){var v=t.name+(1===t.components?"":u);if(v in q.prototype)throw new Error(v+" is a reserved name and cannot be used as a member name.");Object.defineProperty(q.prototype,v,{get:j(t,u),set:k(t,u)})}var w=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(n);return w.prototype.members=l,w.prototype.StructType=q,w.prototype.bytesPerElement=p,w.prototype.emplaceBack=h(l,p),w.prototype._usedTypes=i,o[b]=w,w}function e(a,b){return Math.ceil(a/b)*b}function f(a){return l[a].BYTES_PER_ELEMENT}function g(a){return a.toLowerCase()}function h(a,b){for(var c=[],d=[],e="var i = this.length;\nthis.resize(this.length + 1);\n",h=0,i=a;h<i.length;h+=1){var j=i[h],k=f(j.type);c.indexOf(k)<0&&(c.push(k),e+="var o"+k.toFixed(0)+" = i * "+(b/k).toFixed(0)+";\n");for(var l=0;l<j.components;l++){var m="v"+d.length,n="o"+k.toFixed(0)+" + "+(j.offset/k+l).toFixed(0);e+="this."+g(j.type)+"["+n+"] = "+m+";\n",d.push(m)}}return e+="return i;",new Function(d.toString(),e)}function i(a,b){var c="this._pos"+f(a.type).toFixed(0),d=(a.offset/f(a.type)+b).toFixed(0),e=c+" + "+d;return"this._structArray."+g(a.type)+"["+e+"]"}function j(a,b){return new Function("return "+i(a,b)+";")}function k(a,b){return new Function("x",i(a,b)+" = x;")}b.exports=d;var l={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},m=function(a,b){this._structArray=a,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},n=function(a){this.isTransferred=!1,void 0!==a?(this.arrayBuffer=a.arrayBuffer,this.length=a.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):(this.capacity=-1,this.resize(0))};n.serialize=function(){return{members:this.prototype.members,alignment:this.prototype.StructType.prototype.alignment,bytesPerElement:this.prototype.bytesPerElement}},n.prototype.serialize=function(a){return this._trim(),a&&(this.isTransferred=!0,a.push(this.arrayBuffer)),{length:this.length,arrayBuffer:this.arrayBuffer}},n.prototype.get=function(a){return new this.StructType(this,a)},n.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},n.prototype.clear=function(){this.length=0},n.prototype.resize=function(a){if(this.length=a,a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}},n.prototype._refreshViews=function(){for(var a=this,b=0,c=a._usedTypes;b<c.length;b+=1){var d=c[b];a[g(d)]=new l[d](a.arrayBuffer)}},n.prototype.toArray=function(a,b){for(var c=this,d=[],e=a;e<b;e++){var f=c.get(e);d.push(f)}return d};var o={}},{}],216:[function(a,b,c){"use strict";var d=a("./browser"),e=function(a,b){this.frequency=a,this.throttledFunction=b,this.lastInvocation=0};e.prototype.invoke=function(){var a=this;if(!this.pendingInvocation){var b=0===this.lastInvocation?0:this.lastInvocation+this.frequency-d.now();b<=0?(this.lastInvocation=d.now(),this.throttledFunction()):this.pendingInvocation=setTimeout(function(){a.pendingInvocation=void 0,a.lastInvocation=d.now(),a.throttledFunction()},b)}},e.prototype.stop=function(){this.pendingInvocation&&(clearTimeout(this.pendingInvocation),this.pendingInvocation=void 0)},b.exports=e},{"./browser":197}],217:[function(a,b,c){"use strict";function d(a,b){return b.replace(/{([^{}]+)}/g,function(b,c){return c in a?a[c]:""})}b.exports=d},{}],218:[function(a,b,c){"use strict";var d=a("@mapbox/unitbezier"),e=a("../geo/coordinate");a("point-geometry");c.easeCubicInOut=function(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)},c.bezier=function(a,b,c,e){var f=new d(a,b,c,e);return function(a){return f.solve(a)}},c.ease=c.bezier(.25,.1,.25,1),c.clamp=function(a,b,c){return Math.min(c,Math.max(b,a))},c.wrap=function(a,b,c){var d=c-b,e=((a-b)%d+d)%d+b;return e===b?c:e},c.asyncAll=function(a,b,c){if(!a.length)return c(null,[]);var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){b(a,function(a,b){a&&(f=a),e[g]=b,0==--d&&c(f,e)})})},c.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},c.keysDifference=function(a,b){var c=[];for(var d in a)d in b||c.push(d);return c},c.extend=function(a){for(var b=[],c=arguments.length-1;c-- >0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a},c.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c};var f=1;c.uniqueId=function(){return f++},c.bindAll=function(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})},c.getCoordinatesCenter=function(a){for(var b=1/0,c=1/0,d=-1/0,f=-1/0,g=0;g<a.length;g++)b=Math.min(b,a[g].column),c=Math.min(c,a[g].row),d=Math.max(d,a[g].column),f=Math.max(f,a[g].row);var h=d-b,i=f-c,j=Math.max(h,i),k=Math.max(0,Math.floor(-Math.log(j)/Math.LN2));return new e((b+d)/2,(c+f)/2,0).zoomTo(k)},c.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)},c.mapObject=function(a,b,c){var d=this,e={};for(var f in a)e[f]=b.call(c||d,a[f],f,a);return e},c.filterObject=function(a,b,c){var d=this,e={};for(var f in a)b.call(c||d,a[f],f,a)&&(e[f]=a[f]);return e},c.deepEqual=function(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var d=0;d<a.length;d++)if(!c.deepEqual(a[d],b[d]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==b){if("object"!=typeof b)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var e in a)if(!c.deepEqual(a[e],b[e]))return!1;return!0}return a===b},c.clone=function(a){return Array.isArray(a)?a.map(c.clone):"object"==typeof a&&a?c.mapObject(a,c.clone):a},c.arraysIntersect=function(a,b){for(var c=0;c<a.length;c++)if(b.indexOf(a[c])>=0)return!0;return!1};var g={};c.warnOnce=function(a){g[a]||("undefined"!=typeof console&&console.warn(a),g[a]=!0)},c.isCounterClockwise=function(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)},c.calculateSignedArea=function(a){for(var b=0,c=0,d=a.length,e=d-1,f=void 0,g=void 0;c<d;e=c++)f=a[c],g=a[e],b+=(g.x-f.x)*(f.y+g.y);return b},c.isClosedPolygon=function(a){if(a.length<4)return!1;var b=a[0],d=a[a.length-1];return!(Math.abs(b.x-d.x)>0||Math.abs(b.y-d.y)>0)&&Math.abs(c.calculateSignedArea(a))>.01},c.sphericalToCartesian=function(a){var b=a[0],c=a[1],d=a[2];return c+=90,c*=Math.PI/180,d*=Math.PI/180,[b*Math.cos(c)*Math.sin(d),b*Math.sin(c)*Math.sin(d),b*Math.cos(d)]},c.parseCacheControl=function(a){var b=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,c={};if(a.replace(b,function(a,b,d,e){var f=d||e;return c[b]=!f||f.toLowerCase(),""}),c["max-age"]){var d=parseInt(c["max-age"],10);isNaN(d)?delete c["max-age"]:c["max-age"]=d}return c}},{"../geo/coordinate":71,"@mapbox/unitbezier":4,"point-geometry":36}],219:[function(a,b,c){"use strict";var d=function(a,b,c,d){this.type="Feature",this._vectorTileFeature=a,a._z=b,a._x=c,a._y=d,this.properties=a.properties,null!=a.id&&(this.id=a.id)},e={geometry:{}};e.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},e.geometry.set=function(a){this._geometry=a},d.prototype.toJSON=function(){var a=this,b={geometry:this.geometry};for(var c in a)"_geometry"!==c&&"_vectorTileFeature"!==c&&(b[c]=a[c]);return b},Object.defineProperties(d.prototype,e),b.exports=d},{}],220:[function(a,b,c){"use strict";var d=a("./script_detection");b.exports=function(a){for(var c="",e=0;e<a.length;e++){var f=a.charCodeAt(e+1)||null,g=a.charCodeAt(e-1)||null;f&&d.charHasRotatedVerticalOrientation(f)&&!b.exports.lookup[a[e+1]]||g&&d.charHasRotatedVerticalOrientation(g)&&!b.exports.lookup[a[e-1]]||!b.exports.lookup[a[e]]?c+=a[e]:c+=b.exports.lookup[a[e]]}return c},b.exports.lookup={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""}},{"./script_detection":213}],221:[function(a,b,c){"use strict";var d=a("./web_worker"),e=function(){this.active={}};e.prototype.acquire=function(b){var c=this;if(!this.workers){var e=a("../").workerCount;for(this.workers=[];this.workers.length<e;)c.workers.push(new d)}return this.active[b]=!0,this.workers.slice()},e.prototype.release=function(a){delete this.active[a],0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},b.exports=e},{"../":75,"./web_worker":198}]},{},[75])(75)}),L.MapboxGL=L.Layer.extend({options:{updateInterval:32},initialize:function(a){if(L.setOptions(this,a),!a.accessToken)throw new Error("You should provide a Mapbox GL access token as a token option.");mapboxgl.accessToken=a.accessToken;var b=function(a,b,c){var d,e,f,g;return g=function(){d=!1,e&&(f.apply(c,e),e=!1)},f=function(){d?e=arguments:(a.apply(c,arguments),setTimeout(g,b),d=!0)}};this._throttledUpdate=b(L.Util.bind(this._update,this),this.options.updateInterval)},onAdd:function(a){this._glContainer||this._initContainer(),a._panes.tilePane.appendChild(this._glContainer),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),a.options.zoomAnimation&&L.DomEvent.on(a._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(a){this._map.options.zoomAnimation&&L.DomEvent.off(this._map._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this),a.getPanes().tilePane.removeChild(this._glContainer),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},_initContainer:function(){var a=this._glContainer=L.DomUtil.create("div","leaflet-gl-layer"),b=this._map.getSize();a.style.width=b.x+"px",a.style.height=b.y+"px"},_initGL:function(){var a=this._map.getCenter(),b=L.extend({},this.options,{container:this._glContainer,interactive:!1,center:[a.lng,a.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapboxgl.Map(b),this._glMap.transform.latRange=null,this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas,L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-image-layer"),L.DomUtil.addClass(this._glMap._actualCanvas,"leaflet-zoom-animated")},_update:function(a){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var b=this._map.getSize(),c=this._glContainer,d=this._glMap,e=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(c,e);var f=this._map.getCenter(),g=d.transform;g.center=mapboxgl.LngLat.convert([f.lng,f.lat]),g.zoom=this._map.getZoom()-1,d.transform.width!==b.x||d.transform.height!==b.y?(c.style.width=b.x+"px",c.style.height=b.y+"px",null!==d._resize&&void 0!==d._resize?d._resize():d.resize()):null!==d._update&&void 0!==d._update?d._update():d.update()}},_pinchZoom:function(a){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(a){var b=this._map.getZoomScale(a.zoom),c=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),a.zoom,a.center);L.DomUtil.setTransform(this._glMap._actualCanvas,c.subtract(this._offset),b)},_zoomStart:function(a){this._zooming=!0},_zoomEnd:function(){var a=this._map.getZoomScale(this._map.getZoom()),b=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),this._map.getZoom(),this._map.getCenter());L.DomUtil.setTransform(this._glMap._actualCanvas,b.subtract(this._offset),a),this._zooming=!1},_transitionEnd:function(a){L.Util.requestAnimFrame(function(){var a=this._map.getZoom(),b=this._map.getCenter(),c=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.DomUtil.setTransform(this._glMap._actualCanvas,c,1),this._glMap.once("moveend",L.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:b,zoom:a-1})},this)}}),L.mapboxGL=function(a){return new L.MapboxGL(a)},function(a){if("function"==typeof define&&define.amd)define(["leaflet"],a);else if("undefined"!=typeof module)module.exports=a(require("leaflet"));else{if(void 0===window.L)throw"Leaflet must be loaded first";a(window.L)}}(function(a){function b(a,b){var c=b.split("."),d=c.pop(),e=c.length,f=c[0],g=1;if(e>0)for(;(a=a[f])&&e>g;)f=c[g++];return a?a[d]:void 0}function c(a){return"[object Object]"===Object.prototype.toString.call(a)}return a.Control.Search=a.Control.extend({includes:a.Mixin.Events,options:{url:"",layer:null,sourceData:null,jsonpParam:null,propertyLoc:"loc",propertyName:"title",formatData:null,filterData:null,moveToLocation:null,buildTip:null,container:"",zoom:null,minLength:1,initial:!0,casesensitive:!1,autoType:!0,delayType:400,tooltipLimit:-1,tipAutoSubmit:!0,firstTipSubmit:!1,autoResize:!0,collapsed:!0,autoCollapse:!1,autoCollapseTime:1200,textErr:"Location not found",textCancel:"Cancel",textPlaceholder:"Search...",position:"topleft",hideMarkerOnCollapse:!1,marker:{icon:!1,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}}},initialize:function(b){a.Util.setOptions(this,b||{}),this._inputMinSize=this.options.textPlaceholder?this.options.textPlaceholder.length:10,this._layer=this.options.layer||new a.LayerGroup,this._filterData=this.options.filterData||this._defaultFilterData,this._formatData=this.options.formatData||this._defaultFormatData,this._moveToLocation=this.options.moveToLocation||this._defaultMoveToLocation,this._autoTypeTmp=this.options.autoType,this._countertips=0,this._recordsCache={},this._curReq=null},onAdd:function(b){return this._map=b,this._container=a.DomUtil.create("div","leaflet-control-search"),this._input=this._createInput(this.options.textPlaceholder,"search-input"),this._tooltip=this._createTooltip("search-tooltip"),this._cancel=this._createCancel(this.options.textCancel,"search-cancel"),this._button=this._createButton(this.options.textPlaceholder,"search-button"),this._alert=this._createAlert("search-alert"),!1===this.options.collapsed&&this.expand(this.options.collapsed),this.options.marker&&(this.options.marker instanceof a.Marker||this.options.marker instanceof a.CircleMarker?this._markerSearch=this.options.marker:c(this.options.marker)&&(this._markerSearch=new a.Control.Search.Marker([0,0],this.options.marker)),this._markerSearch._isMarkerSearch=!0),this.setLayer(this._layer),b.on({resize:this._handleAutoresize},this),this._container},addTo:function(b){return this.options.container?(this._container=this.onAdd(b),this._wrapper=a.DomUtil.get(this.options.container),this._wrapper.style.position="relative",this._wrapper.appendChild(this._container)):a.Control.prototype.addTo.call(this,b),this},onRemove:function(a){this._recordsCache={}},setLayer:function(a){return this._layer=a,this._layer.addTo(this._map),this},showAlert:function(a){a=a||this.options.textErr,this._alert.style.display="block",this._alert.innerHTML=a,clearTimeout(this.timerAlert);var b=this;return this.timerAlert=setTimeout(function(){b.hideAlert()},this.options.autoCollapseTime),this},hideAlert:function(){return this._alert.style.display="none",this},cancel:function(){return this._input.value="",this._handleKeypress({keyCode:8}),this._input.size=this._inputMinSize,this._input.focus(),this._cancel.style.display="none",this._hideTooltip(),this},expand:function(b){return b="boolean"!=typeof b||b,this._input.style.display="block",a.DomUtil.addClass(this._container,"search-exp"),!1!==b&&(this._input.focus(),this._map.on("dragstart click",this.collapse,this)),this.fire("search:expanded"),this},collapse:function(){return this._hideTooltip(),this.cancel(),this._alert.style.display="none",this._input.blur(),this.options.collapsed&&(this._input.style.display="none",this._cancel.style.display="none",a.DomUtil.removeClass(this._container,"search-exp"),this.options.hideMarkerOnCollapse&&this._map.removeLayer(this._markerSearch),this._map.off("dragstart click",this.collapse,this)),this.fire("search:collapsed"),this},collapseDelayed:function(){if(!this.options.autoCollapse)return this;var a=this;return clearTimeout(this.timerCollapse),this.timerCollapse=setTimeout(function(){a.collapse()},this.options.autoCollapseTime),this},collapseDelayedStop:function(){return clearTimeout(this.timerCollapse),this},_createAlert:function(b){var c=a.DomUtil.create("div",b,this._container);return c.style.display="none",a.DomEvent.on(c,"click",a.DomEvent.stop,this).on(c,"click",this.hideAlert,this),c},_createInput:function(b,c){var d=a.DomUtil.create("label",c,this._container),e=a.DomUtil.create("input",c,this._container);return e.type="text",e.size=this._inputMinSize,e.value="",e.autocomplete="off",e.autocorrect="off",e.autocapitalize="off",e.placeholder=b,e.style.display="none",e.role="search",e.id=e.role+e.type+e.size,d.htmlFor=e.id,d.style.display="none",d.value=b,a.DomEvent.disableClickPropagation(e).on(e,"keydown",this._handleKeypress,this).on(e,"blur",this.collapseDelayed,this).on(e,"focus",this.collapseDelayedStop,this),e},_createCancel:function(b,c){var d=a.DomUtil.create("a",c,this._container);return d.href="#",d.title=b,d.style.display="none",d.innerHTML="<span>&otimes;</span>",a.DomEvent.on(d,"click",a.DomEvent.stop,this).on(d,"click",this.cancel,this),d},_createButton:function(b,c){var d=a.DomUtil.create("a",c,this._container);return d.href="#",d.title=b,a.DomEvent.on(d,"click",a.DomEvent.stop,this).on(d,"click",this._handleSubmit,this).on(d,"focus",this.collapseDelayedStop,this).on(d,"blur",this.collapseDelayed,this),d},_createTooltip:function(b){var c=a.DomUtil.create("ul",b,this._container);c.style.display="none";var d=this;return a.DomEvent.disableClickPropagation(c).on(c,"blur",this.collapseDelayed,this).on(c,"mousewheel",function(b){d.collapseDelayedStop(),a.DomEvent.stopPropagation(b)},this).on(c,"mouseover",function(a){d.collapseDelayedStop()},this),c},_createTip:function(b,c){var d;if(this.options.buildTip){if("string"==typeof(d=this.options.buildTip.call(this,b,c))){var e=a.DomUtil.create("div");e.innerHTML=d,d=e.firstChild}}else d=a.DomUtil.create("li",""),d.innerHTML=b;return a.DomUtil.addClass(d,"search-tip"),d._text=b,this.options.tipAutoSubmit&&a.DomEvent.disableClickPropagation(d).on(d,"click",a.DomEvent.stop,this).on(d,"click",function(a){this._input.value=b,this._handleAutoresize(),this._input.focus(),this._hideTooltip(),this._handleSubmit()},this),d},_getUrl:function(a){return"function"==typeof this.options.url?this.options.url(a):this.options.url},_defaultFilterData:function(a,b){var c,d,e,f={};if(""===(a=a.replace(/[.*+?^${}()|[\]\\]/g,"")))return[];c=this.options.initial?"^":"",d=this.options.casesensitive?void 0:"i",e=new RegExp(c+a,d);for(var g in b)e.test(g)&&(f[g]=b[g]);return f},showTooltip:function(a){if(this._countertips=0,this._tooltip.innerHTML="",this._tooltip.currentSelection=-1,this.options.tooltipLimit)for(var b in a){if(this._countertips===this.options.tooltipLimit)break;this._countertips++,this._tooltip.appendChild(this._createTip(b,a[b]))}return this._countertips>0?(this._tooltip.style.display="block",this._autoTypeTmp&&this._autoType(),this._autoTypeTmp=this.options.autoType):this._hideTooltip(),this._tooltip.scrollTop=0,this._countertips},_hideTooltip:function(){return this._tooltip.style.display="none",this._tooltip.innerHTML="",0},_defaultFormatData:function(c){var d,e=this.options.propertyName,f=this.options.propertyLoc,g={};if(a.Util.isArray(f))for(d in c)g[b(c[d],e)]=a.latLng(c[d][f[0]],c[d][f[1]]);else for(d in c)g[b(c[d],e)]=a.latLng(b(c[d],f));return g},_recordsFromJsonp:function(b,c){a.Control.Search.callJsonp=c;var d=a.DomUtil.create("script","leaflet-search-jsonp",document.getElementsByTagName("body")[0]),e=a.Util.template(this._getUrl(b)+"&"+this.options.jsonpParam+"=L.Control.Search.callJsonp",{s:b});return d.type="text/javascript",d.src=e,{abort:function(){d.parentNode.removeChild(d)}}},_recordsFromAjax:function(b,c){void 0===window.XMLHttpRequest&&(window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP.6.0")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP.3.0")}catch(b){throw new Error("XMLHttpRequest is not supported")}}});var d=a.Browser.ie&&!window.atob&&document.querySelector,e=d?new XDomainRequest:new XMLHttpRequest,f=a.Util.template(this._getUrl(b),{s:b});return e.open("GET",f),e.onload=function(){c(JSON.parse(e.responseText))},e.onreadystatechange=function(){4===e.readyState&&200===e.status&&this.onload()},e.send(),e},_recordsFromLayer:function(){var c,d={},e=this.options.propertyName;return this._layer.eachLayer(function(f){if(!f.hasOwnProperty("_isMarkerSearch"))if(f instanceof a.Marker||f instanceof a.CircleMarker)try{if(b(f.options,e))c=f.getLatLng(),c.layer=f,d[b(f.options,e)]=c;else{if(!b(f.feature.properties,e))throw new Error("propertyName '"+e+"' not found in marker");c=f.getLatLng(),c.layer=f,d[b(f.feature.properties,e)]=c}}catch(g){console}else if(f.hasOwnProperty("feature"))try{if(!f.feature.properties.hasOwnProperty(e))throw new Error("propertyName '"+e+"' not found in feature");c=f.getBounds().getCenter(),c.layer=f,d[f.feature.properties[e]]=c}catch(g){console}else f instanceof a.LayerGroup&&f.eachLayer(function(a){c=a.getLatLng(),c.layer=a,d[a.feature.properties[e]]=c})},this),d},_autoType:function(){var a=this._input.value.length,b=this._tooltip.firstChild?this._tooltip.firstChild._text:"",c=b.length;if(0===b.indexOf(this._input.value))if(this._input.value=b,this._handleAutoresize(),this._input.createTextRange){var d=this._input.createTextRange();d.collapse(!0),d.moveStart("character",a),d.moveEnd("character",c),d.select()}else this._input.setSelectionRange?this._input.setSelectionRange(a,c):this._input.selectionStart&&(this._input.selectionStart=a,this._input.selectionEnd=c)},_hideAutoType:function(){var a;if((a=this._input.selection)&&a.empty)a.empty();else if(this._input.createTextRange){a=this._input.createTextRange(),a.collapse(!0);var b=this._input.value.length;a.moveStart("character",b),a.moveEnd("character",b),a.select()}else this._input.getSelection&&this._input.getSelection().removeAllRanges(),this._input.selectionStart=this._input.selectionEnd},_handleKeypress:function(a){switch(a.keyCode){case 27:this.collapse();break;case 13:(1==this._countertips||this.options.firstTipSubmit&&this._countertips>0)&&this._handleArrowSelect(1),this._handleSubmit();break;case 38:this._handleArrowSelect(-1);break;case 40:this._handleArrowSelect(1);break;case 8:case 45:case 46:this._autoTypeTmp=!1;break;case 37:case 39:case 16:case 17:case 35:case 36:break;default:if(this._input.value.length?this._cancel.style.display="block":this._cancel.style.display="none",this._input.value.length>=this.options.minLength){var b=this;clearTimeout(this.timerKeypress),this.timerKeypress=setTimeout(function(){b._fillRecordsCache()},this.options.delayType)}else this._hideTooltip()}this._handleAutoresize()},searchText:function(b){var c=b.charCodeAt(b.length);this._input.value=b,this._input.style.display="block",a.DomUtil.addClass(this._container,"search-exp"),this._autoTypeTmp=!1,this._handleKeypress({keyCode:c})},_fillRecordsCache:function(){var b,c=this._input.value,d=this;this._curReq&&this._curReq.abort&&this._curReq.abort(),a.DomUtil.addClass(this._container,"search-load"),this.options.layer?(this._recordsCache=this._recordsFromLayer(),b=this._filterData(this._input.value,this._recordsCache),this.showTooltip(b),a.DomUtil.removeClass(this._container,"search-load")):(this.options.sourceData?this._retrieveData=this.options.sourceData:this.options.url&&(this._retrieveData=this.options.jsonpParam?this._recordsFromJsonp:this._recordsFromAjax),this._curReq=this._retrieveData.call(this,c,function(c){d._recordsCache=d._formatData(c),b=d.options.sourceData?d._filterData(d._input.value,d._recordsCache):d._recordsCache,d.showTooltip(b),a.DomUtil.removeClass(d._container,"search-load")}))},_handleAutoresize:function(){this._input.style.maxWidth!=this._map._container.offsetWidth&&(this._input.style.maxWidth=a.DomUtil.getStyle(this._map._container,"width")),this.options.autoResize&&this._container.offsetWidth+45<this._map._container.offsetWidth&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleArrowSelect:function(b){var c=this._tooltip.hasChildNodes()?this._tooltip.childNodes:[];for(i=0;i<c.length;i++)a.DomUtil.removeClass(c[i],"search-tip-select");if(1==b&&this._tooltip.currentSelection>=c.length-1)a.DomUtil.addClass(c[this._tooltip.currentSelection],"search-tip-select");else if(-1==b&&this._tooltip.currentSelection<=0)this._tooltip.currentSelection=-1;else if("none"!=this._tooltip.style.display){this._tooltip.currentSelection+=b,a.DomUtil.addClass(c[this._tooltip.currentSelection],"search-tip-select"),this._input.value=c[this._tooltip.currentSelection]._text;var d=c[this._tooltip.currentSelection].offsetTop;d+c[this._tooltip.currentSelection].clientHeight>=this._tooltip.scrollTop+this._tooltip.clientHeight?this._tooltip.scrollTop=d-this._tooltip.clientHeight+c[this._tooltip.currentSelection].clientHeight:d<=this._tooltip.scrollTop&&(this._tooltip.scrollTop=d)}},_handleSubmit:function(){if(this._hideAutoType(),this.hideAlert(),this._hideTooltip(),"none"==this._input.style.display)this.expand();else if(""===this._input.value)this.collapse();else{var a=this._getLocation(this._input.value);!1===a?this.showAlert():(this.showLocation(a,this._input.value),this.fire("search:locationfound",{latlng:a,text:this._input.value,layer:a.layer?a.layer:null}))}},_getLocation:function(a){return!!this._recordsCache.hasOwnProperty(a)&&this._recordsCache[a]},_defaultMoveToLocation:function(a,b,c){this.options.zoom?this._map.setView(a,this.options.zoom):this._map.panTo(a)},showLocation:function(a,b){var c=this;return c._map.once("moveend zoomend",function(b){c._markerSearch&&c._markerSearch.addTo(c._map).setLatLng(a)}),
c._moveToLocation(a,b,c._map),c.options.autoCollapse&&c.collapse(),c}}),a.Control.Search.Marker=a.Marker.extend({includes:a.Mixin.Events,options:{icon:new a.Icon.Default,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}},initialize:function(b,d){a.setOptions(this,d),!0===d.icon&&(d.icon=new a.Icon.Default),a.Marker.prototype.initialize.call(this,b,d),c(this.options.circle)&&(this._circleLoc=new a.CircleMarker(b,this.options.circle))},onAdd:function(b){a.Marker.prototype.onAdd.call(this,b),this._circleLoc&&(b.addLayer(this._circleLoc),this.options.animate&&this.animate())},onRemove:function(b){a.Marker.prototype.onRemove.call(this,b),this._circleLoc&&b.removeLayer(this._circleLoc)},setLatLng:function(b){return a.Marker.prototype.setLatLng.call(this,b),this._circleLoc&&this._circleLoc.setLatLng(b),this},_initIcon:function(){this.options.icon&&a.Marker.prototype._initIcon.call(this)},_removeIcon:function(){this.options.icon&&a.Marker.prototype._removeIcon.call(this)},animate:function(){if(this._circleLoc){var a=this._circleLoc,b=5,c=parseInt(a._radius/b),d=this.options.circle.radius,e=2*a._radius,f=0;a._timerAnimLoc=setInterval(function(){f+=.5,c+=f,e-=c,a.setRadius(e),d>e&&(clearInterval(a._timerAnimLoc),a.setRadius(d))},200)}return this}}),a.Map.addInitHook(function(){this.options.searchControl&&(this.searchControl=a.control.search(this.options.searchControl),this.addControl(this.searchControl))}),a.control.search=function(b){return new a.Control.Search(b)},a.Control.Search}),function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(void 0!==b&&b.L?module.exports=a(L):module.exports=a(require("leaflet"))),void 0!==b&&b.L&&(b.L.Control.Locate=a(L))}(function(a){var b=function(b,c,d){(d=d.split(" ")).forEach(function(d){a.DomUtil[b].call(this,c,d)})},c=function(a,c){b("addClass",a,c)},d=function(a,c){b("removeClass",a,c)},e=a.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPan",keepCurrentZoomLevel:!1,flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,markerClass:a.CircleMarker,circleStyle:{color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:2,opacity:.5},markerStyle:{color:"#136AEC",fillColor:"#2A93EE",fillOpacity:.7,weight:2,opacity:.9,radius:5},followCircleStyle:{},followMarkerStyle:{},icon:"fa fa-map-marker",iconLoading:"fa fa-spinner fa-spin",iconElementTag:"span",circlePadding:[0,0],metric:!0,createButtonCallback:function(b,c){var d=a.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",b);return d.title=c.strings.title,{link:d,icon:a.DomUtil.create(c.iconElementTag,c.icon,d)}},onLocationError:function(a,b){alert(a.message)},onLocationOutsideMapBounds:function(a){a.stop(),alert(a.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize:function(b){for(var c in b)"object"==typeof this.options[c]?a.extend(this.options[c],b[c]):this.options[c]=b[c];this.options.followMarkerStyle=a.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=a.extend({},this.options.circleStyle,this.options.followCircleStyle)},onAdd:function(b){var c=a.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._layer=this.options.layer||new a.LayerGroup,this._layer.addTo(b),this._event=void 0,this._prevBounds=null;var d=this.options.createButtonCallback(c,this.options);return this._link=d.link,this._icon=d.icon,a.DomEvent.on(this._link,"click",a.DomEvent.stopPropagation).on(this._link,"click",a.DomEvent.preventDefault).on(this._link,"click",this._onClick,this).on(this._link,"dblclick",a.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),c},_onClick:function(){if(this._justClicked=!0,this._userPanned=!1,this._active&&!this._event)this.stop();else if(this._active&&void 0!==this._event)switch(this._map.getBounds().contains(this._event.latlng)?this.options.clickBehavior.inView:this.options.clickBehavior.outOfView){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds)}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start:function(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},_activate:function(){this._active||(this._map.locate(this.options.locateOptions),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this))},_deactivate:function(){this._map.stopLocate(),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this)},setView:function(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this.options.keepCurrentZoomLevel)(a=this.options.flyTo?this._map.flyTo:this._map.panTo).bind(this._map)([this._event.latitude,this._event.longitude]);else{var a=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;a.bind(this._map)(this._event.bounds,{padding:this.options.circlePadding,maxZoom:this.options.locateOptions.maxZoom})}},_drawMarker:function(){void 0===this._event.accuracy&&(this._event.accuracy=0);var b=this._event.accuracy,c=this._event.latlng;if(this.options.drawCircle){var d=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(c).setRadius(b).setStyle(d):this._circle=a.circle(c,b,d).addTo(this._layer)}var e,f;if(this.options.metric?(e=b.toFixed(0),f=this.options.strings.metersUnit):(e=(3.2808399*b).toFixed(0),f=this.options.strings.feetUnit),this.options.drawMarker){var g=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(c),this._marker.setStyle&&this._marker.setStyle(g)):this._marker=new this.options.markerClass(c,g).addTo(this._layer)}var h=this.options.strings.popup;this.options.showPopup&&h&&this._marker&&this._marker.bindPopup(a.Util.template(h,{distance:e,unit:f}))._popup.setLatLng(c)},_removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload:function(){this.stop(),this._map.off("unload",this._unload,this)},_onLocationError:function(a){3==a.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(a,this))},_onLocationFound:function(a){if((!this._event||this._event.latlng.lat!==a.latlng.lat||this._event.latlng.lng!==a.latlng.lng||this._event.accuracy!==a.accuracy)&&this._active){switch(this._event=a,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"always":this.setView()}this._justClicked=!1}},_onDrag:function(){this._event&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing:function(){return!!this._active&&("always"===this.options.setView||("untilPan"===this.options.setView?!this._userPanned:void 0))},_isOutsideMapBounds:function(){return void 0!==this._event&&this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle:function(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses:function(a){"requesting"==a?(d(this._container,"active following"),c(this._container,"requesting"),d(this._icon,this.options.icon),c(this._icon,this.options.iconLoading)):"active"==a?(d(this._container,"requesting following"),c(this._container,"active"),d(this._icon,this.options.iconLoading),c(this._icon,this.options.icon)):"following"==a&&(d(this._container,"requesting"),c(this._container,"active following"),d(this._icon,this.options.iconLoading),c(this._icon,this.options.icon))},_cleanClasses:function(){a.DomUtil.removeClass(this._container,"requesting"),a.DomUtil.removeClass(this._container,"active"),a.DomUtil.removeClass(this._container,"following"),d(this._icon,this.options.iconLoading),c(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._justClicked=!1,this._userPanned=!1}});return a.control.locate=function(b){return new a.Control.Locate(b)},e},window),function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this._map=null,this._layerData=[],this._types=[],this._mapLayers=L.layerGroup(),this._searchLayer=L.layerGroup(),this._$layers=a(this.element).find(this.settings.layersSelector),this.init()}var f="ctipWidget",g={popup:function(a){return a.name},proxyUrl:"https://ctip-proxy.app",layers:[],propertyName:"value"};a.extend(e.prototype,{init:function(){this.initMap(),this.initLayers(),this.bindLayers()},initMap:function(){var b=a(this.element).find(this.settings.mapSelector)[0];this._map=L.map(b).setView([this.settings.center.lat,this.settings.center.lng],this.settings.center.zoom),L.mapboxGL({accessToken:"no-token",style:this.settings.vectorStyleUrl}).addTo(this._map),this._map.addControl(new L.Control.Search({layer:this._searchLayer})),this._map.addControl(L.control.locate()),this._mapLayers.addTo(this._map)},initLayers:function(){var c=this;a.each(c.settings.layers,function(d,e){a.ajax({url:c.settings.proxyUrl+e.url,method:"GET"}).done(function(b){var d=[];a.each(b.data,function(b,e){var f={name:e.name,type:e.geoObject.data.geometry.type.toLowerCase(),geo:c.reverseCoordinates(e.geoObject.data.geometry.coordinates),type_id:e.map_object_type_id};if(e.attribute.data.length>0&&a.isArray(e.attribute.data)){var g=[];a.each(e.attribute.data,function(a,b){g.push({id:b.id,name:b.name,type:b.type,value:b.value})}),f.attribute=g}d.push(f)}),a.each(b.meta,function(a,b){c._types.push({id:parseInt(a),name:b})});var f={name:e.name,objects:d};c._layerData.push(f),c.addLayerToPanel(f)}).fail(function(){b.alert("Cannot get data for "+e.name)})})},bindLayers:function(){var b=this;a(c).on("click",".layer [type=checkbox]",function(){var c=a(this).parents(".layer").data("name");a(this).prop("checked")?b.addLayerToMap(c):b.removeLayerFromMap(c)})},addLayerToPanel:function(b){var c=a(a(this.element).find(this.settings.layerTemplateSelector).html());c.attr("data-name",b.name),c.find("label").html(b.name),this._$layers.append(c)},layerByName:function(b){var c;return a(this._layerData).each(function(){this.name===b&&(c=this)}),c},addLayerToMap:function(b){var c=this,d=c.layerByName(b),e=L.layerGroup();a(d.objects).each(function(){var a=this,b="";switch(a.type){case"point":b="ctip-icon ctip-icon-"+d.name+" "+c.getTypeNameById(a.type_id);var f=L.marker(a.geo,{icon:L.divIcon({className:c.setClassNames(b,a.attribute)}),title:a.name});f.bindPopup(c.showPopUp(a)),e.addLayer(f),c._searchLayer.addLayer(f);break;case"linestring":b="ctip-line ctip-line-"+d.name+" "+c.getTypeNameById(a.type_id);var g=L.polyline(a.geo,{className:c.setClassNames(b,a.attribute),title:a.name});g.bindPopup(c.showPopUp(a)),e.addLayer(g),c._searchLayer.addLayer(g);break;case"polygon":b="ctip-polygon ctip-polygon-"+d.name+" "+c.getTypeNameById(a.type_id);var h=L.polygon(a.geo,{className:c.setClassNames(b,a.attribute),title:a.name});h.bindPopup(c.showPopUp(a)),e.addLayer(h),c._searchLayer.addLayer(h)}}),e.name=b,e.addTo(c._mapLayers)},removeLayerFromMap:function(b){var c=this;a(this._mapLayers.getLayers()).each(function(){var a=this;a.name===b&&c._mapLayers.removeLayer(a)})},setClassNames:function(b,c){var d=b;return a.isArray(c)&&a.each(c,function(a,b){switch(b.type){case"integer":case"double":case"lookup":case"string":d+=" "+b.name+" "+b.name+"-"+b.value;break;case"boolean":!0===Boolean(Number(b.value))&&(d+=" "+b.name)}}),d},reverseCoordinates:function(b){var c=this;if(a.isArray(b)){var d=[];return a.each(b.reverse(),function(b,e){a.isArray(e)?d.push(c.reverseCoordinates(e)):d.push(e)}),d}return b},getTypeNameById:function(b){var c=a.grep(this._types,function(a){return a.id===b});return void 0!==c[0]?c[0].name:null},showPopUp:function(b){var c=this,d="";return d+="<b>ID: "+b.name+"</b><br />",d+="<b>Type: "+c.getTypeNameById(b.type_id)+"</b><br />",a.each(b.attribute,function(a,b){d+=b.name+": "+c.transformValueToReadableDutch(b.type,b.value)+"<br />"}),d},transformValueToReadableDutch:function(a,b){return"boolean"===a?!0===Boolean(Number(b))?"ja":"nee":null===b?"-":b}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);